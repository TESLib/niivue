<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>NiiVue</title>
    <link rel="stylesheet" href="niivue.css" />
    <link rel="icon" href="data:;base64,iVBORw0KGgo=" />
  </head>
  <body>
    <noscript>
      <strong>niivue requires JavaScript.</strong>
    </noscript>
    <header>
      <label for="fiberColor">Fiber Color</label>
      <select id="fiberColor">
        <option value="Global">Global direction</option>
        <option value="Local">Local direction</option>
        <option value="Fixed">Fixed</option>
        <option value="DPG0">First Group (if available)</option>
        <option value="DPG1">Second Group (if available)</option>
        <option value="DPG01">First Two Groups (if available)</option>
        <option value="DPG2">Third Group (if available)</option>
        <option value="DPG024">First Third and Fifth Group (if available)</option>
      </select>
    </header>
    <main>
      <canvas id="gl1"></canvas>
    </main>
    <footer id="location">&nbsp;</footer>
    <script type="module" async>
      import { Niivue, NVImage, NVMesh } from "./niivue/index.ts";
      fiberColor.onchange = function () {
        const colorName = document.getElementById("fiberColor").value;
        if (colorName === "DPG0") {
          let cmap = {
                R: [0],
                G: [255],
                B: [0],
                I: [0]
          };
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", cmap);
        } else if (colorName === "DPG1") {
          let cmap = {
                R: [0],
                G: [255],
                B: [0],
                I: [1]
          };
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", cmap);
        } else if (colorName === "DPG01") {
          let cmap = {
                R: [0, 255],
                G: [255, 0],
                B: [0, 0],
                I: [0, 1]
          };
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", cmap);
        } else if (colorName === "DPG2") {
          let cmap = {
                R: [0],
                G: [255],
                B: [0],
                I: [3]
          };
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", cmap);
        } else if (colorName === "DPG024") {
          let cmap = {
                R: [0, 255, 0],
                G: [255, 0, 0],
                B: [0, 0, 255],
                I: [0, 2, 4]
          };
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", cmap);

        } else {
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberGroupColormap", null);
          nv1.setMeshProperty(nv1.meshes[0].id, "fiberColor", colorName);
        }
      }; //fiberColor.onchange()
      var volumeList1 = [{ url: "./sub-996782_dwi_b0.nii.gz" }];
      let defaults = {
        // set logging to debug for development
        logLevel: 'debug',// 'debug', 'info', 'warn', 'error', 'fatal' or 'silent'
        loadingText: "there are no images",
        backColor: [1, 1, 1, 1],
        show3Dcrosshair: true,
        logging: true,
      };
      var nv1 = new Niivue(defaults);
      nv1.setRadiologicalConvention(false);
      nv1.attachTo("gl1");
      nv1.setSliceType(nv1.sliceTypeMultiplanar);
      await nv1.loadVolumes(volumeList1);
      await nv1.loadMeshes([{ url: "./sub-996782_dwi_space-RASMM_model-CSD_desc-prob-afq-clean_tractography.trx", rgba255: [0, 142, 0, 255]}]);
      nv1.setClipPlane([-0.1, 180, 0]);
    </script>
  </body>
</html>
