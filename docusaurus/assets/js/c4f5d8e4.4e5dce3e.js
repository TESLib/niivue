"use strict";(self.webpackChunk_niivue_docs=self.webpackChunk_niivue_docs||[]).push([["130"],{8108:function(e,t,i){i.d(t,{M:()=>ig});var r,s,a=i("2322"),l=i("2784"),o=i("5963"),n=i("6867"),h=i("159"),d=i("5730"),c=i("2148"),m=i("3824"),A=i("3212"),g=i("8941"),u=i("5997"),f=i("130"),p=i("5039"),v=i("1876"),x=Object.defineProperty,w=(e,t,i)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,C=(e,t,i)=>w(e,"symbol"!=typeof t?t+"":t,i),b="0.48.1",y=class e{constructor({name:e="niivue",level:t="info"}={}){C(this,"level"),C(this,"name"),this.name=`${e}`,this.level=t}debug(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(!(e.levels[this.level]>e.levels.debug))console.debug(`${this.name}-debug`,...i)}info(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(!(e.levels[this.level]>e.levels.info))console.info(`${this.name}-info`,...i)}warn(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(!(e.levels[this.level]>e.levels.warn))console.warn(`${this.name}-warn`,...i)}error(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(!(e.levels[this.level]>e.levels.error))console.error(`${this.name}-error`,...i)}fatal(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(!(e.levels[this.level]>e.levels.fatal))console.error(`${this.name}-fatal`,...i)}setLogLevel(e){this.level=e}setName(e){this.name=e}};C(y,"levels",{debug:0,info:1,warn:2,error:3,fatal:4,silent:1/0});var I=new y({name:"niivue",level:"info"}),M=function(e,t,i){let r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t),e.compileShader(r);let s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);let a=e.createProgram();if(e.attachShader(a,r),e.attachShader(a,s),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(a)),!e.getShaderParameter(r,e.COMPILE_STATUS)&&console.log("Vertex shader compilation error:",e.getShaderInfoLog(r)),!e.getShaderParameter(s,e.COMPILE_STATUS)&&console.log("Fragment shader compilation error:",e.getShaderInfoLog(s)),I.error(e.getProgramInfoLog(a)),Error("Shader failed to link, see console for log");return a},D=class{constructor(e,t,i){C(this,"program"),C(this,"uniforms",{}),C(this,"isMatcap"),this.program=M(e,t,i);let r=/uniform[^;]+[ ](\w+);/g,s=/uniform[^;]+[ ](\w+);/,a=t.match(r),l=i.match(r);for(let t in a&&a.forEach(e=>{let t=e.match(s);this.uniforms[t[1]]=-1}),l&&l.forEach(e=>{let t=e.match(s);this.uniforms[t[1]]=-1}),this.uniforms)this.uniforms[t]=e.getUniformLocation(this.program,t)}use(e){e.useProgram(this.program)}},F=`#version 300 es
#line 4
layout(location=0) in vec3 pos;
layout(location=1) in vec3 texCoords;
uniform mat4 mvpMtx;
out vec3 vColor;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vColor = texCoords;
}`,T=`
	vec4 drawColor(float scalar, float drawOpacity) {
		float nlayer = float(textureSize(colormap, 0).y);
		float layer = (nlayer - 0.5) / nlayer;
		vec4 dcolor = texture(colormap, vec2((scalar * 255.0)/256.0 + 0.5/256.0, layer)).rgba;
		dcolor.a *= drawOpacity;
		return dcolor;
}`,E=`vec3 GetBackPosition(vec3 startPositionTex) {
	vec3 startPosition = startPositionTex * volScale;
	vec3 invR = 1.0 / rayDir;
	vec3 tbot = invR * (vec3(0.0)-startPosition);
	vec3 ttop = invR * (volScale-startPosition);
	vec3 tmax = max(ttop, tbot);
	vec2 t = min(tmax.xx, tmax.yz);
	vec3 endPosition = startPosition + (rayDir * min(t.x, t.y));
	//convert world position back to texture position:
	endPosition = endPosition / volScale;
	return endPosition;
}

vec4 applyClip (vec3 dir, inout vec4 samplePos, inout float len, inout bool isClip) {
	float cdot = dot(dir,clipPlane.xyz);
	isClip = false;
	if  ((clipPlane.a > 1.0) || (cdot == 0.0)) return samplePos;
	bool frontface = (cdot > 0.0);
	float dis = (-clipPlane.a - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	float thick = clipThick;
	if (thick <= 0.0) thick = 2.0;
	float  disBackFace = (-(clipPlane.a-thick) - dot(clipPlane.xyz, samplePos.xyz-0.5)) / cdot;
	if (((frontface) && (dis >= len)) || ((!frontface) && (dis <= 0.0))) {
		samplePos.a = len + 1.0;
		return samplePos;
	}
	if (frontface) {
		dis = max(0.0, dis);
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		if (dis > 0.0) isClip = true;
		len = min(disBackFace, len);
	}
	if (!frontface) {
		len = min(dis, len);
		disBackFace = max(0.0, disBackFace);
		if (len == dis) isClip = true;
		samplePos = vec4(samplePos.xyz+dir * disBackFace, disBackFace);
	}
	return samplePos;
}

void clipVolume(inout vec3 startPos, inout vec3 backPos, int dim, float frac, bool isLo) {
	vec3 dir = backPos - startPos;
	float len = length(dir);
	dir = normalize(dir);
	// Discard if both startPos and backPos are outside the clipping plane
	if (isLo && startPos[dim] < frac && backPos[dim] < frac) {
		discard;
	}
	if (!isLo && startPos[dim] > frac && backPos[dim] > frac) {
		discard;
	}
	vec4 plane = vec4(0.0, 0.0, 0.0, 0.5 - frac);
	plane[dim] = 1.0;
	float cdot = dot(dir, plane.xyz);
	float dis = (-plane.w - dot(plane.xyz, startPos - vec3(0.5))) / cdot;
	// Adjust startPos or backPos based on the intersection with the plane
	bool isFrontFace = (cdot > 0.0);
	if (!isLo)
		isFrontFace = !isFrontFace;
	if (dis > 0.0) {
		if (isFrontFace) {
				if (dis <= len) {
					startPos = startPos + dir * dis;
				}
		} else {
			if (dis < len) {
				backPos = startPos + dir * dis;
			}
		}
	}
}

void clipVolumeStart (inout vec3 startPos, inout vec3 backPos) {
	// vec3 clipLo = vec3(0.1, 0.2, 0.4);
	// vec3 clipHi = vec3(0.8, 0.7, 0.7);
	for (int i = 0; i < 3; i++) {
		if (clipLo[i] > 0.0)
			clipVolume(startPos, backPos, i, clipLo[i], true);
	}
	for (int i = 0; i < 3; i++) {
		if (clipHi[i] < 1.0)
			clipVolume(startPos, backPos, i, clipHi[i], false);
	}
}

float frac2ndc(vec3 frac) {
//https://stackoverflow.com/questions/7777913/how-to-render-depth-linearly-in-modern-opengl-with-gl-fragcoord-z-in-fragment-sh
	vec4 pos = vec4(frac.xyz, 1.0); //fraction
	vec4 dim = vec4(vec3(textureSize(volume, 0)), 1.0);
	pos = pos * dim;
	vec4 shim = vec4(-0.5, -0.5, -0.5, 0.0);
	pos += shim;
	vec4 mm = transpose(matRAS) * pos;
	float z_ndc = (mvpMtx * vec4(mm.xyz, 1.0)).z;
	return (z_ndc + 1.0) / 2.0;
}`+T,S=`void main() {
	if (fColor.x > 2.0) {
		fColor = vec4(1.0, 0.0, 0.0, 0.5);
		return;
	}
	fColor = vec4(0.0,0.0,0.0,0.0);
	vec4 clipPlaneColorX = clipPlaneColor;
	//if (clipPlaneColor.a < 0.0)
	//	clipPlaneColorX.a = - 1.0;
	bool isColorPlaneInVolume = false;
	if (clipPlaneColorX.a < 0.0) {
		isColorPlaneInVolume = true;
		clipPlaneColorX.a = 0.0;
	}
	//fColor = vec4(vColor.rgb, 1.0); return;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	// fColor = vec4(backPosition, 1.0); return;
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	dir = normalize(dir);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	//if ((clipPos.a != samplePos.a) && (len < 3.0)) {
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	float drawOpacityA = renderDrawAmbientOcclusionXY.y;
	if ((samplePos.a >= len) && (((overlays < 1.0) && (drawOpacityA <= 0.0) ) || (backgroundMasksOverlays > 0)))  {
		if (isClip)
			fColor += clipPlaneColorX;
		return;
	}
	fColor = vec4(1.0, 1.0, 1.0, 1.0);
	//gl_FragDepth = frac2ndc(samplePos.xyz); //crude due to fast pass resolution
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * lenNoClip);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`,V=`
	if (firstHit.a < len)
		gl_FragDepth = frac2ndc(firstHit.xyz);
	colAcc.a = (colAcc.a / earlyTermination) * backOpacity;
	fColor = colAcc;
	//if (isClip) //CR
	if ((isColorPlaneInVolume) && (clipPos.a != samplePos.a) && (abs(firstHit.a - clipPos.a) < deltaDir.a))
		fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, abs(clipPlaneColor.a));
		//fColor.rgb = mix(fColor.rgb, clipPlaneColorX.rgb, clipPlaneColorX.a * 0.65);
	float renderDrawAmbientOcclusionX = renderDrawAmbientOcclusionXY.x;
	float drawOpacity = renderDrawAmbientOcclusionXY.y;
	if ((overlays < 1.0) && (drawOpacity <= 0.0))
		return;
	//overlay pass
	len = lenNoClip;
	samplePos = vec4(start.xyz, 0.0); //ray position
	//start: OPTIONAL fast pass: rapid traversal until first hit
	stepSizeFast = sliceSize * 1.0;
	deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (drawOpacity > 0.0)
			val = max(val, texture(drawing, samplePos.xyz).r);
		if (val > 0.001)
			break;
		samplePos += deltaDirFast; //advance ray position
	}
	if (samplePos.a >= len) {
		if (isClip && (fColor.a == 0.0))
				fColor += clipPlaneColorX;
			return;
	}
	samplePos -= deltaDirFast;
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	//end: fast pass
	float overFarthest = len;
	colAcc = vec4(0.0, 0.0, 0.0, 0.0);

	samplePos += deltaDir * ran; //jitter ray
	vec4 overFirstHit = vec4(0.0,0.0,0.0,2.0 * len);
	if (backgroundMasksOverlays > 0)
		samplePos = firstHit;
	bool firstDraw = true;
	while (samplePos.a <= len) {
		vec4 colorSample = texture(overlay, samplePos.xyz);
		if ((colorSample.a < 0.01) && (drawOpacity > 0.0)) {
			float val = texture(drawing, samplePos.xyz).r;
			vec4 draw = drawColor(val, drawOpacity);
			if ((draw.a > 0.0) && (firstDraw)) {
				firstDraw = false;
				float sum = 0.0;
				const float mn = 1.0 / 256.0;
				const float sampleRadius = 1.1;
				float dx = sliceSize * sampleRadius;
				vec3 center = samplePos.xyz;
				//six neighbors that share a face
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,0.0), dir)).r, mn);
				//float proportion = (sum / mn) / 6.0;
				
				//12 neighbors that share an edge
				dx = sliceSize * sampleRadius * sqrt(2.0) * 0.5;
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,+dx,0.0), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,-dx,0.0), dir)).r, mn);

				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,+dx,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,0.0,-dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(+dx,-dx,0.0), dir)).r, mn);
				
				sum += min(texture(drawing, center.xyz + cross(vec3(0.0,-dx,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,0.0,+dx), dir)).r, mn);
				sum += min(texture(drawing, center.xyz + cross(vec3(-dx,+dx,0.0), dir)).r, mn);
				float proportion = (sum / mn) / 18.0; //proportion of six neighbors is non-zero
				
				//a high proportion of hits means crevice
				//since the AO term adds shadows that darken most voxels, it will result in dark surfaces
				//the term brighten adds a little illumination to balance this
				// without brighten, only the most extreme ridges will not be darker
				const float brighten = 1.2;
				vec3 ao = draw.rgb * (1.0 - proportion) * brighten;
				draw.rgb = mix (draw.rgb, ao , renderDrawAmbientOcclusionX);
			}
			colorSample = draw;
		}
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (overFirstHit.a > len)
				overFirstHit = samplePos;
			colorSample.a *= renderOverlayBlend;
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			overFarthest = samplePos.a;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
	//if (samplePos.a >= len) {
	if (colAcc.a <= 0.0) {
		if (isClip && (fColor.a == 0.0))
			fColor += clipPlaneColorX;
		return;
	}
	if (overFirstHit.a < firstHit.a)
		gl_FragDepth = frac2ndc(overFirstHit.xyz);
	float overMix = colAcc.a;
	float overlayDepth = 0.3;
	if (fColor.a <= 0.0)
		overMix = 1.0;
	else if (((overFarthest) > backNearest)) {
		float dx = (overFarthest - backNearest)/1.73;
		dx = fColor.a * pow(dx, overlayDepth);
		overMix *= 1.0 - dx;
	}
	fColor.rgb = mix(fColor.rgb, colAcc.rgb, overMix);
	fColor.a = max(fColor.a, colAcc.a);
}`,B=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+E+`
	void main() {
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) { //length limit for parallel rays
		fColor = vec4(0.0,0.0,0.0,0.0);
		return;
	}
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	vec4 deltaDir = vec4(dir.xyz * stepSize, stepSize);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	vec4 colAcc = vec4(0.0,0.0,0.0,0.0);
	vec4 firstHit = vec4(0.0,0.0,0.0,2.0 * len);
	const float earlyTermination = 0.95;
	float backNearest = len; //assume no hit
	float dis = len;
	//check if axial plane is closest
	vec4 aClip = vec4(0.0, 0.0, 1.0, (1.0- clipPlane.z) - 0.5);
	float adis = (-aClip.a - dot(aClip.xyz, samplePos.xyz-0.5)) / dot(dir,aClip.xyz);
	if (adis > 0.0)
		dis = min(adis, dis);
	//check of coronal plane is closest
	vec4 cClip = vec4(0.0, 1.0, 0.0, (1.0- clipPlane.y) - 0.5);
	float cdis = (-cClip.a - dot(cClip.xyz, samplePos.xyz-0.5)) / dot(dir,cClip.xyz);
	if (cdis > 0.0)
		dis = min(cdis, dis);
	//check if coronal slice is closest
	vec4 sClip = vec4(1.0, 0.0, 0.0, (1.0- clipPlane.x) - 0.5);
	float sdis = (-sClip.a - dot(sClip.xyz, samplePos.xyz-0.5)) / dot(dir,sClip.xyz);
	if (sdis > 0.0)
		dis = min(sdis, dis);
	if ((dis > 0.0) && (dis < len)) {
		samplePos = vec4(samplePos.xyz+dir * dis, dis);
		colAcc = texture(volume, samplePos.xyz);
		colAcc.a = earlyTermination;
		firstHit = samplePos;
		backNearest = min(backNearest, samplePos.a);
	}
	//the following are only used by overlays
	vec4 clipPlaneColorX = clipPlaneColor;
	bool isColorPlaneInVolume = false;
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	if (samplePos.a < 0.0)
		vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float ran = fract(sin(gl_FragCoord.x * 12.9898 + gl_FragCoord.y * 78.233) * 43758.5453);
	samplePos += deltaDir * ran; //jitter ray
`+V,U=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform vec2 renderDrawAmbientOcclusionXY;
in vec3 vColor;
out vec4 fColor;
`+E+S+`while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		samplePos += deltaDir; //advance ray position
		if (colorSample.a >= 0.01) {
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
	}
`+V,R=`#version 300 es
#line 215
precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 texVox;
uniform int backgroundMasksOverlays;
uniform vec3 volScale;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform float backOpacity;
uniform mat4 mvpMtx;
uniform mat4 normMtx;
uniform mat4 matRAS;
uniform vec4 clipPlaneColor;
uniform float renderOverlayBlend;
uniform highp sampler3D drawing, gradient;
uniform highp sampler2D colormap;
uniform highp sampler2D matCap;
uniform vec2 renderDrawAmbientOcclusionXY;
uniform float gradientAmount;
in vec3 vColor;
out vec4 fColor;
`+E+S+`
	float startPos = samplePos.a;
	float clipClose = clipPos.a + 3.0 * deltaDir.a; //do not apply gradients near clip plane
	float brighten = 2.0; //modulating makes average intensity darker 0.5 * 0.5 = 0.25
	//vec4 prevGrad = vec4(0.0);
	while (samplePos.a <= len) {
		vec4 colorSample = texture(volume, samplePos.xyz);
		if (colorSample.a >= 0.0) {
			vec4 grad = texture(gradient, samplePos.xyz);
			grad.rgb = normalize(grad.rgb*2.0 - 1.0);
			//if (grad.a < prevGrad.a)
			//	grad.rgb = prevGrad.rgb;
			//prevGrad = grad;
			vec3 n = mat3(normMtx) * grad.rgb;
			n.y = - n.y;
			vec4 mc = vec4(texture(matCap, n.xy * 0.5 + 0.5).rgb, 1.0) * brighten;
			mc = mix(vec4(1.0), mc, gradientAmount);
			if (samplePos.a > clipClose)
				colorSample.rgb *= mc.rgb;
			if (firstHit.a > lenNoClip)
				firstHit = samplePos;
			backNearest = min(backNearest, samplePos.a);
			colorSample.a = 1.0-pow((1.0 - colorSample.a), opacityCorrection);
			colorSample.rgb *= colorSample.a;
			colAcc= (1.0 - colAcc.a) * colorSample + colAcc;
			if ( colAcc.a > earlyTermination )
				break;
		}
		samplePos += deltaDir; //advance ray position
	}
`+V,N=`#version 300 es
#line 392
layout(location=0) in vec3 pos;
uniform int axCorSag;
uniform mat4 mvpMtx;
uniform mat4 frac2mm;
uniform float slice;
out vec3 texPos;
void main(void) {
	texPos = vec3(pos.x, pos.y, slice);
	if (axCorSag > 1)
		texPos = vec3(slice, pos.x, pos.y);
	else if (axCorSag > 0)
		texPos = vec3(pos.x, slice, pos.y);
	vec4 mm = frac2mm * vec4(texPos, 1.0);
	gl_Position = mvpMtx * mm;
}`,P=`#version 300 es
#line 411
precision highp int;
precision highp float;
uniform highp sampler3D volume, overlay;
uniform int backgroundMasksOverlays;
uniform float overlayOutlineWidth;
uniform float overlayAlphaShader;
uniform int axCorSag;
uniform float overlays;
uniform float opacity;
uniform float drawOpacity;
uniform bool isAlphaClipDark;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
in vec3 texPos;
out vec4 color;`+T+`void main() {
	//color = vec4(1.0, 0.0, 1.0, 1.0);return;
	vec4 background = texture(volume, texPos);
	color = vec4(background.rgb, opacity);
	if ((isAlphaClipDark) && (background.a == 0.0)) color.a = 0.0; //FSLeyes clipping range
	vec4 ocolor = vec4(0.0);
	float overlayAlpha = overlayAlphaShader;
	if (overlays > 0.0) {
		ocolor = texture(overlay, texPos);
		//dFdx for "boxing" issue 435 has aliasing on some implementations (coarse vs fine)
		//however, this only identifies 50% of the edges due to aliasing effects
		// http://www.aclockworkberry.com/shader-derivative-functions/
		// https://bgolus.medium.com/distinctive-derivative-differences-cce38d36797b
		//if ((ocolor.a >= 1.0) && ((dFdx(ocolor.a) != 0.0) || (dFdy(ocolor.a) != 0.0)  ))
		//	ocolor.rbg = vec3(0.0, 0.0, 0.0);
		bool isOutlineBelowNotAboveThreshold = true;
		if (isOutlineBelowNotAboveThreshold) {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a < 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				//6 voxel neighbors that share a face
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 0.0;
				if (axCorSag != 2) {
					a = max(a, texture(overlay, vxR).a);
					a = max(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = max(a, texture(overlay, vxA).a);
					a = max(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = max(a, texture(overlay, vxS).a);
					a = max(a, texture(overlay, vxI).a);
				}
				bool isCheckCorners = true;
				if (isCheckCorners) {
					//12 voxel neighbors that share an edge
					vec3 vxRA = vec3(texPos.x+vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxLA = vec3(texPos.x-vx.x, texPos.y+vx.y, texPos.z);
					vec3 vxRP = vec3(texPos.x+vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxLP = vec3(texPos.x-vx.x, texPos.y-vx.y, texPos.z);
					vec3 vxRS = vec3(texPos.x+vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxLS = vec3(texPos.x-vx.x, texPos.y, texPos.z+vx.z);
					vec3 vxRI = vec3(texPos.x+vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxLI = vec3(texPos.x-vx.x, texPos.y, texPos.z-vx.z);
					vec3 vxAS = vec3(texPos.x, texPos.y+vx.y, texPos.z+vx.z);
					vec3 vxPS = vec3(texPos.x, texPos.y-vx.y, texPos.z+vx.z);
					vec3 vxAI = vec3(texPos.x, texPos.y+vx.y, texPos.z-vx.z);
					vec3 vxPI = vec3(texPos.x, texPos.y-vx.y, texPos.z-vx.z);

					if (axCorSag == 0) { //axial corners
						a = max(a, texture(overlay, vxRA).a);
						a = max(a, texture(overlay, vxLA).a);
						a = max(a, texture(overlay, vxRP).a);
						a = max(a, texture(overlay, vxLP).a);
					}
					if (axCorSag == 1) { //coronal corners
						a = max(a, texture(overlay, vxRS).a);
						a = max(a, texture(overlay, vxLS).a);
						a = max(a, texture(overlay, vxRI).a);
						a = max(a, texture(overlay, vxLI).a);
					}
					if (axCorSag == 2) { //sagittal corners
						a = max(a, texture(overlay, vxAS).a);
						a = max(a, texture(overlay, vxPS).a);
						a = max(a, texture(overlay, vxAI).a);
						a = max(a, texture(overlay, vxPI).a);
					}
				}
				if (a >= 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}

		} else {
			if ((overlayOutlineWidth > 0.0) && (ocolor.a >= 1.0)) { //check voxel neighbors for edge
				vec3 vx = (overlayOutlineWidth ) / vec3(textureSize(overlay, 0));
				vec3 vxR = vec3(texPos.x+vx.x, texPos.y, texPos.z);
				vec3 vxL = vec3(texPos.x-vx.x, texPos.y, texPos.z);
				vec3 vxA = vec3(texPos.x, texPos.y+vx.y, texPos.z);
				vec3 vxP = vec3(texPos.x, texPos.y-vx.y, texPos.z);
				vec3 vxS = vec3(texPos.x, texPos.y, texPos.z+vx.z);
				vec3 vxI = vec3(texPos.x, texPos.y, texPos.z-vx.z);
				float a = 1.0;
				if (axCorSag != 2) {
					a = min(a, texture(overlay, vxR).a);
					a = min(a, texture(overlay, vxL).a);
				}
				if (axCorSag != 1) {
					a = min(a, texture(overlay, vxA).a);
					a = min(a, texture(overlay, vxP).a);
				}
				if (axCorSag != 0) {
					a = min(a, texture(overlay, vxS).a);
					a = min(a, texture(overlay, vxI).a);
				}
				if (a < 1.0) {
					ocolor = vec4(0.0, 0.0, 0.0, 1.0);
					overlayAlpha = 1.0;
				}
			}
		} //outline above threshold
	}

`,k=`	ocolor.a *= overlayAlpha;
	vec4 dcolor = drawColor(texture(drawing, texPos).r, drawOpacity);
	if (dcolor.a > 0.0) {
		color.rgb = mix(color.rgb, dcolor.rgb, dcolor.a);
		color.a = max(drawOpacity, color.a);
	}
	if ((backgroundMasksOverlays > 0) && (background.a == 0.0))
		return;
	float a = color.a + ocolor.a * (1.0 - color.a); // premultiplied alpha
	if (a == 0.0) return;
	color.rgb = mix(color.rgb, ocolor.rgb, ocolor.a / a);
	color.a = a;
}`,L=P+k,Y=P+`	if (ocolor.a > 0.0) {
		//https://gamedev.stackexchange.com/questions/102889/is-it-possible-to-convert-vec4-to-int-in-glsl-using-opengl-es
		uint alpha = uint(ocolor.a * 255.0);
		vec3 xyzFlip = vec3(float((uint(1) & alpha) > uint(0)), float((uint(2) & alpha) > uint(0)), float((uint(4) & alpha) > uint(0)));
		//convert from 0 and 1 to -1 and 1
		xyzFlip = (xyzFlip * 2.0) - 1.0;
		//https://math.stackexchange.com/questions/1905533/find-perpendicular-distance-from-point-to-line-in-3d
		//v1 principle direction of tensor for this voxel
		vec3 v1 = ocolor.rgb;
		//flips encode polarity to convert from 0..1 to -1..1 (27 bits vs 24 bit precision)
		v1 = normalize( v1 * xyzFlip);
		vec3 vxl = fract(texPos * vec3(textureSize(volume, 0))) - 0.5;
		//vxl coordinates now -0.5..+0.5 so 0,0,0 is origin
		vxl.x = -vxl.x;
		float t = dot(vxl,v1);
		vec3 P = t * v1;
		float dx = length(P-vxl);
		ocolor.a = 1.0 - smoothstep(0.2,0.25, dx);
		//if modulation was applied, use that to scale alpha not color:
		ocolor.a *= length(ocolor.rgb);
		ocolor.rgb = normalize(ocolor.rgb);
		//compute distance one half voxel closer to viewer:
		float pan = 0.5;
		if (axCorSag == 0)
			vxl.z -= pan;
		if (axCorSag == 1)
			vxl.y -= pan;
		if (axCorSag == 2)
			vxl.x += pan;
		t = dot(vxl,v1);
		P = t * v1;
		float dx2 = length(P-vxl);
		ocolor.rgb += (dx2-dx-(0.5 * pan)) * 1.0;
	}
`+k,O=`#version 300 es
#line 480
precision highp int;
precision highp float;
uniform vec4 lineColor;
out vec4 color;
void main() {
	color = lineColor;
}`,G=`#version 300 es
#line 723
precision highp int;
precision highp float;

uniform vec4 lineColor;
uniform vec4 leftTopWidthHeight;
uniform float thickness; // line thickness in pixels
uniform vec2 canvasWidthHeight;

out vec4 color;

void main() {
    // fragment position in screen coordinates
    vec2 fragCoord = gl_FragCoord.xy;

    // canvas height
    float canvasHeight = canvasWidthHeight.y;

    // 'top' and 'bottom' to match gl_FragCoord.y coordinate system
    float top = canvasHeight - leftTopWidthHeight.y;
    float bottom = top - leftTopWidthHeight.w;

    // left and right edges
    float left = leftTopWidthHeight.x;
    float right = left + leftTopWidthHeight.z;

    bool withinLeft = fragCoord.x >= left && fragCoord.x <= left + thickness;
    bool withinRight = fragCoord.x <= right && fragCoord.x >= right - thickness;
    bool withinTop = fragCoord.y <= top && fragCoord.y >= top - thickness;
    bool withinBottom = fragCoord.y >= bottom && fragCoord.y <= bottom + thickness;

    bool isOutline = withinLeft || withinRight || withinTop || withinBottom;

    if (isOutline) {
        color = lineColor;
    } else {
        discard; 
    }
}`,K=`#version 300 es
#line 490
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vColor;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vColor = pos.xy;
}`,W=`#version 300 es
#line 506
precision highp int;
precision highp float;
uniform highp sampler2D colormap;
uniform float layer;
in vec2 vColor;
out vec4 color;
void main() {
	float nlayer = float(textureSize(colormap, 0).y);
	float fmap = (0.5 + layer) / nlayer;
	color = vec4(texture(colormap, vec2(vColor.x, fmap)).rgb, 1.0);
}`,H=`#version 300 es
#line 520
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
}`,Q=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec4 startXYendXY;
void main(void) {
	vec2 posXY = mix(startXYendXY.xy, startXYendXY.zw, pos.x);
	vec2 dir = normalize(startXYendXY.xy - startXYendXY.zw);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0
	gl_Position = vec4((posXY * 2.0) - 1.0, 0.0, 1.0);
}`,z=`#version 300 es
#line 534
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform float thickness;
uniform vec2 startXY;
uniform vec3 endXYZ; // transformed XYZ point
void main(void) {	
	vec2 posXY = mix(startXY.xy, endXYZ.xy, pos.x);
	vec2 startDiff = endXYZ.xy - startXY.xy;
	float startDistance = length(startDiff);
	vec2 diff = endXYZ.xy - posXY;
	float currentDistance = length(diff);
	vec2 dir = normalize(startXY.xy - endXYZ.xy);
	posXY += vec2(-dir.y, dir.x) * thickness * (pos.y - 0.5);
	posXY.x = (posXY.x) / canvasWidthHeight.x; //0..1
	posXY.y = 1.0 - (posXY.y / canvasWidthHeight.y); //1..0	
	float z = endXYZ.z * ( 1.0 - abs(currentDistance/startDistance)); 
	gl_Position = vec4((posXY * 2.0) - 1.0, z, 1.0);
}`,X=`#version 300 es
#line 549
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(pos.x, 1.0 - pos.y);
}`,q=`#version 300 es
#line 565
precision highp int;
precision highp float;
uniform highp sampler2D bmpTexture;
in vec2 vUV;
out vec4 color;
void main() {
	color = texture(bmpTexture, vUV);
}`,j=`#version 300 es
#line 576
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = vec2(uvLeftTopWidthHeight.x + (pos.x * uvLeftTopWidthHeight.z), uvLeftTopWidthHeight.y  + ((1.0 - pos.y) * uvLeftTopWidthHeight.w) );
}`,Z=`#version 300 es
#line 593
precision highp int;
precision highp float;
uniform highp sampler2D fontTexture;
uniform vec4 fontColor;
uniform float screenPxRange;
in vec2 vUV;
out vec4 color;
float median(float r, float g, float b) {
	return max(min(r, g), min(max(r, g), b));
}
void main() {
	vec3 msd = texture(fontTexture, vUV).rgb;
	float sd = median(msd.r, msd.g, msd.b);
	float screenPxDistance = screenPxRange*(sd - 0.5);
	float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);
	color = vec4(fontColor.rgb , fontColor.a * opacity);
}`,J=`#version 300 es
layout(location=0) in vec3 pos;
uniform vec2 canvasWidthHeight;
uniform vec4 leftTopWidthHeight;
uniform vec4 uvLeftTopWidthHeight;
out vec2 vUV;
void main(void) {
	//convert pixel x,y space 1..canvasWidth,1..canvasHeight to WebGL 1..-1,-1..1
	vec2 frac;
	frac.x = (leftTopWidthHeight.x + (pos.x * leftTopWidthHeight.z)) / canvasWidthHeight.x; //0..1
	frac.y = 1.0 - ((leftTopWidthHeight.y + ((1.0 - pos.y) * leftTopWidthHeight.w)) / canvasWidthHeight.y); //1..0
	frac = (frac * 2.0) - 1.0;
	gl_Position = vec4(frac, 0.0, 1.0);
	vUV = pos.xy;
}`,_=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 circleColor;
uniform float fillPercent;
in vec2 vUV;
out vec4 color;
void main() {
	/* Check if the pixel is inside the circle
		 and color it with a gradient. Otherwise, color it 
		 transparent   */
	float distance = length(vUV-vec2(0.5,0.5));
	if ( distance < 0.5 && distance >= (1.0 - fillPercent) / 2.0){
			color = vec4(circleColor.r,circleColor.g,circleColor.b,circleColor.a) ;			
	}else{
			color = vec4(0.0,0.0,0.0,0.0);
	}
}
`,$=`#version 300 es
#line 613
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4( (vPos.xy-vec2(0.5,0.5)) * 2.0, 0.0, 1.0);
}`,ee=`#version 300 es
uniform highp usampler3D intensityVol;
`,et=`#version 300 es
uniform highp isampler3D intensityVol;
`,ei=`#version 300 es
uniform highp sampler3D intensityVol;
`,er=`#line 636
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform vec4 xyzaFrac;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.x, TexCoord.y, coordZ, 1.0) * mtx;
	uint idx = uint(texture(intensityVol, vx.xyz).r);
	FragColor = vec4(0.0, 0.0, 0.0, 0.0);
	if (idx == uint(0))
		return;
	//idx = ((idx - uint(1)) % uint(100))+uint(1);
	float textureWidth = float(textureSize(colormap, 0).x);
	float fx = (float(idx)+0.5) / textureWidth;
	float nlayer = float(textureSize(colormap, 0).y);
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(fx, y)).rgba;
	float alpha = FragColor.a;
	FragColor.a *= opacity;
	if (xyzaFrac.a > 0.0) { //outline
		vx = vec4(TexCoord.x+xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint R = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x-xyzaFrac.x, TexCoord.y, coordZ, 1.0) * mtx;
		uint L = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y+xyzaFrac.y, coordZ, 1.0) * mtx;
		uint A = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y-xyzaFrac.y, coordZ, 1.0) * mtx;
		uint P = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ+xyzaFrac.z, 1.0) * mtx;
		uint S = uint(texture(intensityVol, vx.xyz).r);
		vx = vec4(TexCoord.x, TexCoord.y, coordZ-xyzaFrac.z, 1.0) * mtx;
		uint I = uint(texture(intensityVol, vx.xyz).r);
		if ((idx != R) || (idx != L) || (idx != A) || (idx != P) || (idx != S) || (idx != I))
			FragColor.a = alpha * xyzaFrac.a;
	}
}`,es=`#line 691
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform float cal_maxNeg;
uniform float cal_minNeg;
uniform bool isAlphaThreshold;
uniform bool isAdditiveBlend;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform int modulation;
uniform highp sampler3D modulationVol;
uniform float opacity;
uniform mat4 mtx;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	if ((vx.x < 0.0) || (vx.x > 1.0) || (vx.y < 0.0) || (vx.y > 1.0) || (vx.z < 0.0) || (vx.z > 1.0)) {
		//set transparent if out of range
		//https://webglfundamentals.org/webgl/webgl-3d-textures-repeat-clamp.html
		FragColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
		return;
	}
	float f = (scl_slope * float(texture(intensityVol, vx.xyz).r)) + scl_inter;
	float mn = cal_min;
	float mx = cal_max;
	if (isAlphaThreshold)
		mn = 0.0;
	float r = max(0.00001, abs(mx - mn));
	mn = min(mn, mx);
	float txl = mix(0.0, 1.0, (f - mn) / r);
	//https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space
	float nlayer = float(textureSize(colormap, 0).y);
	//each volume has two color maps:
	// (layer*2) = negative and (layer * 2) + 1 = postive
	float y = ((2.0 * layer) + 1.5)/nlayer;
	FragColor = texture(colormap, vec2(txl, y)).rgba;
	//negative colors
	mn = cal_minNeg;
	mx = cal_maxNeg;
	if (isAlphaThreshold)
		mx = 0.0;
	//if ((!isnan(cal_minNeg)) && ( f < mx)) {
	if ((cal_minNeg < cal_maxNeg) && ( f < mx)) {
		r = max(0.00001, abs(mx - mn));
		mn = min(mn, mx);
		txl = 1.0 - mix(0.0, 1.0, (f - mn) / r);
		y = ((2.0 * layer) + 0.5)/nlayer;
		FragColor = texture(colormap, vec2(txl, y));
	}
	if (layer > 0.7)
		FragColor.a = step(0.00001, FragColor.a);
	//if (modulation > 10)
	//	FragColor.a *= texture(modulationVol, vx.xyz).r;
	//	FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (isAlphaThreshold) {
		if ((cal_minNeg != cal_maxNeg) && ( f < 0.0) && (f > cal_maxNeg))
			FragColor.a = pow(-f / -cal_maxNeg, 2.0);
		else if ((f > 0.0) && (cal_min > 0.0))
			FragColor.a *= pow(f / cal_min, 2.0); //issue435:  A = (V/X)**2
		//FragColor.g = 0.0;
	}
	if (modulation == 1) {
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	} else if (modulation == 2) {
		FragColor.a = texture(modulationVol, vx.xyz).r;
	}
	FragColor.a *= opacity;
	if (layer < 1.0) return;
	vec4 prevColor = texture(blend3D, vec3(TexCoord.xy, coordZ));
	// https://en.wikipedia.org/wiki/Alpha_compositing
	float aout = FragColor.a + (1.0 - FragColor.a) * prevColor.a;
	if (aout <= 0.0) return;
	if (isAdditiveBlend)
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a)) / aout;
	else
		FragColor.rgb = ((FragColor.rgb * FragColor.a) + (prevColor.rgb * prevColor.a * (1.0 - FragColor.a))) / aout;
	FragColor.a = aout;
}`,ea=`#line 773
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float layer;
uniform float scl_slope;
uniform float scl_inter;
uniform float cal_max;
uniform float cal_min;
uniform highp sampler2D colormap;
uniform lowp sampler3D blend3D;
uniform float opacity;
uniform mat4 mtx;
uniform bool hasAlpha;
uniform int modulation;
uniform highp sampler3D modulationVol;
void main(void) {
	vec4 vx = vec4(TexCoord.xy, coordZ, 1.0) * mtx;
	uvec4 aColor = texture(intensityVol, vx.xyz);
	FragColor = vec4(float(aColor.r) / 255.0, float(aColor.g) / 255.0, float(aColor.b) / 255.0, float(aColor.a) / 255.0);
	if (modulation == 1)
		FragColor.rgb *= texture(modulationVol, vx.xyz).r;
	if (!hasAlpha) {
		FragColor.a = (FragColor.r * 0.21 + FragColor.g * 0.72 + FragColor.b * 0.07);
		//next line: we could binarize alpha, but see rendering of visible human
		//FragColor.a = step(0.01, FragColor.a);
	}
	if (modulation == 2)
		FragColor.a = texture(modulationVol, vx.xyz).r;
	FragColor.a *= opacity;
}`,el=`#version 300 es
#line 808
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	gl_Position = vec4((vPos.x - 0.5) * 2.0, (vPos.y - 0.5) * 2.0, 0.0, 1.0);
}`,eo=`#version 300 es
#line 829
	precision highp float;
	precision highp int;
	precision highp isampler3D;
	layout(location = 0) out int label;
	layout(location = 1) out int strength;
	in vec2 TexCoord;
	uniform int finalPass;
	uniform float coordZ;
	uniform lowp sampler3D in3D;
	uniform highp isampler3D backTex; // background
	uniform highp isampler3D labelTex; // label
	uniform highp isampler3D strengthTex; // strength
void main(void) {
	vec3 interpolatedTextureCoordinate = vec3(TexCoord.xy, coordZ);
	ivec3 size = textureSize(backTex, 0);
	ivec3 texelIndex = ivec3(floor(interpolatedTextureCoordinate * vec3(size)));
	int background = texelFetch(backTex, texelIndex, 0).r;
	label = texelFetch(labelTex, texelIndex, 0).r;
	strength = texelFetch(strengthTex, texelIndex, 0).r;
	for (int k = -1; k <= 1; k++) {
		for (int j = -1; j <= 1; j++) {
			for (int i = -1; i <= 1; i++) {
				if (i != 0 && j != 0 && k != 0) {
					ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
					int neighborBackground = texelFetch(backTex, neighborIndex, 0).r;
					int neighborStrength = texelFetch(strengthTex, neighborIndex, 0).r;
					int strengthCost = abs(neighborBackground - background);
					int takeoverStrength = neighborStrength - strengthCost;
					if (takeoverStrength > strength) {
						strength = takeoverStrength;
						label = texelFetch(labelTex, neighborIndex, 0).r;
					}
				}
			}
		}
	}
	if (finalPass < 1)
		return;
	int ok = 1;
	ivec4 labelCount = ivec4(0,0,0,0);
	for (int k = -1; k <= 1; k++)
		for (int j = -1; j <= 1; j++)
			for (int i = -1; i <= 1; i++) {
				ivec3 neighborIndex = texelIndex + ivec3(i,j,k);
				int ilabel = texelFetch(labelTex, neighborIndex, 0).r;
				if ((ilabel < 0) || (ilabel > 3))
					ok = 0;
				else
					labelCount[ilabel]++;
			}
	if (ok != 1) {
		return;
	}
	int maxIdx = 0;
	for (int i = 1; i < 4; i++) {
		if (labelCount[i] > labelCount[maxIdx])
			maxIdx = i;
	}
	label = maxIdx;
}`,en=`#version 300 es
layout(location=0) in vec3 pos;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
}`,eh=`#version 300 es
precision highp int;
precision highp float;
uniform vec4 surfaceColor;
out vec4 color;
void main() {
	color = surfaceColor;
}`,ed=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 clr;
out vec4 vClr;
uniform mat4 mvpMtx;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vClr = clr;
}`,ec=`#version 300 es
precision highp int;
precision highp float;
in vec4 vClr;
out vec4 color;
uniform float opacity;
void main() {
	color = vec4(vClr.rgb, opacity);
}`,em=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
out vec3 vN;
out vec4 vP;
out vec4 vPc;
void main(void) {
	vec3 lightPosition = vec3(0.0, 0.0, -10.0);
	vP = vec4(pos, 1.0);
	vPc = mvpMtx * vec4(pos, 1.0);
	gl_Position = vPc;
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,eA=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
out vec4 color;
vec4 packFloatToVec4i(const float value) {
	const vec4 bitSh = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
	const vec4 bitMsk = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
	vec4 res = fract(value * bitSh);
	res -= res.xxyz * bitMsk;
	return res;
}
void main() {
	color = packFloatToVec4i(gl_FragCoord.z);
}`,eg=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
float stepmix(float edge0, float edge1, float E, float x){
	float T = clamp(0.5 * (x - edge0 + E) / E, 0.0, 1.0);
	return mix(edge0, edge1, T);
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0);
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.5;
	float shininess = 50.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float df = max(0.0, dot(n, l));
	float sf = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	const float A = 0.1;
	const float B = 0.3;
	const float C = 0.6;
	const float D = 1.0;
	float E = fwidth(df);
	if (df > A - E && df < A + E) df = stepmix(A, B, E, df);
	else if (df > B - E && df < B + E) df = stepmix(B, C, E, df);
	else if (df > C - E && df < C + E) df = stepmix(C, D, E, df);
	else if (df < A) df = 0.0;
	else if (df < B) df = B;
	else if (df < C) df = C;
	else df = D;
	E = fwidth(sf);
	if (sf > 0.5 - E && sf < 0.5 + E)
		sf = smoothstep(0.5 - E, 0.5 + E, sf);
	else
		sf = step(0.5, sf);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(df, 0.0) * vClr.rgb * diffuse;
	color.rgb = a + d + (specular * sf);
	color.a = opacity;
}`,eu=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.25;
	float shininess = 10.0;
	float PenWidth = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	float view = abs(dot(n,r)); //with respect to viewer
	if (PenWidth < view) discard;
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color.rgb = a + d + s;
	color.a = opacity;
}`,ef=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float diffuse = 1.0;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 0.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d = lightNormDot * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(d + s, opacity);
}`,ep=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float diffuse = 1.4;
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(normalize(vN), l), 0.0);
	color = vec4(lightNormDot * vClr.rgb * diffuse, opacity);
}`,ev=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float specularRGB = 0.7;
	float specularWhite = 0.3;
	float shininess = 10.0;
	float diffuse = 1.0;
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	vec3 n = normalize(vN);
	vec3 l = vec3(0.0, 0.0, -1.0);
	float lightNormDot = max(dot(n, l), 0.0);
	vec3 d3 = lightNormDot * vClr.rgb * diffuse;
	float s = pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 s3 = specularRGB * s * vClr.rgb;
	s *= specularWhite;
	color = vec4(d3 + s3 + s, opacity);
}`,ex=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
in vec4 vPc;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	// Compute curvature
	vec3 dx = dFdx(n);
	vec3 dy = dFdy(n);
	vec3 xneg = n - dx;
	vec3 xpos = n + dx;
	vec3 yneg = n - dy;
	vec3 ypos = n + dy;
	float depth = length(vPc.xyz);
	float curv = (cross(xneg, xpos).y - cross(yneg, ypos).x) / depth;
	//at this stage 0.5 for flat, with valleys dark and ridges bright
	curv = 1.0 - (curv + 0.5);
	//clamp
	curv =  min(max(curv, 0.0), 1.0);
	// easing function
	curv = pow(curv, 0.5);
	//modulate ambient and diffuse with curvature
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.6;
	float diffuse = 0.6;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 lightPosition = vec3(0.0, 10.0, -2.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient * curv;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,ew=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,eC=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
uniform sampler2D matCap;
out vec4 color;
void main() {
	vec3 n = normalize(vN);
	vec2 uv = n.xy * 0.5 + 0.5;
	uv.y = 1.0 - uv.y;
	vec3 clr = texture(matCap,uv.xy).rgb * vClr.rgb;
	color = vec4(clr, opacity);
}`,eb=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	float ambient = 0.35;
	float diffuse = 0.6;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	color = vec4(a + d, opacity);
}`,ey=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 up = vec3(0.0, 1.0, 0.0);
	float ax = dot(n, up) * 0.5 + 0.5;  //Shreiner et al. (2013) OpenGL Programming Guide, 8th Ed., p 388. ISBN-10: 0321773039
	vec3 upClr = vec3(1.0, 1.0, 0.95);
	vec3 downClr = vec3(0.4, 0.4, 0.6);
	vec3 a = vClr.rgb * ambient;
	a *= mix(downClr, upClr, ax);
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,eI=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
in vec3 vN;
out vec4 color;
//Spherical harmonics constants
const float C1 = 0.429043;
const float C2 = 0.511664;
const float C3 = 0.743125;
const float C4 = 0.886227;
const float C5 = 0.247708;
//Spherical harmonics coefficients
// Ramamoorthi, R., and P. Hanrahan. 2001b. "An Efficient Representation for Irradiance Environment Maps." In Proceedings of SIGGRAPH 2001, pp. 497\u2013500.
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// https://github.com/eskimoblood/processingSketches/blob/master/data/shader/shinyvert.glsl
// Constants for Eucalyptus Grove lighting
const vec3 L00  = vec3( 0.3783264,  0.4260425,  0.4504587);
const vec3 L1m1 = vec3( 0.2887813,  0.3586803,  0.4147053);
const vec3 L10  = vec3( 0.0379030,  0.0295216,  0.0098567);
const vec3 L11  = vec3(-0.1033028, -0.1031690, -0.0884924);
const vec3 L2m2 = vec3(-0.0621750, -0.0554432, -0.0396779);
const vec3 L2m1 = vec3( 0.0077820, -0.0148312, -0.0471301);
const vec3 L20  = vec3(-0.0935561, -0.1254260, -0.1525629);
const vec3 L21  = vec3(-0.0572703, -0.0502192, -0.0363410);
const vec3 L22  = vec3( 0.0203348, -0.0044201, -0.0452180);
vec3 SH(vec3 vNormal) {
	vNormal = vec3(vNormal.x,vNormal.z,vNormal.y);
	vec3 diffuseColor = C1 * L22 * (vNormal.x * vNormal.x - vNormal.y * vNormal.y) +
	C3 * L20 * vNormal.z * vNormal.z +
	C4 * L00 -
	C5 * L20 +
	2.0 * C1 * L2m2 * vNormal.x * vNormal.y +
	2.0 * C1 * L21  * vNormal.x * vNormal.z +
	2.0 * C1 * L2m1 * vNormal.y * vNormal.z +
	2.0 * C2 * L11  * vNormal.x +
	2.0 * C2 * L1m1 * vNormal.y +
	2.0 * C2 * L10  * vNormal.z;
	return diffuseColor;
}
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.3;
	float diffuse = 0.6;
	float specular = 0.1;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	vec3 a = vClr.rgb * ambient;
	vec3 d = vClr.rgb * diffuse * SH(-reflect(n, vec3(l.x, l.y, -l.z)) );
	color = vec4(a + d + s, opacity);
}`,eM=`#version 300 es
layout(location=0) in vec3 pos;
layout(location=1) in vec4 norm;
layout(location=2) in vec4 clr;
uniform mat4 mvpMtx;
//uniform mat4 modelMtx;
uniform mat4 normMtx;
out vec4 vClr;
flat out vec3 vN;
void main(void) {
	gl_Position = mvpMtx * vec4(pos, 1.0);
	vN = normalize((normMtx * vec4(norm.xyz,1.0)).xyz);
	//vV = -vec3(modelMtx*vec4(pos,1.0));
	vClr = clr;
}`,eD=`#version 300 es
precision highp int;
precision highp float;
uniform float opacity;
in vec4 vClr;
flat in vec3 vN;
out vec4 color;
void main() {
	vec3 r = vec3(0.0, 0.0, 1.0); //rayDir: for orthographic projections moving in Z direction (no need for normal matrix)
	float ambient = 0.35;
	float diffuse = 0.5;
	float specular = 0.2;
	float shininess = 10.0;
	vec3 n = normalize(vN);
	vec3 lightPosition = vec3(0.0, 10.0, -5.0);
	vec3 l = normalize(lightPosition);
	float lightNormDot = dot(n, l);
	vec3 a = vClr.rgb * ambient;
	vec3 d = max(lightNormDot, 0.0) * vClr.rgb * diffuse;
	float s = specular * pow(max(dot(reflect(l, n), r), 0.0), shininess);
	color = vec4(a + d + s, opacity);
}`,eF=`#version 300 es
#line 1260
//precision highp int;
precision highp float;
uniform vec3 rayDir;
uniform vec3 volScale;
uniform vec3 texVox;
uniform vec4 clipPlane;
uniform highp sampler3D volume, overlay;
uniform float overlays;
uniform float clipThick;
uniform vec3 clipLo;
uniform vec3 clipHi;
uniform mat4 matRAS;
uniform mat4 mvpMtx;
uniform float drawOpacity, renderOverlayBlend;
uniform highp sampler3D drawing;
uniform highp sampler2D colormap;
uniform int backgroundMasksOverlays;
in vec3 vColor;
out vec4 fColor;
`+E+`
void main() {
	int id = 254;
	vec3 start = vColor;
	gl_FragDepth = 0.0;
	fColor = vec4(0.0, 0.0, 0.0, 0.0); //assume no hit: ID = 0
	float fid = float(id & 255)/ 255.0;
	vec3 backPosition = GetBackPosition(start);
	vec3 dir = normalize(backPosition - start);
	clipVolumeStart(start, backPosition);
	float len = length(backPosition - start);
	float lenVox = length((texVox * start) - (texVox * backPosition));
	if ((lenVox < 0.5) || (len > 3.0)) return;//discard; //length limit for parallel rays
	float sliceSize = len / lenVox; //e.g. if ray length is 1.0 and traverses 50 voxels, each voxel is 0.02 in unit cube
	float stepSize = sliceSize; //quality: larger step is faster traversal, but fewer samples
	float opacityCorrection = stepSize/sliceSize;
	dir = normalize(dir);
	vec4 samplePos = vec4(start.xyz, 0.0); //ray position
	float lenNoClip = len;
	bool isClip = false;
	vec4 clipPos = applyClip(dir, samplePos, len, isClip);
	if (isClip) fColor = vec4(samplePos.xyz, 253.0 / 255.0); //assume no hit: ID = 0
	//start: OPTIONAL fast pass: rapid traversal until first hit
	float stepSizeFast = sliceSize * 1.9;
	vec4 deltaDirFast = vec4(dir.xyz * stepSizeFast, stepSizeFast);
	while (samplePos.a <= len) {
		float val = texture(volume, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			break;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//end: fast pass
	if ((overlays < 1.0) || (backgroundMasksOverlays > 0)) {
		return; //background hit, no overlays
	}
	//overlay pass
	len = min(lenNoClip, samplePos.a); //only find overlay closer than background
	samplePos = vec4(start.xyz, 0.0); //ray position
	while (samplePos.a <= len) {
		float val = texture(overlay, samplePos.xyz).a;
		if (val > 0.01) {
			fColor = vec4(samplePos.rgb, fid);
			gl_FragDepth = frac2ndc(samplePos.xyz);
			return;
		}
		samplePos += deltaDirFast; //advance ray position
	}
	//if (fColor.a == 0.0) discard; //no hit in either background or overlays
	//you only get here if there is a hit with the background that is closer than any overlay
}`,eT=`#version 300 es
// an attribute is an input (in) to a vertex shader.
// It will receive data from a buffer
layout(location=0)  in vec3 a_position;
layout(location=1)  in vec3 a_color;
// A matrix to transform the positions by
uniform mat4 u_matrix;
out vec3 vColor;
// all shaders have a main function
void main() {
	// Multiply the position by the matrix.
	vec4 pos = vec4(a_position, 1.0);
	gl_Position = u_matrix * vec4(pos);
	vColor = a_color;
}
`,eE=`#version 300 es
precision highp float;
uniform vec4 u_color;
in vec3 vColor;
out vec4 outColor;
void main() {
	outColor = vec4(vColor, 1.0);
}`,eS=`#version 300 es
#line 1359
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
	TexCoord = vPos.xy;
	vec2 viewCoord = (vPos.xy - 0.5) * 2.0;
	gl_Position = vec4((vPos.xy - 0.5) * 2.0, 0.0, 1.0);
}`,eV=`#version 300 es
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform lowp sampler3D in3D;
void main(void) {
 FragColor = texture(in3D, vec3(TexCoord.xy, coordZ));
}`,eB=`#version 300 es
#line 286
precision highp int;
precision highp float;
in vec3 vPos;
out vec2 TexCoord;
void main() {
    TexCoord = vPos.xy;
    gl_Position = vec4( (vPos.xy-vec2(0.5,0.5))* 2.0, 0.0, 1.0);
}`,eU=`#version 300 es
#line 298
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
 vec3 vx = vec3(TexCoord.xy, coordZ);
 vec4 samp = texture(intensityVol,vx+vec3(+dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(+dX,-dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,+dY,-dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,+dZ));
 samp += texture(intensityVol,vx+vec3(-dX,-dY,-dZ));
 FragColor = samp*0.125;
}`,eR=`#version 300 es
#line 323
precision highp int;
precision highp float;
in vec2 TexCoord;
out vec4 FragColor;
uniform float coordZ;
uniform float dX;
uniform float dY;
uniform float dZ;
uniform highp sampler3D intensityVol;
void main(void) {
  vec3 vx = vec3(TexCoord.xy, coordZ);
  //Neighboring voxels 'T'op/'B'ottom, 'A'nterior/'P'osterior, 'R'ight/'L'eft
  float TAR = texture(intensityVol,vx+vec3(+dX,+dY,+dZ)).r;
  float TAL = texture(intensityVol,vx+vec3(+dX,+dY,-dZ)).r;
  float TPR = texture(intensityVol,vx+vec3(+dX,-dY,+dZ)).r;
  float TPL = texture(intensityVol,vx+vec3(+dX,-dY,-dZ)).r;
  float BAR = texture(intensityVol,vx+vec3(-dX,+dY,+dZ)).r;
  float BAL = texture(intensityVol,vx+vec3(-dX,+dY,-dZ)).r;
  float BPR = texture(intensityVol,vx+vec3(-dX,-dY,+dZ)).r;
  float BPL = texture(intensityVol,vx+vec3(-dX,-dY,-dZ)).r;
  vec4 gradientSample = vec4 (0.0, 0.0, 0.0, 0.0);
  gradientSample.r =   BAR+BAL+BPR+BPL -TAR-TAL-TPR-TPL;
  gradientSample.g =  TPR+TPL+BPR+BPL -TAR-TAL-BAR-BAL;
  gradientSample.b =  TAL+TPL+BAL+BPL -TAR-TPR-BAR-BPR;
  gradientSample.a = (abs(gradientSample.r)+abs(gradientSample.g)+abs(gradientSample.b))*0.29;
  gradientSample.rgb = normalize(gradientSample.rgb);
  gradientSample.rgb =  (gradientSample.rgb * 0.5)+0.5;
  FragColor = gradientSample;
}`,eN=new Float32Array([-1,-1,-1,.28,.28,.28,-1,-1,-1,.28,.28,.28,-1,1,-1,.28,.28,.28,1,-1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,1,1,-1,.28,.28,.28,-1,-1,1,.8,.8,.8,-1,-1,1,.8,.8,.8,1,-1,1,.8,.8,.8,-1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,1,1,1,.8,.8,.8,-1,1,-1,0,0,.74,-1,1,-1,0,0,.74,-1,1,1,0,0,.74,1,1,-1,0,0,.74,1,1,1,0,0,.74,1,1,1,0,0,.74,-1,-1,-1,.42,0,.42,-1,-1,-1,.42,0,.42,1,-1,-1,.42,0,.42,-1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,1,-1,1,.42,0,.42,-1,-1,-1,.64,0,0,-1,-1,-1,.64,0,0,-1,-1,1,.64,0,0,-1,1,-1,.64,0,0,-1,1,1,.64,0,0,-1,1,1,.64,0,0,1,-1,-1,0,.5,0,1,-1,-1,0,.5,0,1,1,-1,0,.5,0,1,-1,1,0,.5,0,1,1,1,0,.5,0,1,1,1,0,.5,0,-.45,1,-.8,0,0,0,-.45,1,-.8,0,0,0,-.45,1,.8,0,0,0,-.25,1,-.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.8,0,0,0,-.25,1,.6,0,0,0,-.25,1,.6,0,0,0,-.25,1,.8,0,0,0,.45,1,.6,0,0,0,.25,1,.8,0,0,0,.25,1,.8,0,0,0,.25,1,.1,0,0,0,.25,1,.1,0,0,0,.25,1,.6,0,0,0,.45,1,.1,0,0,0,.45,1,.6,0,0,0,.45,1,.6,0,0,0,-.25,1,-.1,0,0,0,-.25,1,-.1,0,0,0,-.25,1,.1,0,0,0,.25,1,-.1,0,0,0,.45,1,.1,0,0,0,.45,1,.1,0,0,0,.45,-1,-.8,0,0,0,.45,-1,-.8,0,0,0,.05,-1,.8,0,0,0,.25,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,-.25,-1,-.8,0,0,0,-.25,-1,-.8,0,0,0,.05,-1,.8,0,0,0,-.45,-1,-.8,0,0,0,-.15,-1,.8,0,0,0,-.15,-1,.8,0,0,0,.13,-1,-.3,0,0,0,.13,-1,-.3,0,0,0,.07,-1,-.1,0,0,0,-.33,-1,-.3,0,0,0,-.27,-1,-.1,0,0,0,-.27,-1,-.1,0,0,0,-.45,.6,1,0,0,0,-.45,.6,1,0,0,0,-.45,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.4,1,0,0,0,-.25,.4,1,0,0,0,-.25,.8,1,0,0,0,-.25,.8,1,0,0,0,-.25,.6,1,0,0,0,.25,.8,1,0,0,0,.45,.6,1,0,0,0,.45,.6,1,0,0,0,.25,.8,1,0,0,0,.25,.8,1,0,0,0,.25,-.1,1,0,0,0,.45,.6,1,0,0,0,.45,.1,1,0,0,0,.45,.1,1,0,0,0,-.25,.1,1,0,0,0,-.25,.1,1,0,0,0,-.45,-.1,1,0,0,0,.25,.1,1,0,0,0,.25,-.1,1,0,0,0,.25,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.1,1,0,0,0,-.45,-.6,1,0,0,0,-.25,-.1,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.8,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.6,1,0,0,0,-.25,-.8,1,0,0,0,.45,-.6,1,0,0,0,.25,-.8,1,0,0,0,.25,-.8,1,0,0,0,.25,-.4,1,0,0,0,.25,-.4,1,0,0,0,.25,-.6,1,0,0,0,.45,-.4,1,0,0,0,.45,-.6,1,0,0,0,.45,-.6,1,0,0,0,-.1,-.8,-1,0,0,0,-.1,-.8,-1,0,0,0,-.1,.8,-1,0,0,0,.1,-.8,-1,0,0,0,.1,.8,-1,0,0,0,.1,.8,-1,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,-.8,0,0,0,-1,-.45,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.8,0,0,0,-1,-.25,-.6,0,0,0,-1,.45,-.8,0,0,0,-1,.45,-.6,0,0,0,-1,.45,-.6,0,0,0,1,.45,-.8,0,0,0,1,.45,-.8,0,0,0,1,.45,.8,0,0,0,1,.25,-.8,0,0,0,1,.25,.8,0,0,0,1,.25,.8,0,0,0,1,.25,.6,0,0,0,1,.25,.6,0,0,0,1,.25,.8,0,0,0,1,-.45,.6,0,0,0,1,-.25,.8,0,0,0,1,-.25,.8,0,0,0,1,-.25,.1,0,0,0,1,-.25,.1,0,0,0,1,-.25,.6,0,0,0,1,-.45,.1,0,0,0,1,-.45,.6,0,0,0,1,-.45,.6,0,0,0,1,.25,-.1,0,0,0,1,.25,-.1,0,0,0,1,.25,.1,0,0,0,1,-.25,-.1,0,0,0,1,-.45,.1,0,0,0,1,-.45,.1,0,0,0,1,-.25,-.8,0,0,0,1,-.25,-.8,0,0,0,1,-.05,-.1,0,0,0,1,-.45,-.8,0,0,0,1,-.25,-.1,0,0,0,1,-.25,-.1,0,0,0]),eP=class{constructor(e,t,i,r,s=null,a=null){C(this,"sphereIdx",[]),C(this,"sphereVtx",[]),C(this,"renderShaders",[]),C(this,"isVisible",!0),C(this,"isPickable",!0),C(this,"vertexBuffer"),C(this,"indexCount"),C(this,"indexBuffer"),C(this,"vao"),C(this,"mode"),C(this,"glFlags",0),C(this,"id"),C(this,"colorId"),C(this,"modelMatrix",h.Ue()),C(this,"scale",[1,1,1]),C(this,"position",[0,0,0]),C(this,"rotation",[0,0,0]),C(this,"rotationRadians",0),C(this,"extentsMin",[]),C(this,"extentsMax",[]),C(this,"furthestVertexFromOrigin"),C(this,"originNegate"),C(this,"fieldOfViewDeObliqueMM"),C(this,"mm"),this.vertexBuffer=t,this.indexCount=r,this.indexBuffer=s,this.vao=a,this.mode=i,this.id=e,this.colorId=[(e>>0&255)/255,(e>>8&255)/255,(e>>16&255)/255,(e>>24&255)/255]}};C(eP,"BLEND",1),C(eP,"CULL_FACE",2),C(eP,"CULL_FRONT",4),C(eP,"CULL_BACK",8),C(eP,"ENABLE_DEPTH_TEST",16),C(eP,"generateCrosshairs",function(e,t,i,r,s,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:20,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,n=eP.generateCrosshairsGeometry(e,i,r,s,a,l,o);return new eP(t,n.vertexBuffer,e.TRIANGLES,n.indexCount,n.indexBuffer,n.vao)}),C(eP,"generateCrosshairsGeometry",function(e,t,i,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=[],h=[],d=s*l;if(d<=0){let e=n.al(i[0],t[1],t[2]),l=n.al(r[0],t[1],t[2]);eP.makeCylinder(o,h,e,l,s,a),e=n.al(t[0],i[1],t[2]),l=n.al(t[0],r[1],t[2]),eP.makeCylinder(o,h,e,l,s,a),e=n.al(t[0],t[1],i[2]),l=n.al(t[0],t[1],r[2]),eP.makeCylinder(o,h,e,l,s,a)}else{let e=n.al(i[0],t[1],t[2]),l=n.al(t[0]-d,t[1],t[2]);eP.makeCylinder(o,h,e,l,s,a,!1),e=n.al(t[0]+d,t[1],t[2]),l=n.al(r[0],t[1],t[2]),eP.makeCylinder(o,h,e,l,s,a,!1),e=n.al(t[0],i[1],t[2]),l=n.al(t[0],t[1]-d,t[2]),eP.makeCylinder(o,h,e,l,s,a,!1),e=n.al(t[0],t[1]+d,t[2]),l=n.al(t[0],r[1],t[2]),eP.makeCylinder(o,h,e,l,s,a,!1),e=n.al(t[0],t[1],i[2]),l=n.al(t[0],t[1],t[2]-d),eP.makeCylinder(o,h,e,l,s,a,!1),e=n.al(t[0],t[1],t[2]+d),l=n.al(t[0],t[1],r[2]),eP.makeCylinder(o,h,e,l,s,a,!1)}let c=e.createBuffer();if(null===c)throw Error("could not instantiate vertex buffer");e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW);let m=e.createBuffer();if(null===m)throw Error("could not instantiate index buffer");e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,m),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint32Array(h),e.STATIC_DRAW);let A=e.createVertexArray();return e.bindVertexArray(A),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,m),e.bindBuffer(e.ARRAY_BUFFER,c),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,3,e.FLOAT,!1,0,0),e.bindVertexArray(null),{vertexBuffer:c,indexBuffer:m,indexCount:h.length,vao:A}}),C(eP,"getFirstPerpVector",function(e){let t=n.al(0,0,0);return 0===e[0]?t[0]=1:0===e[1]?t[1]=1:0===e[2]?t[2]=1:(t[0]=e[2],t[1]=e[2],t[2]=-(e[0]+e[1]),n.Fv(t,t)),t}),C(eP,"subdivide",function(e,t){let i=e.length/3,r=t.length/3,s=r,a=n.Ue(),l=n.Ue();for(let o=0;o<s;o++){let s=t[3*o+0],h=t[3*o+1],d=t[3*o+2],c=n.al(e[3*s+0],e[3*s+1],e[3*s+2]),m=n.al(e[3*h+0],e[3*h+1],e[3*h+2]),A=n.al(e[3*d+0],e[3*d+1],e[3*d+2]);n.IH(a,c,m),n.Fv(l,a),e.push(...l),n.IH(a,m,A),n.Fv(l,a),e.push(...l),n.IH(a,c,A),n.Fv(l,a),e.push(...l);let g=[i,i+1,i+2];t.push(...g),g=[s,i,i+2],t.push(...g),g=[i,h,i+1],t.push(...g),t[3*o+0]=i+2,t[3*o+1]=i+1,t[3*o+2]=d,r+=3,i+=3}}),C(eP,"weldVertices",function(e,t){let i=e.length/3,r=0,s=new Int32Array(i);for(let t=0;t<i-1;t++){if(0!==s[t])continue;s[t]=r;let a=3*t,l=e[a],o=e[a+1],n=e[a+2];for(let h=t+1;h<i;h++)l===e[a+=3]&&o===e[a+1]&&n===e[a+2]&&(s[h]=r);r++}if(r===i)return e;let a=t.length;for(let e=0;e<a;e++)t[e]=s[t[e]];let l=e.slice(0,3*r-1);for(let t=0;t<i-1;t++){let i=3*t,r=3*s[t];l[r]=e[i],l[r+1]=e[i+1],l[r+2]=e[i+2]}return l}),C(eP,"makeSphere",function(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],s=[0,0,1,.894,0,.447,.276,.851,.447,-.724,.526,.447,-.724,-.526,.447,.276,-.851,.447,.724,.526,-.447,-.276,.851,-.447,-.894,0,-.447,-.276,-.851,-.447,.724,-.526,-.447,0,0,-1],a=[0,1,2,0,2,3,0,3,4,0,4,5,0,5,1,7,6,11,8,7,11,9,8,11,10,9,11,6,10,11,6,2,1,7,3,2,8,4,3,9,5,4,10,1,5,6,7,2,7,8,3,8,9,4,9,10,5,10,6,1];eP.subdivide(s,a),eP.subdivide(s,a),s=eP.weldVertices(s,a);for(let e=0;e<s.length;e++)s[e]=s[e]*i;let l=s.length/3,o=0;for(let e=0;e<l;e++)s[o]=s[o]+r[0],s[++o]=s[o]+r[1],s[++o]=s[o]+r[2],o++;let n=Math.floor(e.length/3);for(let e=0;e<a.length;e++)a[e]=a[e]+n;t.push(...a),e.push(...s)}),C(eP,"makeCylinder",function(e,t,i,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,l=!(arguments.length>6)||void 0===arguments[6]||arguments[6];a<3&&(a=3);let o=n.Ue();n.$X(o,r,i),n.Fv(o,o);let h=eP.getFirstPerpVector(o),d=n.Ue();n.kC(d,o,h),n.Fv(d,d);let c=2*a,m=2*a;l&&(m+=2*a,c+=2);let A=Math.floor(e.length/3),g=new Uint32Array(3*m),u=new Float32Array(3*c);function f(e,t){u[3*e+0]=t[0],u[3*e+1]=t[1],u[3*e+2]=t[2]}function p(e,t,i,r){g[3*e+0]=t+A,g[3*e+1]=i+A,g[3*e+2]=r+A}let v=2*a,x=v+1;l&&(f(v,i),f(x,r));let w=n.Ue(),C=n.Ue();for(let e=0;e<a;e++){let t=Math.cos(e/a*2*Math.PI),o=Math.sin(e/a*2*Math.PI);w[0]=s*(t*h[0]+o*d[0]),w[1]=s*(t*h[1]+o*d[1]),w[2]=s*(t*h[2]+o*d[2]),n.IH(C,i,w),f(e,C),n.IH(C,r,w),f(e+a,C);let c=0;e<a-1&&(c=e+1),p(2*e,e,c,e+a),p(2*e+1,c,c+a,e+a),l&&(p(2*a+e,e,v,c),p(2*a+e+a,x,e+a,c+a))}t.push(...g),e.push(...u)}),C(eP,"makeColoredCylinder",function(e,t,i,r,s,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[192,0,0,255],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:20,n=arguments.length>8&&void 0!==arguments[8]&&arguments[8],h=e.length/3;eP.makeCylinder(e,t,r,s,a,o,n),h=e.length/3-h;let d=[];for(let e=0;e<4*h-1;e+=4)d[e]=l[0],d[e+1]=l[1],d[e+2]=l[2],d[e+3]=l[3];i.push(...d)}),C(eP,"makeColoredSphere",function(e,t,i,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0,0],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[0,0,192,255],l=e.length/3;eP.makeSphere(e,t,r,s),l=e.length/3-l;let o=[];for(let e=0;e<4*l-1;e+=4)o[e]=a[0],o[e+1]=a[1],o[e+2]=a[2],o[e+3]=a[3];i.push(...o)});var ek={};((e,t)=>{for(var i in t)x(e,i,{get:t[i],enumerable:!0})})(ek,{$itksnap:()=>eL,$slicer3d:()=>eY,actc:()=>eO,afni_blues_inv:()=>tL,afni_reds_inv:()=>tY,bcgwhw:()=>eK,bcgwhw_dark:()=>eG,blue:()=>eX,blue2cyan:()=>eQ,blue2magenta:()=>eH,blue2red:()=>eW,bluegrn:()=>ez,bone:()=>eq,bronze:()=>ej,cet_l17:()=>eZ,cividis:()=>eJ,cool:()=>e_,copper:()=>e1,copper2:()=>e$,ct_airways:()=>e0,ct_artery:()=>e2,ct_bones:()=>e5,ct_brain:()=>e3,ct_brain_gray:()=>e4,ct_cardiac:()=>e6,ct_head:()=>e8,ct_kidneys:()=>e7,ct_liver:()=>e9,ct_muscles:()=>te,ct_scalp:()=>tt,ct_skull:()=>ti,ct_soft:()=>tr,ct_soft_tissue:()=>ts,ct_surface:()=>ta,ct_vessels:()=>tl,ct_w_contrast:()=>to,cubehelix:()=>tn,electric_blue:()=>th,freesurfer:()=>td,ge_color:()=>tc,gold:()=>tm,gray:()=>tA,green:()=>tg,green2cyan:()=>tu,green2orange:()=>tf,hot:()=>tv,hotiron:()=>tp,hsv:()=>tx,inferno:()=>tw,jet:()=>tC,linspecer:()=>tb,magma:()=>ty,mako:()=>tI,nih:()=>tM,plasma:()=>tD,random:()=>tF,red:()=>tT,redyell:()=>tE,rocket:()=>tS,roi_i256:()=>tO,surface:()=>tV,turbo:()=>tB,violet:()=>tU,viridis:()=>tR,warm:()=>tN,winter:()=>tP,x_rain:()=>tk});var eL={R:[0,255,0,0,255,0,255,255,0,205,210,102,0,0,46,255,106,221,233,165,255,147,218,75,255,60,255,255,218,0,188,255,255,222,127,139,124,255,70,0,238,238,240,245,184,32,255,25,112,34,248,245,255,144,173,65,255,250,128,50,244,255,123,255,173,255,127,255,143,220,253,255,0,0,128,255,250,148,178,255,135,100,240,250,255,107,135,0,139,245,186,255,255,0,210,255,47,72,175,128,176,255,139,240,255,216,119,219,72,255,199,154,189,240,230,0,85,64,153,205,250,95,0,255,224,176,138,30,240,152,160],G:[0,0,255,0,255,255,0,239,0,133,180,205,0,139,139,228,90,160,150,42,250,112,112,0,182,179,235,228,165,128,143,105,218,184,255,69,252,255,130,100,130,232,255,222,134,178,20,25,128,139,248,255,160,238,255,105,99,240,0,205,164,255,104,165,216,192,255,140,188,20,245,250,206,255,0,250,128,0,34,127,206,149,230,235,245,142,206,0,0,245,85,228,222,191,105,248,79,61,238,128,224,240,0,255,215,191,136,112,209,0,21,205,183,248,230,250,107,224,50,92,250,158,128,69,255,196,43,144,128,251,82],B:[0,0,0,255,0,255,255,213,205,63,140,170,128,139,87,225,205,221,122,42,250,219,214,130,193,113,205,196,32,128,143,180,185,135,0,19,0,224,180,0,238,170,240,179,11,170,147,112,144,34,255,250,122,144,47,225,71,230,0,50,96,240,238,0,230,203,212,0,143,60,230,240,209,127,128,205,114,211,34,80,235,237,140,215,238,35,250,139,139,220,211,181,173,255,30,220,79,139,238,0,230,245,0,255,0,216,153,147,204,255,133,50,107,255,250,154,47,208,204,92,210,160,0,0,255,222,226,255,128,152,45],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130]},eY={labels:["background","tissue","bone","skin","connective tissue","blood","organ","mass","muscle","foreign object","waste","teeth","fat","gray matter","white matter","nerve","vein","artery","capillary","ligament","tendon","cartilage","meniscus","lymph node","lymphatic vessel","cerebro-spinal fluid","bile","urine","feces","gas","fluid","edema","bleeding","necrosis","clot","embolism","head","central nervous system","brain","gray matter of brain","telencephalon","cerebral cortex","right frontal lobe","left frontal lobe","right temporal lobe","left temporal lobe","right parietal lobe","left parietal lobe","right occipital lobe","left occipital lobe","right insular lobe","left insular lobe","right limbic lobe","left limbic lobe","right striatum","left striatum","right caudate nucleus","left caudate nucleus","right putamen","left putamen","right pallidum","left pallidum","right amygdaloid complex","left amygdaloid complex","diencephalon","thalamus","right thalamus","left thalamus","pineal gland","midbrain","substantia nigra","right substantia nigra","left substantia nigra","cerebral white matter","right superior longitudinal fasciculus","left superior longitudinal fasciculus","right inferior longitudinal fasciculus","left inferior longitudinal fasciculus","right arcuate fasciculus","left arcuate fasciculus","right uncinate fasciculus","left uncinate fasciculus","right cingulum bundle","left cingulum bundle","projection fibers","right corticospinal tract","left corticospinal tract","right optic radiation","left optic radiation","right medial lemniscus","left medial lemniscus","right superior cerebellar peduncle","left superior cerebellar peduncle","right middle cerebellar peduncle","left middle cerebellar peduncle","right inferior cerebellar peduncle","left inferior cerebellar peduncle","optic chiasm","right optic tract","left optic tract","right fornix","left fornix","commissural fibers","corpus callosum","posterior commissure","cerebellar white matter","CSF space","ventricles of brain","right lateral ventricle","left lateral ventricle","right third ventricle","left third ventricle","cerebral aqueduct","fourth ventricle","subarachnoid space","spinal cord","gray matter of spinal cord","white matter of spinal cord","endocrine system of brain","pituitary gland","adenohypophysis","neurohypophysis","meninges","dura mater","arachnoid","pia mater","muscles of head","salivary glands","lips","nose","tongue","soft palate","right inner ear","left inner ear","right external ear","left external ear","right middle ear","left middle ear","right eyeball","left eyeball","skull","right frontal bone","left frontal bone","right parietal bone","left parietal bone","right temporal bone","left temporal bone","right sphenoid bone","left sphenoid bone","right ethmoid bone","left ethmoid bone","occipital bone","maxilla","right zygomatic bone","right lacrimal bone","vomer bone","right palatine bone","left palatine bone","mandible","neck","muscles of neck","pharynx","larynx","thyroid gland","right parathyroid glands","left parathyroid glands","skeleton of neck","hyoid bone","cervical vertebral column","thorax","trachea","bronchi","right lung","left lung","superior lobe of right lung","superior lobe of left lung","middle lobe of right lung","inferior lobe of right lung","inferior lobe of left lung","pleura","heart","right atrium","left atrium","atrial septum","ventricular septum","right ventricle of heart","left ventricle of heart","mitral valve","tricuspid valve","aortic valve","pulmonary valve","aorta","pericardium","pericardial cavity","esophagus","thymus","mediastinum","skin of thoracic wall","muscles of thoracic wall","skeleton of thorax","thoracic vertebral column","ribs","sternum","right clavicle","left clavicle","abdominal cavity","abdomen","peritoneum","omentum","peritoneal cavity","retroperitoneal space","stomach","duodenum","small bowel","colon","anus","liver","biliary tree","gallbladder","pancreas","spleen","urinary system","right kidney","left kidney","right ureter","left ureter","urinary bladder","urethra","right adrenal gland","left adrenal gland","female internal genitalia","uterus","right fallopian tube","left fallopian tube","right ovary","left ovary","vagina","male internal genitalia","prostate","right seminal vesicle","left seminal vesicle","right deferent duct","left deferent duct","skin of abdominal wall","muscles of abdominal wall","skeleton of abdomen","lumbar vertebral column","female external genitalia","male external genitalia","skeleton of upper limb","muscles of upper limb","right upper limb","left upper limb","right shoulder","left shoulder","right arm"],R:[0,128,241,177,111,216,221,144,192,220,78,255,230,200,250,244,0,216,183,183,152,111,178,68,111,85,0,214,78,218,170,140,188,216,145,150,177,244,250,200,68,128,83,83,162,162,141,141,182,182,188,188,154,154,177,177,30,30,210,210,48,48,98,98,69,166,122,122,253,145,46,0,0,250,127,127,159,159,125,125,106,106,154,154,126,201,201,78,78,174,174,139,139,148,148,186,186,99,156,156,64,64,138,97,126,194,85,88,88,88,88,88,88,88,88,244,200,250,82,57,60,92,255,255,255,255,201,70,188,177,166,182,229,229,174,174,201,201,194,194,241,203,203,229,229,255,255,209,209,248,248,255,196,255,255,255,242,242,222,177,213,184,150,62,62,62,242,250,255,177,182,175,197,197,172,172,202,224,224,255,206,210,203,233,195,181,152,159,166,218,225,224,255,184,211,47,255,173,188,255,226,253,244,205,205,186,177,255,234,204,180,216,255,205,204,255,221,0,139,249,157,203,185,185,247,247,222,124,249,249,244,255,255,227,213,213,193,216,230,245,245,241,241,177,171,217,212,185,185,198,194,177,177,177,177,177],G:[0,174,214,122,184,101,130,238,104,245,63,250,220,200,250,214,151,101,156,214,189,184,212,172,197,188,145,230,63,255,250,224,65,191,60,98,122,214,250,200,131,174,146,146,115,115,93,93,166,166,135,135,150,150,140,140,111,111,157,157,129,129,153,153,110,113,101,101,135,92,101,108,108,250,150,150,116,116,102,102,174,174,146,146,126,160,160,152,152,140,140,126,126,120,120,135,135,106,171,171,123,123,95,113,161,195,188,106,106,106,106,106,106,106,106,214,200,250,174,157,143,162,244,244,244,244,121,163,91,122,84,105,147,147,122,122,112,112,142,142,213,179,179,204,204,243,243,185,185,223,223,230,172,255,250,237,217,217,198,122,124,105,208,162,162,162,206,210,255,122,228,216,165,165,138,138,164,186,186,245,110,115,108,138,100,85,55,63,70,123,130,97,244,122,171,150,244,121,95,239,202,232,217,179,179,124,122,255,234,142,119,132,253,167,168,224,130,145,150,180,108,136,102,102,182,182,154,186,186,186,170,181,190,153,141,141,123,146,158,172,172,172,172,124,85,198,188,135,135,175,98,122,122,122,122,122],B:[0,128,145,101,210,79,101,144,88,20,0,220,70,235,210,49,206,79,220,211,207,210,242,100,131,255,30,130,0,255,250,228,28,216,66,83,101,49,225,215,98,128,164,164,105,105,137,137,110,110,166,166,201,201,190,190,85,85,166,166,126,126,112,112,53,137,38,38,192,109,131,112,112,225,88,88,163,163,154,154,155,155,83,83,55,133,133,141,141,103,103,177,177,72,72,135,135,24,108,108,147,147,74,158,197,164,255,215,215,215,215,215,215,215,215,49,215,225,128,110,83,109,209,209,209,209,77,117,95,101,94,107,118,118,90,90,73,73,0,0,144,77,77,109,109,152,152,85,85,131,131,138,68,167,160,145,123,123,101,101,109,108,243,114,114,114,142,139,207,101,255,244,145,145,115,115,140,162,162,217,84,89,81,112,73,57,13,27,38,97,104,76,209,154,143,103,209,88,76,172,134,158,154,108,108,161,101,220,194,178,153,105,229,142,143,199,101,30,98,111,162,116,83,83,164,164,132,223,150,150,147,158,165,130,113,113,103,127,140,147,147,151,151,92,68,131,102,134,134,125,79,101,101,101,101,101],A:[0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},eO={R:[0,0,24,248,255],G:[0,0,177,254,0],B:[0,136,0,0,0],A:[0,32,64,78,128],I:[0,64,128,156,255]},eG={R:[0,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[0,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[0,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},eK={R:[255,248,242,235,229,222,212,202,193,183,173,145,117,78,39,0,0,0,0,0,0,64,128,191,255,255,255,255,255,238,221,204,214,224,235,245,255,249,242,236,229,223,217,210,204,197,191,184,176,169,161,154,146,139,132,124,117,109,102,0],G:[255,251,247,243,239,235,235,235,235,235,235,216,197,174,150,127,153,178,204,229,255,255,255,255,255,220,185,150,115,77,38,0,31,61,92,122,153,138,122,107,92,77,61,46,31,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B:[255,254,253,252,251,250,251,252,253,254,255,226,198,132,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,80,120,160,200,199,198,197,196,196,195,194,193,192,191,184,176,169,161,154,146,139,132,124,117,109,102,0],A:[256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256,256],I:[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,172,176,180,184,188,192,196,200,204,208,212,216,220,224,228,232,236,240,244,248,255]},eW={R:[0,0,0,0,196,255],G:[0,32,128,128,128,32],B:[0,255,196,0,0,0],A:[0,128,64,64,64,128],I:[0,1,64,128,192,255]},eH={R:[0,255],G:[0,0],B:[255,255],A:[0,128],I:[0,255]},eQ={R:[0,0],G:[0,255],B:[255,255],A:[0,128],I:[0,255]},ez={R:[0,0,0,0],G:[0,1,128,255],B:[0,222,127,32],A:[0,0,64,128],I:[0,1,128,255]},eX={R:[0,0,0],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},eq={R:[0,103,255],G:[0,126,255],B:[0,165,255],A:[0,76,128],I:[0,153,255]},ej={R:[0,43,103,199,216,255],G:[0,0,37,155,213,255],B:[0,0,20,97,201,255],A:[0,44,48,54,56,56],I:[0,64,128,196,240,255]},eZ={R:[0,9,24,33,40,46,52,57,62,66,70,74,78,81,85,88,91,94,98,101,103,106,109,112,114,117,119,121,124,126,128,130,133,135,137,139,141,143,145,147,149,151,153,155,157,159,161,163,164,166,168,169,171,172,174,175,177,178,180,181,183,184,186,187,189,190,191,193,194,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,222,223,224,224,225,226,226,227,228,228,229,229,230,231,231,232,233,233,234,234,235,235,236,236,236,237,237,237,238,238,238,239,239,239,240,240,240,241,241,241,242,242,242,243,243,243,243,243,243,243,243,244,244,244,244,244,244,244,244,244,244,244,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,245,244,244,244,244,244,244,244,244,244,244,244,244,244,244,244,243,243,243,243,243,243,243,243,243,243,243,243,242,242,242,242,242,242,242,242,241,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,242,243,243,244,244,245,246,246,247,247,248,249,249,250,250,251,251,252,252,253,253,254,254,254],G:[42,41,41,41,40,40,40,39,39,39,38,38,37,37,36,36,35,35,34,34,33,32,32,31,30,30,30,30,29,29,29,29,28,28,28,27,27,27,26,26,26,25,25,25,24,24,24,24,24,25,25,26,27,27,28,28,29,30,30,31,31,32,33,33,34,34,35,36,36,37,38,39,40,42,43,44,45,47,48,49,50,51,53,54,55,56,57,58,59,60,62,63,64,65,66,68,69,71,72,73,75,76,77,79,80,81,83,84,85,87,88,89,90,92,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,113,115,116,117,119,120,121,122,124,125,126,128,129,130,132,133,134,136,137,138,140,141,142,144,145,146,147,149,150,151,153,154,155,156,158,159,160,161,163,164,165,167,168,169,170,172,173,174,175,176,178,179,180,181,183,184,185,186,187,189,190,191,192,193,194,196,197,198,199,200,201,203,204,205,206,207,208,209,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,228,229,230,231,232,233,234,235,236,237,238,238,239,240,241,241,242,243,244,244,245,246,247,248,248,249,250,251,251,252,253,254,255],B:[167,167,166,166,166,165,165,165,164,164,164,163,163,162,162,162,161,161,161,160,160,160,159,159,158,158,157,157,156,155,155,154,154,153,153,152,151,151,150,150,149,149,148,147,147,146,146,145,144,144,143,143,142,141,141,140,139,139,138,137,137,136,135,135,134,133,133,132,131,131,130,130,129,128,128,127,127,126,125,125,124,124,123,123,122,121,121,120,119,119,118,118,117,116,116,116,115,115,114,114,113,113,113,112,112,111,111,110,110,109,109,109,108,108,107,107,106,106,106,106,106,105,105,105,105,105,105,105,104,104,104,104,104,103,103,103,103,103,102,102,102,103,103,103,103,104,104,104,104,104,105,105,105,105,106,106,106,106,106,107,107,107,107,108,108,109,110,111,111,112,113,113,114,115,115,116,117,117,118,119,120,120,121,122,122,123,124,125,126,128,129,130,131,132,134,135,136,137,138,140,141,142,143,144,146,147,148,149,150,152,153,155,157,158,160,162,163,165,167,168,170,172,173,175,177,178,180,182,183,185,187,188,190,193,196,199,201,204,207,210,212,215,218,221,224,226,229,232,235,238,240,243,246,249,252,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},eJ={R:[0,86,166,255],G:[32,92,156,233],B:[76,108,117,69],A:[0,56,80,88],I:[0,64,192,255]},e_={R:[0,0,0],G:[127,196,254],B:[255,255,255],A:[0,64,128],I:[0,128,255]},e$={R:[0,61,122,183,244,255],G:[0,41,81,122,163,255],B:[0,25,51,76,102,255],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},e1={R:[0,61,122,183,244,255],G:[0,41,81,122,163,203],B:[0,25,51,76,102,127],A:[0,25,51,71,102,128],I:[0,51,102,153,204,255]},e0={min:-643,max:-235,R:[0,0,0],G:[154,154,154],B:[179,179,101],A:[0,32,0],I:[0,163,255]},e2={min:114,max:800,R:[0,255,255,255],G:[0,0,129,255],B:[0,0,0,255],A:[0,64,88,228],I:[0,80,160,255]},e5={min:180,max:600,R:[0,0,113,255],G:[0,0,109,250],B:[0,0,101,245],A:[0,0,100,160],I:[0,1,128,255]},e4={min:-10,max:110,R:[0,127,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},e3={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},e6={min:-80,max:1e3,R:[0,189,150,150,150,150,255],G:[0,169,54,54,54,54,240],B:[0,153,52,52,52,52,242],A:[0,32,64,0,0,64,64],I:[0,1,82,92,234,242,255]},e8={min:-590,max:600,R:[0,241,241,248,248,178,178,232,255,255,255],G:[0,156,156,222,222,36,36,51,255,255,255],B:[0,130,130,169,169,24,24,37,255,255,255],A:[0,8,0,0,0,64,64,0,0,222,222],I:[0,2,3,64,122,142,172,182,252,253,255]},e7={min:114,max:302,R:[0,255,255],G:[0,129,255],B:[0,0,255],A:[0,88,228],I:[0,103,255]},e9={min:-23,max:246,R:[0,44,255,255,255],G:[0,128,90,255,255],B:[0,0,70,0,255],A:[0,0,82,184,228],I:[0,64,131,196,255]},te={min:-100,max:246,R:[0,128,159,255,255,255,255],G:[0,0,56,90,0,255,255],B:[0,0,41,70,0,0,255],A:[0,63,105,135,167,184,228],I:[0,100,128,155,180,209,255]},tt={min:-590,max:600,R:[0,241,241,248,248,178,232,255,255],G:[0,156,156,222,222,36,51,255,255],B:[0,130,130,169,169,24,37,255,255],A:[0,63,105,135,167,184,228,228,228],I:[0,1,52,127,137,162,172,252,255]},ti={min:140,max:1024,R:[0,2,113,255],G:[0,1,109,250],B:[0,1,101,245],A:[0,1,96,168],I:[0,1,128,255]},tr={min:-923,max:679,R:[0,0,0,0,0,255,255,255],G:[154,154,154,154,0,0,254,255],B:[179,179,179,179,0,0,0,255],A:[0,3,8,0,0,10,15,20],I:[0,30,62,88,170,200,232,255]},ts={min:-10,max:110,R:[0,199,255],G:[0,127,255],B:[0,127,255],A:[0,48,128],I:[0,124,255]},ta={min:-600,max:100,R:[0,134,255],G:[0,109,250],B:[0,101,245],A:[0,60,148],I:[0,128,255]},tl={min:114,max:246,R:[0,255,255],G:[0,128,255],B:[0,128,255],A:[0,64,96],I:[0,87,255]},to={min:50,max:1e3,R:[98,210,169,128,255],G:[94,26,77,128,255],B:[45,21,74,128,255],A:[0,25,0,4,168],I:[0,41,87,154,255]},tn={R:[0,13,21,26,27,25,22,21,22,28,39,54,75,98,124,148,171,189,202,210,213,211,206,200,195,193,195,201,211,225,240,255],G:[0,5,11,20,31,44,58,72,86,99,109,116,120,122,122,122,121,121,124,129,137,147,161,175,190,205,218,229,238,245,251,255],B:[0,14,30,46,61,71,77,78,75,68,60,52,48,47,53,65,83,105,131,157,183,205,222,235,241,243,242,240,239,240,245,255],A:[0,4,8,12,17,21,25,29,33,37,41,45,50,54,58,62,66,70,74,78,83,87,91,95,99,103,107,111,116,120,124,128],I:[0,8,16,25,33,41,49,58,66,74,82,90,99,107,115,123,132,140,148,156,165,173,181,189,197,206,214,222,230,239,247,255]},th={R:[0,10,136,255],G:[0,39,220,255],B:[0,223,253,255],A:[0,48,64,70],I:[0,92,192,255]},td={R:[0,245,205,120,196,220,230,0,122,236,12,204,42,119,220,103,60,255,165,160,0,245,205,120,196,220,230,0,122,236,13,220,103,255,165,160,0,120,200,255,255,164,164,164,234,0,0,0,0,0],G:[0,245,62,18,58,248,148,118,186,13,48,182,204,159,216,255,60,165,42,32,200,245,62,18,58,248,148,118,186,13,48,216,255,165,42,32,200,190,70,148,148,108,108,108,169,0,0,0,0,0],B:[0,245,78,134,250,164,34,14,220,176,255,142,164,176,20,255,60,0,42,240,200,245,78,134,250,164,34,14,220,176,255,20,255,0,42,240,221,150,255,10,10,226,226,226,30,64,112,160,208,255],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,2,3,4,5,7,8,10,11,12,13,14,15,16,17,18,24,26,28,30,31,41,42,43,44,46,47,49,50,51,52,53,54,58,60,62,63,72,77,78,79,80,81,82,85,251,252,253,254,255]},tc={R:[0,0,128,255,255],G:[0,128,0,128,255],B:[0,125,255,0,255],A:[0,32,64,96,128],I:[0,63,128,192,255]},tm={R:[0,142,227,255],G:[0,85,170,255],B:[0,14,76,255],A:[0,42,84,128],I:[0,85,170,255]},tA={R:[0,255],G:[0,255],B:[0,255],A:[0,128],I:[0,255]},tg={R:[0,0,0],G:[0,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},tu={R:[0,0,0],G:[72,72,255],B:[0,255,255],A:[0,64,128],I:[0,88,255]},tf={R:[0,255,255],G:[72,88,255],B:[0,0,0],A:[0,64,128],I:[0,88,255]},tp={R:[0,255,255,255],G:[0,0,126,255],B:[0,0,0,255],A:[0,64,96,128],I:[0,128,191,255]},tv={R:[3,255,255,255],G:[0,0,255,255],B:[0,0,0,255],A:[0,48,96,128],I:[0,95,191,255]},tx={R:[255,255,0,0,0,255,255],G:[0,255,255,255,0,0,0],B:[0,0,0,255,255,255,0],A:[0,14,28,43,57,71,85],I:[0,43,85,128,170,213,255]},tw={R:[0,120,237,240],G:[0,28,105,249],B:[4,109,37,33],A:[0,56,80,88],I:[0,64,192,255]},tC={R:[0,0,127,255,127],G:[0,127,255,127,0],B:[127,255,127,0,0],A:[0,32,64,96,128],I:[0,63,128,192,255]},tb={R:[94,50,90,152,215,238,249,254,252,241,209,158],G:[79,131,186,214,240,244,237,210,157,100,57,1],B:[162,189,167,164,155,169,168,123,86,68,79,66],A:[0,12,23,35,47,58,70,81,93,105,116,128],I:[0,23,46,70,93,116,139,162,185,209,232,255]},ty={R:[0,148,183,223,247,252],G:[0,44,55,74,112,253],B:[4,128,121,104,92,191],A:[0,44,53,64,75,107],I:[0,107,128,154,179,255]},tI={R:[11,59,55,222],G:[4,45,165,245],B:[5,91,172,229],A:[0,23,70,107],I:[0,56,167,255]},tM={R:[0,85,0,0,0,0,0,0,85,255,255,255,172],G:[0,0,0,0,85,170,255,255,255,255,85,0,0],B:[0,170,85,255,255,170,170,0,85,0,0,0,0],A:[0,5,10,21,26,32,37,42,48,53,64,72,85],I:[0,15,31,63,79,95,111,127,143,159,191,217,255]},tD={R:[13,156,237,240],G:[8,23,121,249],B:[135,158,83,33],A:[0,56,80,88],I:[0,64,192,255]},tF={R:[208,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248,161,189,41,114,65,121,97,50,238,149,44,214,124,167,40,167,127,178,231,30,173,244,193,203,204,238,139,135,71,234,234,217,66,14,129,19,97,165,112,244,35,73,192,12,149,71,33,192,32,195,208,173,233,202,25,210,145,89,87,245,246,38,3,25,57,167,245,86,227,208,81,64,90,199,140,48,212,180,70,120,9,192,245,177,65,157,9,193,100,181,125,145,62,8,108,36,140,237,242,248],G:[182,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21,42,22,241,61,99,115,199,166,114,190,204,60,233,66,115,230,125,103,203,125,13,176,94,131,39,198,167,124,67,175,254,1,15,198,62,237,159,31,218,58,244,47,61,67,94,46,78,199,79,89,41,208,135,20,154,35,21,43,230,113,191,147,208,37,28,27,86,203,25,209,148,187,139,111,48,102,76,110,106,130,37,160,34,222,90,165,245,222,102,47,19,130,4,232,137,211,240,11,140,21],B:[191,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77,89,112,59,125,226,50,205,227,125,128,104,27,59,66,53,133,159,203,97,125,139,159,158,7,215,47,140,226,223,231,44,110,184,61,233,47,67,148,22,120,173,156,117,181,94,154,43,10,207,204,164,231,136,58,239,30,147,230,101,111,150,35,128,57,252,79,173,120,25,126,81,85,8,7,122,237,190,152,246,182,130,219,67,76,167,178,235,250,28,61,186,250,199,67,58,50,86,182,108,77],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},tT={R:[0,128,255],G:[0,0,0],B:[0,0,0],A:[0,64,128],I:[0,128,255]},tE={R:[192,224,255],G:[1,128,255],B:[0,0,0],A:[0,64,128],I:[0,128,255]},tS={R:[3,112,144,188,236,246,255],G:[5,31,29,22,76,158,250],B:[26,87,91,86,62,117,235],A:[0,30,38,49,67,85,107],I:[0,73,92,118,160,205,255]},tV={R:[1,240,255],G:[1,128,255],B:[1,128,255],A:[0,76,128],I:[0,153,255]},tB={R:[48,48,64,70,65,25,132,195,244,254,218,122],G:[18,18,64,107,150,226,255,241,199,158,57,4],B:[59,59,162,227,255,187,81,52,58,47,7,3],A:[0,22,26,30,34,43,52,57,63,67,77,86],I:[0,1,16,32,49,83,118,140,164,181,219,255]},tU={R:[0,128,255],G:[0,0,0],B:[0,128,255],A:[0,64,128],I:[0,128,255]},tR={R:[68,49,53,253],G:[1,104,183,231],B:[84,142,121,37],A:[0,56,80,88],I:[0,64,192,255]},tN={R:[255,255,255],G:[127,196,254],B:[0,0,0],A:[0,64,128],I:[0,128,255]},tP={R:[0,0,0],G:[0,128,255],B:[255,196,128],A:[0,64,128],I:[0,128,255]},tk={R:[3,64,0,0,255,255,255],G:[0,0,0,255,255,192,3],B:[0,32,48,56,64,96,128],A:[0,8,16,24,32,52,80],I:[0,32,64,96,160,192,255]},tL={min:0,max:0,R:[0,37],G:[242,0],B:[255,255],A:[0,64],I:[0,255]},tY={R:[255,255],G:[255,11],B:[0,0],A:[0,64],I:[0,255]},tO={min:0,max:0,R:[65,10,223,120,216,207,251,93,252,217,21,253,131,165,173,143,144,217,86,89,63,254,172,1,142,107,42,78,221,8,222,71,127,126,167,33,104,2,208,216,0,251,7,105,2,101,248,190,253,62,255,224,166,37,110,138,45,34,6,37,69,201,43,122,199,37,173,194,103,211,75,159,96,4,239,98,110,193,253,166,40,255,48,130,140,243,101,9,177,220,133,32,4,81,48,48,210,109,60,132,1,119,1,159,247,33,212,187,253,144,196,254,168,79,64,196,39,97,73,173,104,216,217,43,101,119,254,5,237,103,203,122,57,87,251,164,19,75,200,2,252,150,66,0,255,157,23,254,55,16,240,161,69,253,207,195,5,60,255,251,200,217,134,123,253,180,27,246,130,136,250,232,4,125,140,22,253,255,13,180,123,61,254,111,10,185,76,192,255,223,186,61,198,5,172,13,83,172,171,6,23,73,134,133,109,61,213,55,57,132,36,209,2,144,1,253,68,155,3,160,2,77,121,70,67,176,223,131,4,162,232,255,150,94,235,191,207,10,246,0,225,4,209,116,57,112,172,253,1,6,92,227,73,62,135,223],G:[162,50,112,245,4,124,176,243,56,125,183,139,182,68,189,4,225,10,20,223,7,46,31,193,225,250,219,41,2,100,83,181,34,150,72,223,168,248,80,253,7,117,214,2,248,10,3,59,179,160,90,244,146,4,207,4,125,255,96,100,1,208,130,51,116,181,236,53,244,5,165,28,181,86,96,42,254,1,134,194,214,92,41,204,137,86,207,3,143,3,100,239,164,94,65,251,131,244,173,57,143,107,217,53,210,0,148,250,45,198,81,40,61,218,252,88,171,0,248,24,248,4,41,100,187,46,208,145,43,168,121,46,175,250,125,107,233,112,207,231,174,215,53,9,43,153,52,124,128,65,210,147,255,147,63,200,148,254,0,179,241,42,239,2,230,8,82,135,87,16,3,87,86,151,254,8,255,86,53,19,7,192,171,201,253,247,197,103,251,126,0,149,54,183,61,126,79,113,10,103,184,75,11,195,222,136,149,131,8,99,240,177,252,255,198,16,7,68,178,66,191,150,73,26,211,109,78,209,240,254,1,166,247,131,2,0,167,127,133,10,43,99,235,3,214,142,176,82,132,38,10,249,255,215,44,81],B:[176,182,248,37,117,35,96,69,32,152,108,20,237,250,2,89,141,216,111,251,211,149,10,44,214,103,31,251,3,32,252,246,97,1,219,167,197,4,36,116,206,118,106,43,205,204,114,69,127,205,87,80,41,251,145,204,253,161,247,1,149,9,43,253,97,72,136,161,171,181,26,255,108,80,218,214,231,255,84,31,109,4,218,3,217,36,68,85,241,39,221,2,240,2,173,42,206,5,110,46,103,27,212,184,2,207,246,45,116,72,110,253,38,105,248,159,243,81,192,93,141,145,24,157,234,131,57,178,62,75,65,176,148,40,253,66,76,240,51,154,17,251,139,253,207,9,114,49,200,254,96,73,138,118,204,102,137,89,145,161,4,112,66,234,147,178,212,205,185,11,203,131,2,250,118,169,1,185,154,53,171,197,61,175,249,96,15,254,95,5,222,75,246,194,2,61,180,25,133,165,15,233,59,35,221,140,109,7,114,255,198,0,115,168,252,23,242,80,75,142,137,255,12,182,68,201,4,111,37,228,83,248,24,192,249,5,54,223,160,122,160,114,145,119,252,31,253,250,10,214,8,47,0,142,222,70],A:[0,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64],I:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},tG=new class{constructor(){for(let e of(C(this,"gamma",1),C(this,"version",.1),C(this,"cluts",{}),Object.keys(ek).filter(e=>!e.startsWith("$")).sort(new Intl.Collator("en").compare)))this.cluts[e]=ek[e]}addColormap(e,t){this.cluts[e]=t}colormaps(){return Object.keys(this.cluts)}colorMaps(){return this.colormaps()}colormapFromKey(e){let t=this.cluts[e];return void 0!==t||void 0!==(t=this.cluts[e.toLowerCase()])?t:(e.length>0&&I.warn("No color map named "+e),{min:0,max:0,R:[0,255],G:[0,255],B:[0,255],A:[0,255],I:[0,255]})}colormap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.colormapFromKey(e);return this.makeLut(i.R,i.G,i.B,i.A,i.I,t)}makeLabelLut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;if(void 0===e.R||void 0===e.G||void 0===e.B)throw Error(`Invalid colormap table: ${e}`);let i=e.R.length,r=e.I??[...Array(i).keys()];if(i!==e.G.length||i!==e.B.length||i!==r.length)throw Error(`colormap does not make sense: ${e} Rs ${e.R.length} Gs ${e.G.length} Bs ${e.B.length} Is ${r.length}`);let s=new Uint8ClampedArray(i).fill(t);s[0]=0,void 0!==e.A&&(s=Uint8ClampedArray.from(e.A));let a=Math.min(...r),l=Math.max(...r),o=l-a+1,n=new Uint8ClampedArray(4*o).fill(0);for(let t=0;t<i;t++){let i=(r[t]-a)*4;n[i++]=e.R[t],n[i++]=e.G[t],n[i++]=e.B[t],n[i++]=s[t]}let h={lut:n,min:a,max:l};if(e.labels){let t=e.labels.length;if(t===o)h.labels=e.labels;else if(t===i){h.labels=Array(o).fill("?");for(let t=0;t<i;t++){let i=r[t];h.labels[i]=e.labels[t]}}}return h}async makeLabelLutFromUrl(e){let t=await fetch(e),i=await t.json();return this.makeLabelLut(i)}makeDrawLut(e){let t="object"==typeof e?e:ek[e];void 0===t&&(t={min:0,max:0,R:[0,255,0,0,255,0,255],G:[0,0,255,0,255,255,0],B:[0,0,0,255,0,255,255],A:[0,255,255,255,255,255,255],I:[0,255]});let i=this.makeLabelLut(t,255);if(void 0===i.labels&&(i.labels=[]),i.labels.length<256){let e=i.labels.length;for(let t=e;t<256;t++)i.labels.push(t.toString())}let r=new Uint8ClampedArray(1024),s=0;for(let e=0;e<256;e++)r[s++]=255,r[s++]=0,r[s++]=0,r[s++]=255;r[3]=0;let a=Math.min(i.lut.length,1024);if(a>0)for(let e=0;e<a;e++)r[e]=i.lut[e];return{lut:r,labels:i.labels}}makeLut(e,t,i,r,s,a){let l=e.length,o=[...e],n=[...t],h=[...i];if(!s){s=Array(l);for(let e=0;e<l;e++)s[e]=e/(l-1)*255}!r&&((r=Array(l).fill(64))[0]=0);let d=Uint8ClampedArray.from(r),c=Uint8ClampedArray.from(s);if(a)for(let a=0;a<l;a++)o[a]=e[l-1-a],n[a]=t[l-1-a],h[a]=i[l-1-a],d[a]=255-r[l-1-a],c[a]=255-s[l-1-a];let m=new Uint8ClampedArray(1024);if(void 0===c){c=new Uint8ClampedArray(l).fill(0);for(let e=0;e<l;e++)c[e]=Math.round(255*e/(l-1))}void 0===d&&((d=new Uint8ClampedArray(l).fill(64))[0]=0);for(let e=0;e<l-1;e++){let t=c[e],i=c[e+1];0===e&&0!==t&&I.warn("colormap issue: indices expected to start with 0 not ",t),e===c.length-2&&255!==i&&(I.warn("padding colormap: indices expected end with 255 not ",i),i=255);let r=i-t,s=4*t;for(let a=t;a<=i;a++){let i=(a-t)/r;m[s++]=o[e]+i*(o[e+1]-o[e]),m[s++]=n[e]+i*(n[e+1]-n[e]),m[s++]=h[e]+i*(h[e+1]-h[e]),m[s++]=d[e]+i*(d[e+1]-d[e])}}if(1===this.gamma)return m;for(let e=0;e<1020;e++){if(e%4!=3)m[e]=255*Math.pow(m[e]/255,1/this.gamma)}return m}},tK=class{static getClusterBoundaryU8(e,t){let i=Array(e.length).fill(!1),r=Array(e.length).fill(!1);for(let t=0;t<e.length;t++)e[t]>0&&(r[t]=!0);let s=t.length/3,a=0;for(let e=0;e<s;e++){let e=t[a],s=t[a+1],l=t[a+2];if(a+=3,r[e]!==r[s]||r[e]!==r[l]||r[s]!==r[l])i[e]=!0,i[s]=!0,i[l]=!0}return i}static createMZ3(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.length/3,s=e.length/3,a=12*r,l=12*s,o=new ArrayBuffer(16+a+l),n=new DataView(o);n.setUint16(0,23117,!0),n.setUint16(2,3,!0),n.setUint32(4,r,!0),n.setUint32(8,s,!0),n.setUint32(12,0,!0);let h=16;return(new Uint32Array(o,16,t.length).set(t),new Float32Array(o,h+=a,e.length).set(e),i)?(0,m.rZ)(new Uint8Array(o)):o}static createOBJ(e,t){let i="";for(let t=0;t<e.length;t+=3)i+=`v ${e[t]} ${e[t+1]} ${e[t+2]}
`;for(let e=0;e<t.length;e+=3)i+=`f ${t[e]+1} ${t[e+1]+1} ${t[e+2]+1}
`;return new TextEncoder().encode(i).buffer}static createSTL(e,t){let i=t.length/3,r=new ArrayBuffer(84+50*i),s=new DataView(r);for(let e=0;e<80;e++)s.setUint8(e,0);s.setUint32(80,i,!0);let a=84;for(let i=0;i<t.length;i+=3){let r=3*t[i],l=3*t[i+1],o=3*t[i+2];s.setFloat32(a,0,!0),s.setFloat32(a+4,0,!0),s.setFloat32(a+8,0,!0),a+=12,s.setFloat32(a,e[r],!0),s.setFloat32(a+4,e[r+1],!0),s.setFloat32(a+8,e[r+2],!0),a+=12,s.setFloat32(a,e[l],!0),s.setFloat32(a+4,e[l+1],!0),s.setFloat32(a+8,e[l+2],!0),a+=12,s.setFloat32(a,e[o],!0),s.setFloat32(a+4,e[o+1],!0),s.setFloat32(a+8,e[o+2],!0),a+=12,s.setUint16(a,0,!0),a+=2}return r}static downloadArrayBuffer(e,t){let i=new Blob([e],{type:"application/octet-stream"}),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.style.display="none",s.click(),setTimeout(()=>{document.body.removeChild(s),URL.revokeObjectURL(r)},0)}static saveMesh(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".mz3",r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=new ArrayBuffer(0);return/\.obj$/i.test(i)?s=this.createOBJ(e,t):/\.stl$/i.test(i)?s=this.createSTL(e,t):(!/\.mz3$/i.test(i)&&(i+=".mz3"),s=this.createMZ3(e,t,r)),i.length>4&&this.downloadArrayBuffer(s,i),s}static getClusterBoundary(e,t){let i=new Uint32Array(e.buffer),r=Array(i.length).fill(!1),s=t.length/3,a=0;for(let e=0;e<s;e++){let e=t[a],s=t[a+1],l=t[a+2];if(a+=3,i[e]!==i[s]||i[e]!==i[l]||i[s]!==i[l])r[e]=!0,r[s]=!0,r[l]=!0}return r}static getExtents(e){if(!ArrayBuffer.isView(e)&&!Array.isArray(e)||e.length<3)return{mxDx:0,extentsMin:0,extentsMax:0};let t=0,i=n.al(e[0],e[1],e[2]),r=n.al(e[0],e[1],e[2]);for(let s=0;s<e.length;s+=3){let a=n.al(e[s],e[s+1],e[s+2]);t=Math.max(t,n.Zh(a)),n.VV(i,i,a),n.Fp(r,r,a)}let s=[i[0],i[1],i[2]];return{mxDx:t,extentsMin:s,extentsMax:[r[0],r[1],r[2]]}}static generateNormals(e,t){let i,r,s,a,l,o,n,h,d,c;let m=[],A=e.length,g=new Float32Array(A),u=t.length;for(i=0;i<u;i+=3){h=3*t[i],d=3*t[i+1],c=3*t[i+2];let A=[e[h],e[h+1],e[h+2]],u=[e[d],e[d+1],e[d+2]],f=[e[c],e[c+1],e[c+2]];r=u[0]-A[0],s=u[1]-A[1],a=u[2]-A[2],l=f[0]-A[0],o=f[1]-A[1],n=f[2]-A[2],m[0]=o*a-n*s,m[1]=n*r-l*a,m[2]=l*s-o*r,g[h]+=m[0],g[h+1]+=m[1],g[h+2]+=m[2],g[d]+=m[0],g[d+1]+=m[1],g[d+2]+=m[2],g[c]+=m[0],g[c+1]+=m[1],g[c+2]+=m[2]}for(i=0;i<A;i+=3){m[0]=-1*g[i],m[1]=-1*g[i+1],m[2]=-1*g[i+2];let e=m[0]*m[0]+m[1]*m[1]+m[2]*m[2];e>0&&(e=1/Math.sqrt(e),m[0]*=e,m[1]*=e,m[2]*=e),g[i]=m[0],g[i+1]=m[1],g[i+2]=m[2]}return g}},tW=class e{static arrayBufferToBase64(t){let i=new Uint8Array(t);return e.uint8tob64(i)}static readMatV4(e){let t=e.byteLength;if(t<40)throw Error("File too small to be MAT v4: bytes = "+e.byteLength);let i=new DataView(e),r=i.getUint16(0,!0),s=e;if(35615===r||8075===r){let a=(0,m.iF)(new Uint8Array(e));r=(i=new DataView(a.buffer)).getUint16(0,!0),t=(s=a.buffer).byteLength}let a=new TextDecoder("utf-8"),l=new Uint8Array(s),o=0,n={};for(;o+20<t;)!function(){let e=i.getUint32(o,!0),t=i.getUint32(o+4,!0),r=i.getUint32(o+8,!0),s=i.getUint32(o+12,!0),h=i.getUint32(o+16,!0);if(o+=20,0!==s)throw Error("Matlab V4 reader does not support imaginary numbers");let d=t*r;if(d<1)throw Error("mrows * ncols must be greater than one");let c=new Uint8Array(l.subarray(o,o+h)),m=a.decode(c).trim().replaceAll("\0",""),A=Math.floor(e/10)%10,g=8;if(A>=1&&A<=2)g=4;else if(A>=3&&A<=4)g=2;else if(5===A)g=1;else if(0!==A)throw Error("impossible Matlab v4 datatype");if(o+=h,e>50)throw Error("Does not appear to be little-endian V4 Matlab file");let u=o+d*g;n[m]=function(e,t,i){let r=new Uint8Array(l.subarray(t,i));return 1===e?new Float32Array(r.buffer):2===e?new Int32Array(r.buffer):3===e?new Int16Array(r.buffer):4===e?new Uint16Array(r.buffer):5===e?new Uint8Array(r.buffer):new Float64Array(r.buffer)}(A,o,u),o=u}();return n}static uint8tob64(e){let t,i,r,s,a,l="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=e.byteLength,h=n%3,d=n-h;for(let n=0;n<d;n+=3)t=(0xfc0000&(a=e[n]<<16|e[n+1]<<8|e[n+2]))>>18,i=(258048&a)>>12,r=(4032&a)>>6,s=63&a,l+=o[t]+o[i]+o[r]+o[s];return 1===h?(t=(252&(a=e[d]))>>2,i=(3&a)<<4,l+=o[t]+o[i]+"=="):2===h&&(t=(64512&(a=e[d]<<8|e[d+1]))>>10,i=(1008&a)>>4,r=(15&a)<<2,l+=o[t]+o[i]+o[r]+"="),l}static download(e,t,i){let r=document.createElement("a"),s=new Blob(Array.isArray(e)?e:[e],{type:i});r.href=URL.createObjectURL(s),r.download=t,r.click()}static readFileAsync(e){return new Promise((t,i)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=i,r.readAsArrayBuffer(e)})}static blobToBase64(e){return new Promise(t=>{let i=new FileReader;i.onloadend=()=>t(i.result),i.readAsDataURL(e)})}static async decompressBase64String(t){let i=atob(t),r=new Uint8Array(new ArrayBuffer(i.length));for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return e.decompressArrayBuffer(r)}static async compressToBase64String(t){let i=await e.compressStringToArrayBuffer(t);return e.uint8tob64(new Uint8Array(i))}static async compressStringToArrayBuffer(e){return new Promise((t,i)=>{let r=(0,m.TD)(e);(0,m.nN)(r,(e,r)=>{e?i(e):t(r.buffer)})})}static isArrayBufferCompressed(e){if(!e||!e.byteLength)return!1;{let t=new Uint8Array(e);return 8075==(t[0]<<8|t[1])}}static async decompressArrayBuffer(e){return new Promise((t,i)=>{let r=new Uint8Array(e);(0,m.Lj)(r,(e,r)=>{e?i(e):t((0,m.T8)(r))})})}static arraysAreEqual(e,t){return A(e,t)}static range(e,t,i){return Array.from({length:(t-e)/i+1},(t,r)=>e+r*i)}static sph2cartDeg(e,t){let i=-(Math.PI/180*t),r=(e-90)%360*(Math.PI/180),s=[Math.cos(i)*Math.cos(r),Math.cos(i)*Math.sin(r),Math.sin(i)],a=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);return a<=0?s:(s[0]/=a,s[1]/=a,s[2]/=a,s)}static vox2mm(e,t){let i=h.d9(t);h.p4(i,i);let r=o.al(e[0],e[1],e[2],1);return o.fF(r,r,i),n.al(r[0],r[1],r[2])}},tH=class e{static readTRACT(e){let t=e.byteLength;if(t<20)throw Error("File too small to be niml.tract: bytes = "+t);let i=new DataView(e),r=new Uint8Array(e),s=0;function a(){for(;s<t&&60!==r[s];)s++;let i=s;for(;s<t&&62!==r[s];)s++;return++s-i<1?"":new TextDecoder().decode(e.slice(i,s-1)).trim()}let l=a();function o(e){let t=l.indexOf(e);if(t<0)return 0;let i=l.indexOf('"',t)+1,r=l.indexOf('"',i);return parseInt(l.slice(i,r))}let n=o("N_tracts=");(!l.startsWith("<network")||n<1)&&I.warn("This is not a valid niml.tract file "+l);let h=0,d=[];d.push(h);let c=[],m=[];for(let e=0;e<n;e++){l=a();let e=o("ni_dimen="),t=o("Bundle_Tag="),r=l.includes("binary.lsbfirst");for(let a=0;a<e;a++){s+=4;let e=i.getUint32(s,r)/3;s+=4;for(let t=0;t<e;t++)c.push(i.getFloat32(s,r)),s+=4,c.push(-i.getFloat32(s,r)),s+=4,c.push(i.getFloat32(s,r)),s+=4;h+=e,d.push(h),m.push(t)}l=a()}let A=[];return A.push({id:"tract",vals:Float32Array.from(m)}),{pts:new Float32Array(c),offsetPt0:new Uint32Array(d),dps:A}}static readTT(e){let t=new Uint32Array(0),i=new Float32Array(0),r=tW.readMatV4(e);if(!("trans_to_mni"in r))throw Error("TT format file must have 'trans_to_mni'");if(!("voxel_size"in r))throw Error("TT format file must have 'voxel_size'");if(!("track"in r))throw Error("TT format file must have 'track'");let s=h.Ue(),a=r.trans_to_mni;return s=h.al(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]),h.p4(s,s),!function(e){let r=new DataView(e.buffer),a=[],l=0,n=0;for(;n<e.length;){a.push(n);let e=r.getUint32(n,!0);n=n+e+13,l+=e}t=new Uint32Array(a.length+1),i=new Float32Array(l);let h=0;for(let e=0;e<a.length;e++){t[e]=h/3;let s=a[e],l=r.getUint32(s,!0)/3,o=r.getInt32(s+4,!0),n=r.getInt32(s+8,!0),d=r.getInt32(s+12,!0);s+=16,i[h++]=o,i[h++]=n,i[h++]=d;for(let e=2;e<=l;e++)o+=r.getInt8(s++),n+=r.getInt8(s++),d+=r.getInt8(s++),i[h++]=o,i[h++]=n,i[h++]=d}for(let e=0;e<h;e++)i[e]=i[e]/32;let d=0;for(let e=0;e<h/3;e++){let e=o.al(i[d],i[d+1],i[d+2],1);o.fF(e,e,s),i[d++]=e[0],i[d++]=e[1],i[d++]=e[2]}t[a.length]=h/3}(r.track),{pts:i,offsetPt0:t}}static readTRX(e){let t=0,i=0,r=new Float32Array([]),s=[],a=[],l=[],o=[],n=[],h=!1,d=(0,m.GZ)(new Uint8Array(e),{filter:e=>e.originalSize>0}),c=Object.keys(d);for(let e=0,m=c.length;e<m;e++){let m=c[e].split("/"),A=m.slice(-1)[0];if(A.startsWith("."))continue;let g=m.slice(-2)[0],u=A.split(".")[0],f=d[c[e]];if(A.includes("header.json")){n=JSON.parse(new TextDecoder().decode(f));continue}let p=0,v=[];if(A.endsWith(".uint64")||A.endsWith(".int64")){v=new Uint32Array(p=f.length/8);let e=new Uint32Array(f.buffer),t=0;for(let i=0;i<p;i++)v[i]=e[t],0!==e[t+1]&&(h=!0),t+=2}else if(A.endsWith(".uint32"))v=new Uint32Array(f.buffer);else if(A.endsWith(".uint16"))v=new Uint16Array(f.buffer);else if(A.endsWith(".uint8"))v=new Uint8Array(f.buffer);else if(A.endsWith(".int32"))v=new Int32Array(f.buffer);else if(A.endsWith(".int16"))v=new Int16Array(f.buffer);else if(A.endsWith(".int8"))v=new Int8Array(f.buffer);else if(A.endsWith(".float64"))v=new Float64Array(f.buffer);else if(A.endsWith(".float32"))v=new Float32Array(f.buffer);else{if(!A.endsWith(".float16"))continue;v=new Float32Array(p=f.length/2);let e=new Uint16Array(f.buffer),t=new Float32Array(65536);for(let e=0;e<65536;e++)t[e]=function(e){let t=(31744&e)>>10,i=1023&e;return(e>>15?-1:1)*(t?31===t?i?NaN:1/0:Math.pow(2,t-15)*(1+i/1024):i/1024*6103515625e-14)}(e);for(let i=0;i<p;i++)v[i]=t[e[i]]}if(p=v.length,g.includes("groups")){a.push({id:u,vals:Float32Array.from(v.slice())});continue}if(g.includes("dpv")){o.push({id:u,vals:Float32Array.from(v.slice())});continue}if(g.includes("dps")){l.push({id:u,vals:Float32Array.from(v.slice())});continue}if(A.startsWith("offsets.")){t=p;for(let e=0;e<p;e++)s[e]=v[e]}A.startsWith("positions.3.")&&(i=p,r=new Float32Array(v))}if(0===t||0===i)throw Error("Failure reading TRX format (no offsets or points).");if(h)throw Error("Too many vertices: JavaScript does not support 64 bit integers");return s[t]=i/3,{pts:r,offsetPt0:new Uint32Array(s),dpg:a,dps:l,dpv:o,header:n}}static readTSF(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new Float32Array(t),r=e.byteLength;if(r<20)throw Error("File too small to be TSF: bytes = "+r);let s=new Uint8Array(e),a=0;function l(){for(;a<r&&10===s[a];)a++;let t=a;for(;a<r&&10!==s[a];)a++;return++a-t<1?"":new TextDecoder().decode(e.slice(t,a-1))}let o=l();if(!o.includes("mrtrix track scalars"))throw Error("Not a valid TSF file");let n=-1;for(;a<r&&!o.includes("END");)if((o=l()).toLowerCase().startsWith("file:")&&(n=parseInt(o.split(" ").pop())),o.toLowerCase().startsWith("datatype:")&&!o.endsWith("Float32LE"))throw Error("Only supports TSF files with Float32LE");if(n<20)throw Error("Not a valid TSF file (missing file offset)");a=n;let h=new DataView(e),d=0;for(;a+4<=r&&d<t;){let e=h.getFloat32(a,!0);if(a+=4,isFinite(e))i[d++]=e;else if(!isNaN(e))break}return i}static readTCK(e){let t=e.byteLength;if(t<20)throw Error("File too small to be TCK: bytes = "+t);let i=new Uint8Array(e),r=0;function s(){for(;r<t&&10===i[r];)r++;let s=r;for(;r<t&&10!==i[r];)r++;return++r-s<1?"":new TextDecoder().decode(e.slice(s,r-1))}let a=s();if(!a.includes("mrtrix tracks"))throw Error("Not a valid TCK file");let l=-1;for(;r<t&&!a.includes("END");)(a=s()).toLowerCase().startsWith("file:")&&(l=parseInt(a.split(" ").pop()));if(l<20)throw Error("Not a valid TCK file (missing file offset)");r=l;let o=new DataView(e),n=0,h=new Uint32Array(t/16),d=0,c=0,m=new Float32Array(t/4);for(h[0]=0;r+12<t;){let e=o.getFloat32(r,!0);r+=4;let t=o.getFloat32(r,!0);r+=4;let i=o.getFloat32(r,!0);if(r+=4,isFinite(e))m[c++]=e,m[c++]=t,m[c++]=i,n++;else if(h[d++]=n,!isNaN(e))break}return m=m.slice(0,c),{pts:m,offsetPt0:h=h.slice(0,d)}}static readTRK(e){let t=new DataView(e),i=t.getUint32(0,!0);if(0x43415254!==i){let r;if(0xfd2fb528===i)throw Error("zstd TRK decompression is not supported");r=(0,m.iF)(new Uint8Array(e));i=(t=new DataView(e=r.buffer)).getUint32(0,!0)}let r=t.getUint32(992,!0),s=t.getUint32(996,!0);if(r>2||1e3!==s||0x43415254!==i)throw Error("Not a valid TRK file");let a=t.getInt16(36,!0),l=[];for(let t=0;t<a;t++){let i=new Uint8Array(e.slice(38+20*t,58+20*t)),r=new TextDecoder().decode(i).split("\0").shift();l.push({id:r.trim(),vals:[]})}let o=t.getFloat32(12,!0),n=t.getFloat32(16,!0),d=t.getFloat32(20,!0),c=h.al(1/o,0,0,-.5,0,1/n,0,-.5,0,0,1/d,-.5,0,0,0,1),A=t.getInt16(238,!0),g=[];for(let t=0;t<A;t++){let i=new Uint8Array(e.slice(240+20*t,260+20*t)),r=new TextDecoder().decode(i).split("\0").shift();g.push({id:r.trim(),vals:[]})}let u=h.Ue();for(let e=0;e<16;e++)u[e]=t.getFloat32(440+4*e,!0);0===u[15]&&(I.warn("TRK vox_to_ras not set"),h.yR(u));let f=h.Ue();h.dC(f,c,u);let p=null,v=null;v=new Float32Array((p=new Int32Array(e.slice(s))).buffer);let x=p.length;if(x<1)throw Error("Empty TRK file.");let w=0,C=0,b=new Uint32Array(p.length/4),y=0,M=new Float32Array(p.length),D=0;for(;w<x;){let e=p[w];w+=1,b[y++]=C;for(let t=0;t<e;t++){let e=v[w+0],t=v[w+1],i=v[w+2];if(w+=3,M[D++]=e*f[0]+t*f[1]+i*f[2]+f[3],M[D++]=e*f[4]+t*f[5]+i*f[6]+f[7],M[D++]=e*f[8]+t*f[9]+i*f[10]+f[11],a>0)for(let e=0;e<a;e++)l[e].vals.push(v[w]),w++;C++}if(A>0)for(let e=0;e<A;e++)g[e].vals.push(v[w]),w++}let F=[];for(let e=0;e<g.length;e++)F.push({id:g[e].id,vals:Float32Array.from(g[e].vals)});let T=[];for(let e=0;e<l.length;e++)T.push({id:l[e].id,vals:Float32Array.from(l[e].vals)});return b[y++]=C,M=M.slice(0,D),{pts:M,offsetPt0:b=b.slice(0,y),dps:F,dpv:T}}static readTxtVTK(e){let t=new TextDecoder("utf-8").decode(e).split("\n");if(t.length<7||!t[0].startsWith("# vtk DataFile"))throw Error("Invalid VTK image");if(!t[2].startsWith("ASCII"))throw Error("Not ASCII VTK mesh");let i=3;for(;t[i].length<1;)i++;if(!t[i].includes("POLYDATA"))throw Error("Not ASCII VTK polydata");for(i++;t[i].length<1;)i++;if(!t[i].startsWith("POINTS"))throw Error("Not VTK POINTS");let r=t[i].trim().split(/\s+/),s=parseInt(r[1]),a=3*s,l=new Float32Array(3*s),o=0;for(;o<3*s;){let e=t[++i].trim().trim().split(/\s+/);for(let t=0;t<e.length&&!(o>=a);t++){;l[o]=parseFloat(e[t]),o++}}let n=[];for(i++;t[i].length<1;)i++;if(t[i].startsWith("METADATA")){for(;t[i].length>1;)i++;i++}if(r=t[i].trim().split(/\s+/),i++,r[0].includes("LINES")){let e=parseInt(r[1]);if(e<1)throw Error("Corrupted VTK ASCII");let s=t[i].trim(),a=[],o=[];if(s.startsWith("OFFSETS")){i++;let r=0;for(;r<e;){s=t[i].trim(),i++;let l=s.trim().split(/\s+/);for(let t=0;t<l.length&&(a[r]=parseInt(l[t]),!(++r>=e));t++);}o=Array.from(l)}else{let r=function(){let e=(s=t[i].trim()).trim().split(/\s+/);h=[];for(let t=0;t<e.length;t++)h.push(parseInt(e[t]));d=0,i++},n=0;a[0]=0;let h=[],d=0;r();for(let t=0;t<e;t++){d>=h.length&&r();let e=h[d++];n+=e,a[t+1]=n;for(let t=0;t<e;t++){d>=h.length&&r();let e=3*h[d++];o.push(l[e+0]),o.push(l[e+1]),o.push(l[e+2])}}}return{pts:Float32Array.from(o),offsetPt0:Uint32Array.from(a)}}if(r[0].includes("TRIANGLE_STRIPS")){let e=parseInt(r[1]);for(let r=0;r<e;r++){let e=t[i].trim();i++;let r=e.trim().split(/\s+/),s=parseInt(r[0])-2,a=1;for(let e=0;e<s;e++)e%2?(n.push(parseInt(r[a+2])),n.push(parseInt(r[a+1])),n.push(parseInt(r[a]))):(n.push(parseInt(r[a])),n.push(parseInt(r[a+1])),n.push(parseInt(r[a+2]))),a+=1}}else if(r[0].includes("POLYGONS")){let e=parseInt(r[1]);for(let r=0;r<e;r++){let e=t[i].trim();i++;let r=e.trim().split(/\s+/),s=parseInt(r[0])-2,a=parseInt(r[1]),l=parseInt(r[2]);for(let e=0;e<s;e++){let t=parseInt(r[3+e]);n.push(a),n.push(l),n.push(t),l=t}}}else throw Error("Unsupported ASCII VTK datatype "+r[0]);return{positions:l,indices:new Uint32Array(n)}}static readLayer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"warm",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"winter",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,c={...tQ,colormapInvert:!1,alphaThreshold:!1,isTransparentBelowCalMin:!0,isAdditiveBlend:!1,colorbarVisible:!0,colormapLabel:null},m=/(?:\.([^.]+))?$/,A=m.exec(t)[1];"GZ"===(A=A.toUpperCase())&&(A=(A=m.exec(t.slice(0,-3))[1]).toUpperCase());let g=r.vertexCount/3;if(r.offsetPt0){if("TSF"!==A)throw Error("readLayer for streamlines only supports TSF files.");let s=r.pts.length/3,a=t.split("/"),l="Unknown";a.length>1&&a.pop()&&(l=l.split(".").slice(0,-1).join("."));let o=e.readTSF(i,s);!r.dpv&&(r.dpv=[]);let n=o.reduce((e,t)=>Math.min(e,t)),h=o.reduce((e,t)=>Math.max(e,t));return r.dpv.push({id:l,vals:Float32Array.from(o.slice()),global_min:n,global_max:h,cal_min:n,cal_max:h}),c}if(g<3){I.error("n_vert < 3 in layer");return}if("MZ3"===A)c.values=e.readMZ3(i,g);else if("ANNOT"===A){let t=e.readANNOT(i,g,!0);t instanceof Uint32Array?c.values=t:(c.values=t.scalars,c.colormapLabel=t.colormapLabel)}else if("CRV"===A||"CURV"===A||"THICKNESS"===A||"AREA"===A)c.values=e.readCURV(i,g),c.isTransparentBelowCalMin=!1;else if("GII"===A){let t=e.readGII(i,g);c.values=t.scalars,c.colormapLabel=t.colormapLabel}else if("MGH"===A||"MGZ"===A){let t=e.readMGH(i,g,!0);"scalars"in t?(c.values=t.scalars,c.colormapLabel=t.colormapLabel):c.values=t}else if("NII"===A)c.values=e.readNII(i,g,r.anatomicalStructurePrimary);else if("SMP"===A)c.values=e.readSMP(i,g);else if("STC"===A)c.values=e.readSTC(i,g);else{if(!e.isCurv(i))return I.warn("Unknown layer overlay format "+t),c;c.values=e.readCURV(i,g),c.isTransparentBelowCalMin=!1}if(!c.values){I.error("no values in layer");return}c.nFrame4D=c.values.length/g,c.frame4D=0,c.outlineBorder=d;let u=c.values[0],f=c.values[0];for(let e=0;e<c.values.length;e++)u=Math.min(u,c.values[e]),f=Math.max(f,c.values[e]);return c.global_min=u,c.global_max=f,c.cal_min=n||0,!n&&(c.cal_min=u),c.cal_max=h||0,!h&&(c.cal_max=f),c.cal_minNeg=NaN,c.cal_maxNeg=NaN,c.opacity=s,c.colormap=a,c.colormapNegative=l,c.useNegativeCmap=o,c}static readSMP(e,t){let i=e.byteLength,r=new DataView(e),s=r.getUint16(0,!0);if(s>5){let t=(0,m.iF)(new Uint8Array(e));s=(r=new DataView(t.buffer)).getUint16(0,!0),e=t.buffer}s>5&&I.error("Unsupported or invalid BrainVoyager SMP version "+s);let a=r.getUint32(2,!0);a!==t&&I.error("SMP file has "+a+" vertices, background mesh has "+t);let l=r.getUint16(6,!0),o=new Float32Array(a*l),n=[],h=9;function d(){let t=h;for(;h<i&&0!==r.getUint8(h);)h++;return h++,new TextDecoder().decode(e.slice(t,h-1))}d();for(let t=0;t<l;t++){let i={};i.mapType=r.getUint32(h,!0),h+=4,s>=3&&3===i.mapType&&(i.nLags=r.getUint32(h,!0),h+=4,i.mnLag=r.getUint32(h,!0),h+=4,i.mxLag=r.getUint32(h,!0),h+=4,i.ccOverlay=r.getUint32(h,!0),h+=4),i.clusterSize=r.getUint32(h,!0),h+=4,i.clusterCheck=r.getUint8(h),h+=1,i.critThresh=r.getFloat32(h,!0),h+=4,i.maxThresh=r.getFloat32(h,!0),h+=4,s>=4&&(i.includeValuesGreaterThreshMax=r.getUint32(h,!0),h+=4),i.df1=r.getUint32(h,!0),h+=4,i.df2=r.getUint32(h,!0),h+=4,s>=5?(i.posNegFlag=r.getUint32(h,!0),h+=4):i.posNegFlag=3,i.cortexBonferroni=r.getUint32(h,!0),h+=4,i.posMinRGB=[0,0,0],i.posMaxRGB=[0,0,0],i.negMinRGB=[0,0,0],i.negMaxRGB=[0,0,0],s>=2&&(i.posMinRGB[0]=r.getUint8(h),h++,i.posMinRGB[1]=r.getUint8(h),h++,i.posMinRGB[2]=r.getUint8(h),h++,i.posMaxRGB[0]=r.getUint8(h),h++,i.posMaxRGB[1]=r.getUint8(h),h++,i.posMaxRGB[2]=r.getUint8(h),h++,s>=4&&(i.negMinRGB[0]=r.getUint8(h),h++,i.negMinRGB[1]=r.getUint8(h),h++,i.negMinRGB[2]=r.getUint8(h),h++,i.negMaxRGB[0]=r.getUint8(h),h++,i.negMaxRGB[1]=r.getUint8(h),h++,i.negMaxRGB[2]=r.getUint8(h),h++),i.enableSMPColor=r.getUint8(h),h++,s>=4&&(i.lut=d()),i.colorAlpha=r.getFloat32(h,!0),h+=4),i.name=d();let l=new Float32Array(e,h,a);o.set(l,t*a),h+=4*a,n.push(i)}return o}static readSTC(e,t){let i=new DataView(e),r=i.getInt32(8,!1);if(r!==t)throw Error("Overlay has "+r+" vertices, expected "+t);let s=12+4*r,a=i.getUint32(s,!1);s+=4;let l=new Float32Array(a*r);for(let e=0;e<a*r;e++)l[e]=i.getFloat32(s,!1),s+=4;return l}static isCurv(e){let t=new DataView(e),i=t.getUint8(0),r=t.getUint8(1),s=t.getUint8(2);return 255===i&&255===r&&255===s||(I.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),!1)}static readCURV(e,t){let i=new DataView(e),r=i.getUint8(0),s=i.getUint8(1),a=i.getUint8(2),l=i.getUint32(3,!1),o=i.getUint32(11,!1);if((255!==r||255!==s||255!==a)&&I.debug("Unable to recognize file type: does not appear to be FreeSurfer format."),t!==l)throw Error("CURV file has different number of vertices ( "+l+")than mesh ("+t+")");if(e.byteLength<15+4*l*o)throw Error("CURV file smaller than specified");let n=new Float32Array(o*l),h=15;for(let e=0;e<o*l;e++)n[e]=i.getFloat32(h,!1),h+=4;let d=n[0],c=n[0];for(let e=0;e<n.length;e++)d=Math.min(d,n[e]),c=Math.max(c,n[e]);let m=1/(c-d);for(let e=0;e<n.length;e++)n[e]=1-(n[e]-d)*m;return n}static readANNOT(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new DataView(e),s=r.getUint32(0,!1),a=this.decimateLayerVertices(s,t);if(t!==a)throw Error("ANNOT file has different number of vertices than mesh");if(e.byteLength<4+8*s)throw Error("ANNOT file smaller than specified");let l=0,o=new Uint32Array(s);for(let e=0;e<s;e++)o[r.getUint32(l+=4,!1)]=r.getUint32(l+=4,!1);if(!i)return o;let n=0;try{n=r.getInt32(l+=4,!1)}catch(e){return o}if(1!==n||r.getInt32(l+=4,!1)>0)return o;let h=r.getInt32(l+=4,!1),d=r.getInt32(l+=4,!1);l+=d;let c=r.getInt32(l+=4,!1);if(c<1)return o;let m={R:Array(h).fill(0),G:Array(h).fill(0),B:Array(h).fill(0),A:Array(h).fill(0),I:Array(h).fill(0),labels:Array(h).fill("")};for(let e=0;e<c;e++){let e=r.getInt32(l+=4,!1),t=r.getInt32(l+=4,!1);l+=4;let i="";for(let e=0;e<t;e++){let e=r.getUint8(l++);if(0===e)break;i+=String.fromCharCode(e)}l-=4;let s=r.getInt32(l+=4,!1),a=r.getInt32(l+=4,!1),o=r.getInt32(l+=4,!1),n=r.getInt32(l+=4,!1);if(e<0||e>=h){I.warn("annot entry out of range");continue}m.R[e]=s,m.G[e]=a,m.B[e]=o,m.A[e]=n,m.I[e]=(n<<24)+(o<<16)+(a<<8)+s,m.labels[e]=i}let A=new Float32Array(s);A.fill(-1);let g=0;for(let e=0;e<t;e++){let t=o[e];for(let i=0;i<h;i++)if(m.I[i]===t){A[e]=i;break}A[e]<0&&(g++,A[e]=0)}g>0&&I.error(`annot vertex colors do not match ${g} of ${s} vertices.`);for(let e=0;e<h;e++)m.I[e]=e;return{scalars:A,colormapLabel:tG.makeLabelLut(m)}}static readNV(e){let t,i;let r=e.byteLength,s=new Uint8Array(e),a=0,l=0,o=0,n=0,h=0;for(;a<r;){let d=function(){for(;a<r&&10===s[a];)a++;let t=a;for(;a<r&&10!==s[a];)a++;return++a-t<1?"":new TextDecoder().decode(e.slice(t,a-1))}();if(d.startsWith("#"))continue;let c=d.trim().split(/\s+/);if(l<1){t=new Float32Array(3*(l=parseInt(c[0])));continue}if(n<3*l){t[n]=parseFloat(c[0]),t[n+1]=parseFloat(c[1]),t[n+2]=parseFloat(c[2]),n+=3;continue}if(o<1){i=new Uint32Array(3*(o=parseInt(c[0])));continue}if(h>=3*o)break;i[h+2]=parseInt(c[0])-1,i[h+1]=parseInt(c[1])-1,i[h+0]=parseInt(c[2])-1,h+=3}return{positions:t,indices:i}}static readASC(e){let t=e.byteLength,i=new Uint8Array(e),r=0;function s(){for(;r<t&&10===i[r];)r++;let s=r;for(;r<t&&10!==i[r];)r++;return++r-s<1?"":new TextDecoder().decode(e.slice(s,r-1))}let a=s();!a.startsWith("#!ascii")&&I.warn("Invalid ASC mesh");let l=(a=s()).trim().split(/\s+/),o=parseInt(l[0]),n=parseInt(l[1]),h=new Float32Array(3*o),d=0;for(let e=0;e<o;e++)l=(a=s()).trim().split(/\s+/),h[d]=parseFloat(l[0]),h[d+1]=parseFloat(l[1]),h[d+2]=parseFloat(l[2]),d+=3;let c=new Uint32Array(3*n);d=0;for(let e=0;e<n;e++)l=(a=s()).trim().split(/\s+/),c[d]=parseInt(l[0]),c[d+1]=parseInt(l[1]),c[d+2]=parseInt(l[2]),d+=3;return{positions:h,indices:c}}static readVTK(t){let i=t.byteLength;if(i<20)throw Error("File too small to be VTK: bytes = "+t.byteLength);let r=new Uint8Array(t),s=0;function a(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(e)for(;s<i&&10===r[s];)s++;let a=s;for(;s<i&&10!==r[s];)s++;return++s-a<1?"":new TextDecoder().decode(t.slice(a,s-1))}let l=a();if(!l.startsWith("# vtk DataFile"))throw Error("Invalid VTK mesh");if(l=a(!1),(l=a()).startsWith("ASCII"))return e.readTxtVTK(t);if(!l.startsWith("BINARY"))throw Error("Invalid VTK image, expected ASCII or BINARY "+l);if(!(l=a()).includes("POLYDATA"))throw Error("Only able to read VTK POLYDATA "+l);(!(l=a()).includes("POINTS")||!l.includes("double")&&!l.includes("float"))&&I.warn("Only able to read VTK float or double POINTS"+l);let o=l.includes("double"),n=l.trim().split(/\s+/),h=3*parseInt(n[1]),d=new Float32Array(h),c=new DataView(t);if(o)for(let e=0;e<h;e++)d[e]=c.getFloat64(s,!1),s+=8;else for(let e=0;e<h;e++)d[e]=c.getFloat32(s,!1),s+=4;n=(l=a()).trim().split(/\s+/);let m=[];if(n[0].includes("LINES")){let e=parseInt(n[1]),t=s;if((l=a()).startsWith("OFFSETS")){let t=!1;l.includes("int64")&&(t=!0);let i=new Uint32Array(e);if(t){let t=!1;for(let r=0;r<e;r++){let e=c.getInt32(s,!1);0!==e&&(t=!0),s+=4,e=c.getInt32(s,!1),s+=4,i[r]=e}t&&I.warn("int32 overflow: JavaScript does not support int64")}else for(let t=0;t<e;t++){let e=c.getInt32(s,!1);s+=4,i[t]=e}return{pts:d,offsetPt0:i}}s=t;let i=0,r=[],o=[];r.push(i);for(let t=0;t<e;t++){let e=c.getInt32(s,!1);s+=4,i+=e,r.push(i);for(let t=0;t<e;t++){let e=3*c.getInt32(s,!1);s+=4,o.push(d[e+0]),o.push(d[e+1]),o.push(d[e+2])}}return{pts:Float32Array.from(o),offsetPt0:Uint32Array.from(r)}}if(n[0].includes("TRIANGLE_STRIPS")){let e=parseInt(n[1]);for(let t=0;t<e;t++){let e=c.getInt32(s,!1)-2;s+=4;for(let t=0;t<e;t++)t%2?(m.push(c.getInt32(s+8,!1)),m.push(c.getInt32(s+4,!1)),m.push(c.getInt32(s,!1))):(m.push(c.getInt32(s,!1)),m.push(c.getInt32(s+4,!1)),m.push(c.getInt32(s+8,!1))),s+=4;s+=8}}else if(n[0].includes("POLYGONS")){let e=parseInt(n[1]);for(let t=0;t<e;t++){let e=c.getInt32(s,!1)-2;if(0===t&&e>65535)throw Error("Invalid VTK binary polygons using little-endian data (MRtrix)");s+=4;let i=c.getInt32(s,!1);s+=4;let r=c.getInt32(s,!1);s+=4;for(let t=0;t<e;t++){let e=c.getInt32(s,!1);s+=4,m.push(i),m.push(r),m.push(e),r=e}}}else throw Error("Unsupported binary VTK datatype "+n[0]);return{positions:d,indices:new Uint32Array(m)}}static readDFS(e){let t;let i=new DataView(e),r=i.getUint32(0,!0),s=i.getUint16(4,!0);(0x5f534644!==r||17740!==s)&&I.warn("Not a little-endian brainsuite DFS mesh");let a=i.getUint32(12,!0),l=i.getUint32(24,!0),o=i.getUint32(28,!0),n=i.getUint32(48,!0),h=a,d=new Uint32Array(e,h,3*l),c=new Float32Array(e,h+=12*l,3*o);for(let e=0;e<3*o;e+=3){let t=c[e];c[e]=c[e+1],c[e+1]=t}return n>=0&&(t=new Float32Array(e,n,3*o)),{positions:c,indices:d,colors:t}}static readMZ3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e.byteLength<20)throw Error("File too small to be mz3: bytes = "+e.byteLength);let i=new DataView(e),r=i.getUint16(0,!0),s=e;if(35615===r||8075===r){let t=(0,m.iF)(new Uint8Array(e));r=(i=new DataView(t.buffer)).getUint16(0,!0),s=t.buffer}let a=i.getUint16(2,!0),l=i.getUint32(4,!0),o=i.getUint32(8,!0),n=i.getUint32(12,!0);if(I.debug("MZ3 magic %d attr %d face %d vert %d skip %d",r,a,l,o,n),23117!==r)throw Error("Invalid MZ3 file");let h=(1&a)!=0,d=(2&a)!=0,c=(4&a)!=0,A=(8&a)!=0,g=(16&a)!=0;if(a>63)throw Error("Unsupported future version of MZ3 file");let u=4;g&&(u=8);let f=0;if(t>0&&!h&&l<1&&!c&&(A=!0),A){let e=t;0===t&&(e=o);let i=16+n+(h?1:0)*l*12+(d?1:0)*e*12+(c?1:0)*e*4,r=Math.floor((s.byteLength-i)/u);o!==t&&r%t==0&&(I.warn("Issue 729: mz3 mismatch scalar NVERT does not match mesh NVERT"),o=t),(f=Math.floor(r/o))<1&&(I.warn("Corrupt MZ3: file reports NSCALAR but not enough bytes"),A=!1)}if(o<3&&t<3)throw Error("Not a mesh MZ3 file (maybe scalar)");t>0&&t!==o&&I.warn("Layer has "+o+"vertices, but background mesh has "+t);let p=16+n,v=null;h&&(v=new Uint32Array(s,p,3*l),p+=12*l);let x=null;d&&(x=new Float32Array(s,p,3*o),p+=12*o);let w=null;if(c){w=new Float32Array(3*o);let e=new Uint8Array(s,p,4*o);p+=4*o;let t=0,i=0;for(let r=0;r<o;r++){for(let r=0;r<3;r++)w[t]=e[i]/255,t++,i++;i++}}let C=new Float32Array;if(!c&&A&&f>0){if(g){let e=new Float64Array(s,p,f*o);C=Float32Array.from(e)}else C=new Float32Array(s,p,f*o);p+=u*f*o}return t>0?C:{positions:x,indices:v,scalars:C,colors:w}}static readPLY(e){let t;let i=e.byteLength,r=new Uint8Array(e),s=0;function a(){for(;s<i&&10===r[s];)s++;let t=s;for(;s<i&&10!==r[s];)s++;return++s-t<1?"":new TextDecoder().decode(e.slice(t,s-1))}let l=a();if(!l.startsWith("ply"))throw Error("Not a valid PLY file");let o=(l=a()).includes("ascii");function n(e){if("char"===e||"uchar"===e||"int8"===e||"uint8"===e)return 1;if("short"===e||"ushort"===e||"int16"===e||"uint16"===e)return 2;if("int"===e||"uint"===e||"int32"===e||"uint32"===e||"float"===e||"float32"===e)return 4;if("double"===e)return 8;throw Error("Unknown data type: "+e)}let h=l.includes("binary_little_endian"),d=0,c=!1,m=0,A=0,g=0,u=0,f=0,p=0,v=0;for(;s<i&&!l.startsWith("end_header");){if((l=a()).startsWith("comment"))continue;let e=l.split(/\s/);if(l.startsWith("element vertex"))for(d=parseInt(e[e.length-1]),e=(l=a()).split(/\s/);l.startsWith("property");){let t=e[1];"x"===e[2]&&t.startsWith("double")?c=!0:"x"===e[2]&&!t.startsWith("float")&&I.error("Error: expect ply xyz to be float or double: "+l),m+=n(t),e=(l=a()).split(/\s/)}if(l.startsWith("element face"))for(v=parseInt(e[e.length-1]),e=(l=a()).split(/\s/);l.startsWith("property");){if("list"===e[1])g=n(e[2]),A+=g+3*(u=n(e[3]));else{let t=n(e[1]);A+=t,0===u&&(f+=t,p++)}e=(l=a()).split(/\s/)}}if(o){v<1&&I.error(`Malformed ply format: faces ${v} `);let e=new Float32Array(3*d),t=0;for(let i=0;i<d;i++){let i=(l=a()).split(/\s/);e[t]=parseFloat(i[0]),e[t+1]=parseFloat(i[1]),e[t+2]=parseFloat(i[2]),t+=3}let i=new Uint32Array(3*v),r=0;for(let e=0;e<v;e++){let e=(l=a()).split(/\s/),t=parseInt(e[p])-2;if(t<1)break;if(r+3*t>i.length){let e=new Uint32Array(i.length+i.length);e.set(i),i=e.slice()}let s=parseInt(e[p+1]),o=parseInt(e[p+2]);for(let a=0;a<t;a++){let t=parseInt(e[p+3+a]);i[r+0]=s,i[r+1]=o,i[r+2]=t,o=t,r+=3}}return i.length!==r&&(i=i.slice(0,r)),{positions:e,indices:i}}(m<12||g<1||u<1||v<1)&&I.warn(`Malformed ply format: stride ${m} count ${g} iBytes ${u} iStrideBytes ${A} iPadBytes ${f} faces ${v}`);let x=new DataView(e);if(s%4==0&&12===m&&h)t=new Float32Array(e,s,3*d),s+=d*m;else{t=new Float32Array(3*d);let e=0;for(let i=0;i<d;i++)c?(t[e]=x.getFloat64(s,h),t[e+1]=x.getFloat64(s+8,h),t[e+2]=x.getFloat64(s+16,h)):(t[e]=x.getFloat32(s,h),t[e+1]=x.getFloat32(s+4,h),t[e+2]=x.getFloat32(s+8,h)),e+=3,s+=m}let w=new Uint32Array(3*v),C=!0,b=0;if(1===g&&4===u&&13===A)for(let e=0;e<v;e++){let e=x.getUint8(s);s+=g,3!==e&&(C=!1),w[b]=x.getUint32(s,h),s+=4,w[b+1]=x.getUint32(s,h),s+=4,w[b+2]=x.getUint32(s,h),s+=4,b+=3}else{let e=s;for(let t=0;t<v;t++){s=e+f;let t=0;1===g?t=x.getUint8(s):2===g?t=x.getUint16(s,h):4===g&&(t=x.getUint32(s,h)),s+=g,3!==t&&(C=!1);for(let e=0;e<3;e++)1===u?w[b]=x.getUint8(s):2===u?w[b]=x.getUint16(s,h):4===u&&(w[b]=x.getUint32(s,h)),b++,s+=u;e+=A}}return!C&&I.warn("Only able to read PLY meshes limited to triangles."),{positions:t,indices:w}}static readICO(e){let t=new TextDecoder("utf-8").decode(e).split("\n"),i=t[0].trim().split(/\s+/);i.length>1&&I.warn("This is not a valid FreeSurfer ICO/TRI mesh.");let r=parseInt(i[0]),s=new Float32Array(3*r),a=1;for(let e=0;e<r;e++){let e=t[a].trim().split(/\s+/);a++;let i=parseInt(e[0])-1,l=parseFloat(e[1]),o=parseFloat(e[2]),n=parseFloat(e[3]);if(i<0||i>=r){I.error("ICO vertices corrupted");break}s[i*=3]=l,s[i+1]=o,s[i+2]=n}i=t[a].trim().split(/\s+/),a++;let l=parseInt(i[0]),o=new Uint32Array(3*l);for(let e=0;e<l;e++){let e=t[a].trim().split(/\s+/);a++;let i=parseInt(e[0])-1,r=parseInt(e[1])-1,s=parseInt(e[2])-1,n=parseInt(e[3])-1;if(i<0||i>=l){I.error("ICO indices corrupted");break}o[i*=3]=r,o[i+1]=s,o[i+2]=n}for(let e=0;e<o.length;e+=3){let t=o[e];o[e]=o[e+1],o[e+1]=t}return{positions:s,indices:o}}static readGEO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new TextDecoder("utf-8").decode(e).split("\n"),r=i[0].trim().split(/\s+/),s=parseInt(r[0]),a=parseInt(r[1]),l=parseInt(r[2]),o=parseInt(r[3]);(s>1||o!==3*l)&&I.warn("Multi-part BYU/GEO header or not a triangular mesh.");let n=[];a*=3;let h=0,d=2;for(;h<a;){let e=i[d].trim().split(/\s+/);d++;for(let t=0;t<e.length&&(n.push(parseFloat(e[t])),!(++h>=a));t++);}let c=[];l*=3;let m=0;for(;m<l;){let e=i[d].trim().split(/\s+/);d++;for(let t=0;t<e.length&&(c.push(Math.abs(parseInt(e[t]))-1),!(++m>=l));t++);}if(t)for(let e=0;e<c.length;e+=3){let t=c[e];c[e]=c[e+1],c[e+1]=t}let A=new Float32Array(n);return{positions:A,indices:new Uint32Array(c)}}static readOFF(e){let t=new TextDecoder("utf-8").decode(e).split("\n"),i=[],r=[],s=0;t[0].includes("OFF")?s++:I.warn("File does not start with OFF");let a=t[s].trim().split(/\s+/),l=parseInt(a[0]),o=parseInt(a[1]);s++;for(let e=0;e<l;e++)a=t[s].trim().split(/\s+/),i.push(parseFloat(a[0])),i.push(parseFloat(a[1])),i.push(parseFloat(a[2])),s++;for(let e=0;e<o;e++)3!==parseInt((a=t[s].trim().split(/\s+/))[0])&&I.warn("Only able to read OFF files with triangular meshes"),r.push(parseInt(a[1])),r.push(parseInt(a[2])),r.push(parseInt(a[3])),s++;let n=new Float32Array(i);return{positions:n,indices:new Uint32Array(r)}}static readOBJMNI(e){let t=new TextDecoder("utf-8").decode(e).trim().split(/\s*,\s*|\s+/);(t.length<1||"P"!==t[0])&&I.warn("This is not a valid MNI OBJ mesh.");let i=6,r=parseInt(t[i++]),s=3*r,a=new Float32Array(s);for(let e=0;e<s;e++)a[e]=parseFloat(t[i++]);i+=s;let l=parseInt(t[i++]),o=parseInt(t[i++]);(l<1||o<0||o>2)&&I.warn("This is not a valid MNI OBJ mesh.");let n=1;1===o?n=l:1===o&&(n=r),i+=4*n,i+=l;let h=3*l,d=new Uint32Array(h);for(let e=0;e<h;e++)d[e]=parseInt(t[i++]);return{positions:a,indices:d}}static readOBJ(e){let t=new TextDecoder("utf-8").decode(e);if("P"===t[0])return this.readOBJMNI(e);let i=t.split("\n"),r=i.length,s=[],a=[];for(let e=0;e<r;e++){let t=i[e];if("v"===t[0]&&" "===t[1]){let e=t.trim().split(/\s+/);s.push(parseFloat(e[1])),s.push(parseFloat(e[2])),s.push(parseFloat(e[3]))}if("f"===t[0]){let e=t.trim().split(/\s+/),i=e.length-3;if(i<1)break;let r=e[1].split("/"),s=parseInt(r[0])-1,l=parseInt((r=e[2].split("/"))[0])-1;for(let t=0;t<i;t++){let i=parseInt((r=e[3+t].split("/"))[0])-1;a.push(s),a.push(l),a.push(i),l=i}}}let l=new Float32Array(s);return{positions:l,indices:new Uint32Array(a)}}static readFreeSurfer(t){let i=new Uint8Array(t);if(35===i[0]&&33===i[1]&&97===i[2])return e.readASC(t);let r=new DataView(t),s=r.getUint32(0,!1),a=r.getUint32(4,!1);(0xfffffe63!==s||0x72656174!==a)&&I.debug("Unable to recognize file type: does not appear to be FreeSurfer format.");let l=0;for(;10!==r.getUint8(l);)l++;l+=2;let o=r.getUint32(l,!1);l+=4;let n=r.getUint32(l,!1);l+=4;let h=new Float32Array(o*=3);for(let e=0;e<o;e++)h[e]=r.getFloat32(l,!1),l+=4;let d=new Uint32Array(n*=3);for(let e=0;e<n;e++)d[e]=r.getUint32(l,!1),l+=4;let c=r.getUint32(l,!1);l+=4;let m=20===c;if(!m){let e=r.getUint32(l,!1);l+=4;let t=r.getUint32(l,!1);l+=4,m=2===c&&0===e&&20===t}if(m){let e=new TextDecoder().decode(t.slice(l)).trim().split("\n");for(let t=0;t<e.length;t++){if(!e[t].startsWith("cras"))continue;let i=e[t].split("=")[1].trim().split(" ").map(Number),r=Math.floor(h.length/3),s=0;for(let e=0;e<r;e++)h[s]+=i[0],s++,h[s]+=i[1],s++,h[s]+=i[2],s++}}else I.warn("Unknown FreeSurfer Mesh extension code.");return{positions:h,indices:d}}static readSRF(t){let i=new Uint8Array(t);if(35===i[0]&&33===i[1]&&97===i[2])return e.readASC(t);31===i[0]&&139===i[1]&&(t=(0,m.iF)(new Uint8Array(t)).buffer);let r=new DataView(t),s=r.getFloat32(0,!0),a=r.getUint32(8,!0),l=r.getUint32(12,!0),o=r.getFloat32(16,!0),n=r.getFloat32(20,!0),h=r.getFloat32(24,!0),d=new Float32Array(3*a),c=28,A=1;for(let e=0;e<a;e++)d[A]=-r.getFloat32(c,!0)+o,A+=3,c+=4;A=2;for(let e=0;e<a;e++)d[A]=-r.getFloat32(c,!0)+n,A+=3,c+=4;A=0;for(let e=0;e<a;e++)d[A]=-r.getFloat32(c,!0)+h,A+=3,c+=4;c=28+24*a;let g=r.getFloat32(c,!0),u=r.getFloat32(c+4,!0),f=r.getFloat32(c+8,!0),p=r.getFloat32(c+16,!0),v=r.getFloat32(c+20,!0),x=r.getFloat32(c+24,!0);c+=32;let w=new Float32Array(3*a),C=new Uint32Array(t,c,a);A=0;for(let e=0;e<a;e++){let t=C[e];t>0x3f000000&&(w[A+0]=(t>>16&255)/255,w[A+1]=(t>>8&255)/255,w[A+2]=(255&t)/255),0===t&&(w[A+0]=g,w[A+1]=u,w[A+2]=f),1===t&&(w[A+0]=p,w[A+1]=v,w[A+2]=x),A+=3}c+=4*a;for(let e=0;e<a;e++){let e=r.getUint32(c,!0);c+=4+4*e}let b=new Uint32Array(3*l);for(let e=0;e<3*l;e++)b[e]=r.getInt32(c,!0),c+=4;return 4!==s&&I.warn("Not valid SRF"),{positions:d,indices:b,colors:w}}static readTxtSTL(e){let t=new TextDecoder("utf-8").decode(e).split("\n");if(!t[0].startsWith("solid"))throw Error("Not a valid STL file");let i=[];for(let e=1;e<t.length;e++){if(!t[e].includes("vertex"))continue;let r=t[e].trim().split(/\s+/);for(let e=1;e<r.length;e++)i.push(parseFloat(r[e]))}let r=Math.floor(i.length/3);if(3*r!==i.length)throw Error("Unable to parse ASCII STL file.");let s=new Float32Array(i),a=new Uint32Array(r);for(let e=0;e<r;e++)a[e]=e;return{positions:s,indices:a}}static readSTL(t){if(t.byteLength<134)throw Error("File too small to be STL: bytes = "+t.byteLength);let i=new DataView(t);if(0x696c6f73===i.getUint32(0,!0))return e.readTxtSTL(t);let r=i.getUint32(80,!0),s=3*r;if(t.byteLength<84+50*r)throw Error("STL file too small to store triangles = "+r);let a=new Uint32Array(s),l=new Float32Array(3*s),o=96,n=0;for(let e=0;e<r;e++){for(let e=0;e<9;e++)l[n]=i.getFloat32(o,!0),n+=1,o+=4;o+=14}for(let e=0;e<s;e++)a[e]=e;return{positions:l,indices:a}}static decimateLayerVertices(e,t){if(e%t==0)return e;let i=10*Math.pow(4,Math.round(Math.log((t-2)/10)/Math.log(4)))+2;return 10*Math.pow(4,Math.round(Math.log((e-2)/10)/Math.log(4)))+2!==e||i!==t?e:t}static readNII2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=new Float32Array,s=e.byteLength,a=!0,l=new DataView(e),o=l.getUint16(0,a);if(0x1c020000===o&&(a=!1,o=l.getUint16(0,a)),540!==o)throw Error("Not a valid NIfTI-2 dataset");let n=Number(l.getBigInt64(168,a)),h=l.getFloat64(176,a),d=l.getFloat64(184,a);(1!==h||0!==d)&&I.warn("ignoring scale slope and intercept");let c=l.getUint32(504,a),m=l.getUint16(12,a);if(2!==m&&4!==m&&8!==m&&16!==m)throw Error("Unsupported NIfTI datatype "+m);let A=1,g=[1,1,1,1,1,1,1,1];for(let e=1;e<8;e++)g[e]=Math.max(Number(l.getBigInt64(16+8*e,a)),1),A*=g[e];if(c>=3e3&&c<=3099&&n>580){let r,o=function(){for(;x<s&&10===v[x];)x++;let t=x;for(;x<s&&10!==v[x];)x++;return++x-t<1?"":new TextDecoder().decode(e.slice(t,x-1)).trim()},h=function(){let e=o();if(!e.startsWith("<")||e.endsWith(">"))return e;for(;x<s&&!e.endsWith(">");)e+=o();return e},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=r.indexOf(e);if(i<0)return 1;let s=r.indexOf('"',i)+1,a=r.indexOf('"',s),l=r.slice(s,a);return t?l:parseInt(l)},c=0,A=0,u=0,f="",p=new Uint32Array,v=new Uint8Array(e),x=552,w=g[5],C=new Float32Array(t*w);for(;x<s&&!(r=h()).includes("</CIFTI>");){;if(r.includes("<BrainModel")){let e=d("SurfaceNumberOfVertices="),s=d("BrainStructure=",!0).toUpperCase();if(e%t!=0)continue;let a=!1;if(i.includes("CORTEX")&&s.includes("CORTEX")&&(a=!0),!a)continue;if(a=!1,i.includes("LEFT")&&s.includes("LEFT")&&(a=!0),i.includes("RIGHT")&&s.includes("RIGHT")&&(a=!0),!a)continue;if(u=e,c=d("IndexOffset="),A=d("IndexCount="),f=s,!r.includes("<VertexIndices>")&&(r=h()),!r.startsWith("<VertexIndices>")||!r.endsWith("</VertexIndices>"))return I.warn("Unable to find CIfTI <VertexIndices>"),C;let l=(r=r.slice(15,-16)).trim().split(/\s+/);l.length<A&&I.error("Error parsing VertexIndices"),p=new Uint32Array(A);for(let e=0;e<A;e++)p[e]=parseInt(l[e])}}if(0===u||0===p.length)return I.warn("Unable to find CIfTI structure that matches the mesh."),C;if(16!==m)return I.warn("Only able to read float32 CIfTI (only known datatype)."),C;let b=new Float32Array(A*w),y=n+w*c*4;for(let e=0;e<A*w;e++)b[e]=l.getFloat32(y+4*e,a);let M=0;for(let e=0;e<A;e++)for(let i=0;i<w;i++)C[p[e]+i*t]=b[M],M++;return I.debug("CIfTI diagnostics",u,f,c,A,c,i),C}if((A=this.decimateLayerVertices(A,t))%t!=0)throw Error("Vertices in layer ("+A+") is not a multiple of number of vertices ("+t+")");if(a)16===m?r=new Float32Array(e,n,A):8===m?r=new Int32Array(e,n,A):4===m&&(r=new Int16Array(e,n,A));else if(16===m){r=new Float32Array(A);for(let e=0;e<A;e++)r[e]=l.getFloat32(n+4*e,a)}else if(8===m){r=new Int32Array(A);for(let e=0;e<A;e++)r[e]=l.getInt32(n+4*e,a)}else if(4===m){r=new Int16Array(A);for(let e=0;e<A;e++)r[e]=l.getInt16(n+2*e,a)}return 2===m&&(r=new Uint8Array(e,n,A)),r}static readNII(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=new Float32Array,a=!0,l=new DataView(t),o=l.getUint16(0,a);if(540===o||0x1c020000===o)return e.readNII2(t,i,r);if(23553===o&&(a=!1,o=l.getUint16(0,a)),348!==o){let s=(0,m.iF)(new Uint8Array(t));if(l=new DataView(s.buffer),t=s.buffer,540===(o=l.getUint16(0,a))||0x1c020000===o)return e.readNII2(t,i,r);23553===o&&(a=!1,o=l.getUint16(0,a))}348!==o&&I.error("Not a valid NIfTI image.");let n=l.getFloat32(108,a),h=l.getFloat32(112,a),d=l.getFloat32(116,a);(1!==h||0!==d)&&I.warn("ignoring scale slope and intercept");let c=l.getUint16(70,a);if(2!==c&&4!==c&&8!==c&&16!==c)throw Error("Unsupported NIfTI datatype "+c);let A=1;for(let e=1;e<8;e++)A*=Math.max(l.getUint16(40+2*e,a),1);if((A=this.decimateLayerVertices(A,i))%i!=0)throw Error("Vertices in layer ("+A+") is not a multiple of number of vertices ("+i+")");if(a)16===c?s=new Float32Array(t,n,A):8===c?s=new Int32Array(t,n,A):4===c&&(s=new Int16Array(t,n,A));else if(16===c){s=new Float32Array(A);for(let e=0;e<A;e++)s[e]=l.getFloat32(n+4*e,a)}else if(8===c){s=new Int32Array(A);for(let e=0;e<A;e++)s[e]=l.getInt32(n+4*e,a)}else if(4===c){s=new Int16Array(A);for(let e=0;e<A;e++)s[e]=l.getInt16(n+2*e,a)}return 2===c&&(s=new Uint8Array(t,n,A)),s}static readMGH(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=new DataView(e),a=e;if(31===s.getUint8(0)&&139===s.getUint8(1)){let t=(0,m.iF)(new Uint8Array(e));new Uint8Array(a=new ArrayBuffer(t.byteLength)).set(new Uint8Array(t)),s=new DataView(t.buffer)}let l=s.getInt32(0,!1),o=Math.max(1,s.getInt32(4,!1)),n=Math.max(1,s.getInt32(8,!1)),h=Math.max(1,s.getInt32(12,!1)),d=Math.max(1,s.getInt32(16,!1)),c=s.getInt32(20,!1),A=284;(1!==l||c<0||c>4)&&I.warn("Not a valid MGH file");let g=o*n*h*d,u=[];if((g=this.decimateLayerVertices(g,i))%i!=0)return I.warn("Vertices in layer ("+g+") is not a multiple of number of vertices ("+i+")"),u;if(3===c){u=new Float32Array(g);for(let e=0;e<g;e++)u[e]=s.getFloat32(A+4*e,!1)}else if(1===c){u=new Int32Array(g);for(let e=0;e<g;e++)u[e]=s.getInt32(A+4*e,!1)}else if(4===c){u=new Int16Array(g);for(let e=0;e<g;e++)u[e]=s.getInt16(A+2*e,!1)}else 0===c&&(u=new Uint8Array(e,A,g));if(!r)return u;let f=4;4===c&&(f=2),0===c&&(f=1),A+=f*g,A+=16;let p=a.byteLength;for(;A<p-8;){let e=s.getInt32(A+=4,!1),i=0;switch(e){case 30:i=s.getInt32(A+=4,!1)-1;break;case 20:case 2:i=0;break;case 1:i=0;{let e=s.getInt32(A+=4,!1);if(e>0)return I.warn("unsupported CTABreadFromBinaryV1"),u;if(2!=(e=-e))return I.warn("CTABreadFromBinary: unknown version"),u;let i=s.getInt32(A+=4,!1);if(i<0)return I.warn("CTABreadFromBinaryV2: nentries was ",i),u;let r=s.getInt32(A+=4,!1);A+=r;let a=s.getInt32(A+=4,!1);if(a<0)return u;let l={R:[],G:[],B:[],A:[],I:[],labels:[]};for(let e=0;e<a;e++){let e=s.getInt32(A+=4,!1),t=s.getInt32(A+=4,!1),i=A+4,r="";for(let e=0;e<t;e++){let e=s.getUint8(i++);if(0===e)break;r+=String.fromCharCode(e)}A+=t;let a=s.getInt32(A+=4,!1),o=s.getInt32(A+=4,!1),n=s.getInt32(A+=4,!1),h=255-s.getInt32(A+=4,!1);l.I.push(e),l.R.push(a),l.G.push(o),l.B.push(n),l.A.push(h),l.labels.push(r)}t=tG.makeLabelLut(l)}break;default:i=s.getInt32(A+=8,!1)}A+=i}return{scalars:u,colormapLabel:t}}static readX3D(e){let t=e.byteLength;if(t<20)throw Error("File too small to be X3D: bytes = "+t);let i=new Uint8Array(e),r=0;function s(){for(;r<t&&60!==i[r];)r++;let s=r;for(;r<t&&62!==i[r];)r++;let a=r;return new TextDecoder().decode(e.slice(s,a+1)).trim()}let a=s();function l(e){let t=a.indexOf(e+"=");if(t<0)return"";let i=a[t+e.length+1],r=a.indexOf(i,t)+1,s=a.indexOf(i,r);return a.slice(r,s)}function d(e){let t=a.indexOf(e+"=");if(t<0)return 1;let i=a[t+e.length+1],r=a.indexOf(i,t)+1,s=a.indexOf(i,r),l=a.slice(r,s).trim(),o=(l=l.replace(/,\s*$/,"")).trim().split(/\s*,\s*|\s+/);if(o.length<2)return parseFloat(l);let n=Array(o.length),h=0;for(let e=0;e<o.length;e++){let t=parseFloat(o[e]);if(!!isFinite(t))n[h]=t,h++}return n=n.slice(0,h)}!a.includes("xml version")&&I.warn("Not a X3D image");let c=[],m=[],A=[],g=[],u=[0,0,0,0],f=[0,0,0,0],p=[255,255,255,255],v=[255,255,255,255],x={};function w(){if(!a.endsWith("/>")){if(a.startsWith("<Appearance>"))for(;r<t&&!a.endsWith("</Appearance>");)a+=s();else for(;r<t&&!a.endsWith("/>");)a+=s()}let e=l("USE");if(e.length>1){e in x?p=x[e]:I.warn("Unable to find DEF for "+e);return}let i=d("diffuseColor");if(i.length<3)return;p[0]=Math.round(255*i[0]),p[1]=Math.round(255*i[1]),p[2]=Math.round(255*i[2]);let o=l("DEF");if(!(o.length<1))x[o]=p}for(;r<t;)if(a=s(),p=v.slice(),a.startsWith("<Transform")&&(u=d("translation"),f=d("rotation")),a.startsWith("<Appearance")&&(w(),v=p.slice()),a.startsWith("<Shape")){let e=1,i=1,l=[],v=[];for(;r<t&&((a=s()).startsWith("<Appearance")&&w(),!a.startsWith("</Shape"));){;if(a.startsWith("<Sphere")&&(e=d("radius"),i=-1),a.startsWith("<Cylinder")&&(e=d("radius"),i=d("height")),a.startsWith("<IndexedFaceSet")&&(i=-2,l=d("coordIndex")),a.startsWith("<IndexedTriangleSet")&&(i=-7,l=d("index")),a.startsWith("<IndexedTriangleStripSet")&&(i=-3,l=d("index")),a.startsWith("<Coordinate")){let e=(v=d("point")).length%3;0!==e&&(v=v.slice(0,-e))}a.startsWith("<Color")&&(g=d("color")),a.startsWith("<Box")&&(i=-4,I.warn("Unsupported x3d shape: Box")),a.startsWith("<Cone")&&(i=-5,I.warn("Unsupported x3d shape: Cone")),a.startsWith("<ElevationGrid")&&(i=-6,I.warn("Unsupported x3d shape: ElevationGrid"))}if(i<-3&&-7!==i);else if(i<-1){if(l.length<1||v.length<3||void 0===v.length){I.warn("Indexed mesh must specify indices and points");break}let e=Math.floor(c.length/3),t=2;if(-7===i)m=[...m,...l];else if(-2===i){let i=0;for(;t<l.length;)l[t]>=0?(m.push(l[i]+e),m.push(l[t-1]+e),m.push(l[t-0]+e),t+=1):(t+=3,i=t-2)}else for(;t<l.length;)l[t]>=0?(m.push(l[t-2]+e),m.push(l[t-1]+e),m.push(l[t-0]+e),t+=1):t+=3;c=[...c,...v];let r=Math.floor(v.length/3),s=Array(r).fill(p).flat();if(g.length===3*r){let e=0,t=0;for(let i=0;i<r;i++){for(let i=0;i<3;i++)s[t]=Math.round(255*g[e]),e++,t++;t++}}A=[...A,...s]}else if(i<0)eP.makeColoredSphere(c,m,A,e,u,p);else{let t=h.Ue();h.Us(t,f[3],[f[0],f[1],f[2]]);let r=o.al(0,-(.5*i),0,1),s=o.al(0,.5*+i,0,1);o.fF(r,r,t),o.fF(s,s,t),o.IH(r,r,u),o.IH(s,s,u);let a=n.al(r[0],r[1],r[2]),l=n.al(s[0],s[1],s[2]);eP.makeColoredCylinder(c,m,A,a,l,e,p)}}return{positions:Float32Array.from(c),indices:Uint32Array.from(m),rgba255:Uint8Array.from(A)}}static readGII(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.byteLength;if(r<20)throw Error("File too small to be GII: bytes = "+r);let s=new TextDecoder("ascii").decode(e);if(31===s[0].charCodeAt(0)){let t=(0,m.iF)(new Uint8Array(e));e=t.buffer,s=new TextDecoder("ascii").decode(t.buffer)}let a=0;function l(){let t=!0,i=a;for(;t;){for(;a<r&&"<"!==s[a];)a++;for(i=a;a<r&&">"!==s[a];)a++;if(t="/"===s[a-1],i+1<r&&"/"===s[i+1]&&(a+=1,t=!0),a>=r)break}let l=new TextDecoder().decode(e.slice(i+1,a)).trim(),o=l.split(" ")[0].trim(),n=a,h=a,d=a;if("?"!==s[i+1]&&"!"!==s[i+1]){let e="</"+o+">";d=(h=s.indexOf(e,n))+e.length-1}return{name:l,startPos:i,contentStartPos:n,contentEndPos:h,endPos:d}}let o=l();if(!o.name.startsWith("?xml"))throw Error("readGII: Invalid XML file");for(;!o.name.startsWith("GIFTI")&&o.endPos<r;)o=l();if(!o.name.startsWith("GIFTI")||o.contentStartPos===o.contentEndPos)throw Error("readGII: XML file does not include GIFTI tag");r=o.contentEndPos;let n=new Float32Array,h=new Uint32Array,d=new Float32Array,c="",A=!1,g=!1,u=!1,f=!1,p=[1,1,1],v=[0,0,0],x=0,w=!1,C=!1,b=0,y=!1;o.endPos=o.contentStartPos;let M="";function D(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=M.indexOf(e);if(i<0)return 1;let r=M.indexOf('"',i)+1,s=M.indexOf('"',r),a=M.slice(r,s);return t?parseFloat(a):parseInt(a)}function F(e){let t=M.indexOf(e);if(t<0)return"";let i=t+e.length,r=M.indexOf("]",i);return M.slice(i,r)}let T={R:[],G:[],B:[],A:[],I:[],labels:[]};for(;o.endPos<r&&o.name.length>1;){if((o=l()).name.startsWith("Label Key")&&(M=o.name,T.I.push(D("Key=")),T.R.push(Math.round(255*D("Red=",!0))),T.G.push(Math.round(255*D("Green=",!0))),T.B.push(Math.round(255*D("Blue=",!0))),T.A.push(Math.round(255*D("Alpha",!0))),M=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim(),T.labels.push(F("<![CDATA["))),"Data"===o.name.trim()){let t;if(u)continue;if(M=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim(),C){let e=p[0]*p[1]*p[2],i=M.split(/\s+/);if(e!==i.length)throw Error("Unable to parse ASCII GIfTI");if(2===x&&(x=8),32===x&&(x=16),8===x){t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=parseInt(i[r])}if(16===x){t=new Float32Array(e);for(let r=0;r<e;r++)t[r]=parseFloat(i[r])}}else if("undefined"==typeof Buffer){let e=function(e){let t=atob(e),i=t.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=t.charCodeAt(e);return r};if(w){let i=e(M.slice());t=(0,m.iF)(new Uint8Array(i))}else t=e(M.slice())}else if(w){let e=Buffer.from(M.slice(),"base64");t=(0,m.iF)(new Uint8Array(e))}else t=Buffer.from(M.slice(),"base64");if(g){if(16!==x&&I.warn("expect positions as FLOAT32"),n=new Float32Array(t.buffer),f){let e=n.slice(),t=e.length/3,i=0;for(let r=0;r<t;r++)for(let s=0;s<3;s++)n[i]=e[s*t+r],i++}}else if(A){if(8!==x&&I.warn("expect indices as INT32"),h=new Uint32Array(t.buffer),f){let e=h.slice(),t=e.length/3,i=0;for(let r=0;r<t;r++)for(let s=0;s<3;s++)h[i]=e[s*t+r],i++}}else{let e;if(b=p[0]*p[1]*p[2],0!==i&&b%i!=0&&I.warn("Number of vertices in scalar overlay ("+b+") does not match mesh ("+i+")"),2===x){let i=new Uint8Array(t.buffer);e=Float32Array.from(i)}else if(8===x){let i=new Int32Array(t.buffer);e=Float32Array.from(i)}else if(16===x)e=new Float32Array(t.buffer);else if(32===x){let i=new Float64Array(t.buffer);e=Float32Array.from(i)}else throw Error(`Invalid dataType: ${x}`);d=function(e,t){let i=e.length,r=new Float32Array(i+t.length);return r.set(e),r.set(t,i),r}(d,e)}continue}if("DataSpace"===o.name.trim()&&(M=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim()).includes("NIFTI_XFORM_SCANNER_ANAT")&&(y=!0),"MD"===o.name.trim()&&((M=new TextDecoder().decode(e.slice(o.contentStartPos+1,o.contentEndPos)).trim()).includes("AnatomicalStructurePrimary")&&M.includes("CDATA[")&&(c=F("<Value><![CDATA[").toUpperCase()),M.includes("VolGeom")&&M.includes("CDATA["))){let e=-1;if(M.includes("VolGeomC_R")&&(e=0),M.includes("VolGeomC_A")&&(e=1),M.includes("VolGeomC_S")&&(e=2),e<0)continue;v[e]=parseFloat(F("<Value><![CDATA["))}if(!!o.name.startsWith("DataArray"))M=o.name,p=[1,1,1],w=M.includes('Encoding="GZipBase64Binary"'),C=M.includes('Encoding="ASCII"'),A=M.includes('Intent="NIFTI_INTENT_TRIANGLE"'),g=M.includes('Intent="NIFTI_INTENT_POINTSET"'),u=M.includes('Intent="NIFTI_INTENT_VECTOR"'),f=M.includes('ArrayIndexingOrder="ColumnMajorOrder"'),M.includes('DataType="NIFTI_TYPE_UINT8"')&&(x=2),M.includes('DataType="NIFTI_TYPE_INT32"')&&(x=8),M.includes('DataType="NIFTI_TYPE_FLOAT32"')&&(x=16),M.includes('DataType="NIFTI_TYPE_FLOAT64"')&&(x=32),p[0]=D("Dim0="),p[1]=D("Dim1="),p[2]=D("Dim2=")}if(T.I.length>1&&(t=tG.makeLabelLut(T)),i>0)return{scalars:d,colormapLabel:t,anatomicalStructurePrimary:c};if(n.length>2&&!y&&(0!==v[0]||0!==v[1]||0!==v[2])){b=Math.floor(n.length/3);let e=0;for(let t=0;t<b;t++)n[e]+=v[0],e++,n[e]+=v[1],e++,n[e]+=v[2],e++}return{positions:n,indices:h,scalars:d,colormapLabel:t,anatomicalStructurePrimary:c}}},tQ={colormap:"gray",opacity:0,nFrame4D:0,frame4D:0,outlineBorder:0,cal_min:0,cal_max:0,cal_minNeg:0,cal_maxNeg:0,values:[]},tz=class e{constructor(e,t,i="",r=new Uint8Array([255,255,255,255]),s=1,a=!0,l,o=null,n=null,h=null,d=null,m=!0,A=""){C(this,"id"),C(this,"name"),C(this,"anatomicalStructurePrimary"),C(this,"colorbarVisible"),C(this,"furthestVertexFromOrigin"),C(this,"extentsMin"),C(this,"extentsMax"),C(this,"opacity"),C(this,"visible"),C(this,"meshShaderIndex",0),C(this,"offsetPt0",null),C(this,"colormapInvert",!1),C(this,"fiberGroupColormap",null),C(this,"indexBuffer"),C(this,"vertexBuffer"),C(this,"vao"),C(this,"vaoFiber"),C(this,"pts"),C(this,"tris"),C(this,"layers"),C(this,"type","mesh"),C(this,"data_type"),C(this,"rgba255"),C(this,"fiberLength"),C(this,"fiberLengths"),C(this,"fiberDensity"),C(this,"fiberDither",.1),C(this,"fiberColor","Global"),C(this,"fiberDecimationStride",1),C(this,"fiberSides",5),C(this,"fiberRadius",0),C(this,"fiberOcclusion",0),C(this,"f32PerVertex",5),C(this,"fiberMask"),C(this,"colormap"),C(this,"dpg"),C(this,"dps"),C(this,"dpv"),C(this,"hasConnectome",!1),C(this,"connectome"),C(this,"indexCount"),C(this,"vertexCount",1),C(this,"nodeScale",4),C(this,"edgeScale",1),C(this,"legendLineThickness",0),C(this,"nodeColormap","warm"),C(this,"edgeColormap","warm"),C(this,"nodeColormapNegative"),C(this,"edgeColormapNegative"),C(this,"nodeMinColor"),C(this,"nodeMaxColor"),C(this,"edgeMin"),C(this,"edgeMax"),C(this,"nodes"),C(this,"edges"),C(this,"points"),this.anatomicalStructurePrimary=A,this.name=i,this.colorbarVisible=m,this.id=(0,c.v4)();let g=tK.getExtents(e);if(this.furthestVertexFromOrigin=g.mxDx,this.extentsMin=g.extentsMin,this.extentsMax=g.extentsMax,this.opacity=s>1?1:s,this.visible=a,this.meshShaderIndex=0,this.indexBuffer=l.createBuffer(),this.vertexBuffer=l.createBuffer(),this.vao=l.createVertexArray(),l.bindVertexArray(this.vao),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.enableVertexAttribArray(1),7!==this.f32PerVertex?(l.vertexAttribPointer(0,3,l.FLOAT,!1,20,0),l.vertexAttribPointer(1,4,l.BYTE,!0,20,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,20,16)):(l.vertexAttribPointer(0,3,l.FLOAT,!1,28,0),l.vertexAttribPointer(1,3,l.FLOAT,!1,28,12),l.enableVertexAttribArray(2),l.vertexAttribPointer(2,4,l.UNSIGNED_BYTE,!0,28,24)),l.bindVertexArray(null),this.vaoFiber=l.createVertexArray(),this.offsetPt0=null,this.hasConnectome=!1,this.colormapInvert=!1,this.fiberGroupColormap=null,this.pts=e,this.layers=[],this.type="mesh",this.tris=t,r[3]<1){this.rgba255=r,this.fiberLength=2,this.fiberDither=.1,this.fiberColor="Global",this.fiberDecimationStride=1,this.fiberMask=[],this.colormap=o,this.dpg=n,this.dps=h,this.dpv=d,n&&this.initValuesArray(n),h&&this.initValuesArray(h),d&&this.initValuesArray(d),this.offsetPt0=new Uint32Array(t),this.tris=new Uint32Array(0),this.updateFibers(l),l.bindVertexArray(this.vaoFiber),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer),l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer),l.enableVertexAttribArray(0),l.vertexAttribPointer(0,3,l.FLOAT,!1,16,0),l.enableVertexAttribArray(1),l.vertexAttribPointer(1,4,l.UNSIGNED_BYTE,!0,16,12),l.bindVertexArray(null);return}if(o){this.connectome=o,this.hasConnectome=!0;let e=Object.keys(o);for(let t=0,i=e.length;t<i;t++)this[e[t]]=o[e[t]]}this.rgba255=r,this.updateMesh(l)}initValuesArray(e){for(let t=0;t<e.length;t++){let i=e[t].vals.reduce((e,t)=>Math.min(e,t)),r=e[t].vals.reduce((e,t)=>Math.max(e,t));e[t].global_min=i,e[t].global_max=r,e[t].cal_min=i,e[t].cal_max=r}return e}linesToCylinders(e,t,i){function r(e){return n.al(e[0],e[1],e[2])}let s=0xffffffff,a=i.length,l=0,h=0;for(let e=0;e<a;e++){if(i[e]===s){h++;continue}l++}let d=this.fiberSides,c=d*l,m=this.f32PerVertex;if(5!==m)throw Error("fiberSides > 1 requires f32PerVertex == 5");let A=new Float32Array(c*m),g=new Uint8Array(A.buffer),u=0,f=o.Ue(),p=o.Ue(),v=o.Ue(),x=n.Ue(),w=n.Ue(),C=0,b=this.fiberRadius;for(let e=0;e<a;e++){let l=i[e]===s;if(l&&C<1)continue;let h=4*i[e];if(++C<=1){f=o.al(t[h+0],t[h+1],t[h+2],t[h+3]),p=o.d9(f),e+1<a&&i[e+1]!==s&&(h=4*i[e+1],v=o.al(t[h+0],t[h+1],t[h+2],t[h+3]),n.$X(x,r(f),r(v)),n.Fv(x,x),w=eP.getFirstPerpVector(x));continue}v=l?o.d9(p):o.al(t[h+0],t[h+1],t[h+2],t[h+3]),n.$X(x,r(f),r(v)),n.Fv(x,x);let c=n.Ue();n.kC(c,w,x);let y=n.Ue();n.kC(y,x,c),w=n.d9(w);let I=n.Ue();n.kC(I,x,y),n.Fv(I,I);let M=n.Ue();for(let e=0;e<d;e++){let t=Math.cos(e/d*2*Math.PI),i=Math.sin(e/d*2*Math.PI);M[0]=b*(t*y[0]+i*I[0]),M[1]=b*(t*y[1]+i*I[1]),M[2]=b*(t*y[2]+i*I[2]),n.IH(M,r(p),M);let s=u*m;A[s+0]=M[0],A[s+1]=M[1],A[s+2]=M[2];let a=n.Ue();n.$X(a,M,r(p)),n.Fv(a,a);let l=(s+3)*4;g[l+0]=127*a[0],g[l+1]=127*a[1],g[l+2]=127*a[2],A[s+4]=p[3],u++}f=o.d9(p),p=o.d9(v),l&&(C=0)}let y=(l-h)*d*6,I=new Uint32Array(y),M=0;u=0;for(let e=1;e<a;e++){if(i[e]===s){u+=d;continue}if(i[e-1]===s)continue;let t=u,r=u+d,a=r,l=r+d;for(let e=0;e<d;e++)I[M++]=t,I[M++]=r++,r===l&&(r=l-d),I[M++]=r,I[M++]=t++,t===a&&(t=a-d),I[M++]=r,I[M++]=t;u+=d}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(I),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,g,e.STATIC_DRAW),this.indexCount=y}createFiberDensityMap(){if(this.fiberDensity)return;let e=this.pts,t=e.length/3,i=0;for(let e=0;e<3;e++)i=Math.max(i,this.extentsMax[e]-this.extentsMin[e]);if(this.fiberDensity=new Float32Array(t),0===i)return;let r=i/63/2,s=63/i,a=new Float32Array(262144),l=[this.extentsMin[0]-r,this.extentsMin[1]-r,this.extentsMin[2]-r],o=[0,0,0],n=4096,h=0;for(let i=0;i<t;i++){o[0]=Math.round((e[h++]-l[0])*s),o[1]=Math.round((e[h++]-l[1])*s),o[2]=Math.round((e[h++]-l[2])*s);let t=o[0]+64*o[1]+o[2]*n;if(-1!==t)a[t]++}function d(e,t){let i=e.slice(),r=-1,s=t-1;for(let a=0;a<t;a++)for(let a=0;a<t;a++)for(let a=0;a<t;a++){if(r++,!(a<1)&&!(a>=s))e[r]=i[r-1]+i[r]+i[r]+i[r+1]}r=-1,i=e.slice();for(let a=0;a<t;a++)for(let a=0;a<t;a++)for(let l=0;l<t;l++){if(r++,!(a<1)&&!(a>=s))e[r]=i[r-t]+i[r]+i[r]+i[r+t]}let a=t*t;r=-1,i=e.slice();for(let l=0;l<t;l++)for(let o=0;o<t;o++)for(let o=0;o<t;o++){if(r++,!(l<1)&&!(l>=s))e[r]=i[r-a]+i[r]+i[r]+i[a]}return e}a=d(a,64),a=d(a,64);let c=0,m=1/0,A=262144;for(let e=0;e<A;e++){if(!(a[e]<=0))c=Math.max(c,a[e]),m=Math.min(m,a[e])}if(!(c<=1)&&!(c<=m)){h=0;for(let e=0;e<A;e++)a[e]=Math.max(0,a[e]-m);c-=m;for(let i=0;i<t;i++){o[0]=Math.round((e[h++]-l[0])*s),o[1]=Math.round((e[h++]-l[1])*s),o[2]=Math.round((e[h++]-l[2])*s);let t=o[0]+64*o[1]+o[2]*n;this.fiberDensity[i]=a[t]/c}}}updateFibers(e){if(!this.offsetPt0||!this.fiberLength)return;let t=this.pts,i=this.offsetPt0,r=i.length-1,s=t.length/3;if(!this.fiberLengths){this.fiberLengths=new Uint32Array(r);for(let e=0;e<r;e++){let r=3*i[e],s=(i[e+1]-1)*3,a=0;for(let e=r;e<s;e+=3){let i=n.al(t[e+0]-t[e+3],t[e+1]-t[e+4],t[e+2]-t[e+5]);a+=n.Zh(i)}this.fiberLengths[e]=a}}let a=new Float32Array(4*s),l=new Uint32Array(a.buffer),o=0,h=0;for(let e=0;e<s;e++)a[h+0]=t[o+0],a[h+1]=t[o+1],a[h+2]=t[o+2],o+=3,h+=4;let d=this.fiberDither,c=.5*d;function m(e,t,i){let r=255*(d*Math.random()-c);return(e=Math.max(Math.min(e+r,255),0))+((t=Math.max(Math.min(t+r,255),0))<<8)+((i=Math.max(Math.min(i+r,255),0))<<16)}function A(e,t,i,r,s,a,l){let o=n.al(Math.abs(e-r),Math.abs(t-s),Math.abs(i-a));n.Fv(o,o);let h=l-c;for(let e=0;e<3;e++)o[e]=255*Math.max(Math.min(Math.abs(o[e])+h,1),0);return o[0]+(o[1]<<8)+(o[2]<<16)}let g=this.fiberColor.toLowerCase(),u=null,f=null;if(g.startsWith("dps")&&this.dps&&this.dps.length>0){let e=parseInt(g.substring(3));e<this.dps.length&&this.dps[e].vals.length===r&&(u=this.dps[e].vals)}if(g.startsWith("dpv")&&this.dpv&&this.dpv.length>0){let e=parseInt(g.substring(3));e<this.dpv.length&&this.dpv[e].vals.length===s&&(f=this.dpv[e])}let p=new Int16Array(r);if(this.dpg&&null!==this.fiberGroupColormap){let e=new Uint8ClampedArray(4*this.dpg.length),t=Array(this.dpg.length).fill(!1),s=this.fiberGroupColormap;void 0===s.A&&(s.A=Array.from(new Uint8ClampedArray(s.I.length).fill(255)));for(let i=0;i<s.I.length;i++){let r=s.I[i];if(!(r<0)&&!(r>=this.dpg.length)&&!(s.A[i]<1))t[r]=!0,e[r*=4]=s.R[i],e[r+1]=s.G[i],e[r+2]=s.B[i],e[r+3]=255}p.fill(-1);for(let e=0;e<this.dpg.length;e++){if(!!t[e])for(let t=0;t<this.dpg[e].vals.length;t++)p[this.dpg[e].vals[t]]=e}for(let t=0;t<r;t++){if(p[t]<0)continue;let r=p[t]%256*4,s=m(e[r],e[r+1],e[r+2]),a=i[t],o=i[t+1]-1,n=4*a+3,h=4*o+3;for(let e=n;e<=h;e+=4)l[e]=s}}else if(f){let e=tG.colormap(this.colormap,this.colormapInvert),t=f.cal_min,i=f.cal_max,r=3;for(let a=0;a<s;a++){let s=Math.min(Math.max((f.vals[a]-t)/(i-t),0),1),o=e[s=4*Math.round(Math.max(Math.min(255,255*s)))]+(e[s+1]<<8)+(e[s+2]<<16);l[r]=o,r+=4}}else if(u){let e=tG.colormap(this.colormap,this.colormapInvert),t=u[0],s=u[0];for(let e=0;e<r;e++)t=Math.min(t,u[e]),s=Math.max(s,u[e]);s===t&&(t-=1);for(let a=0;a<r;a++){let r=(u[a]-t)/(s-t),o=e[r=4*Math.round(Math.max(Math.min(255,255*r)))]+(e[r+1]<<8)+(e[r+2]<<16),n=i[a],h=i[a+1]-1,d=4*n+3,c=4*h+3;for(let e=d;e<=c;e+=4)l[e]=o}}else if(g.includes("fixed")){if(0===d){let e=this.rgba255[0]+(this.rgba255[1]<<8)+(this.rgba255[2]<<16),t=3;for(let i=0;i<s;i++)l[t]=e,t+=4}else for(let e=0;e<r;e++){let t=m(this.rgba255[0],this.rgba255[1],this.rgba255[2]),r=i[e],s=i[e+1]-1,a=4*r+3,o=4*s+3;for(let e=a;e<=o;e+=4)l[e]=t}}else if(g.includes("local"))for(let e=0;e<r;e++){let r=i[e],s=i[e+1]-1,a=3*r,o=3*s,n=d*Math.random(),h=A(t[a],t[a+1],t[a+2],t[a+4],t[a+5],t[a+6],n),c=4*r+3;for(;a<o;)l[c]=h,c+=4,a+=3,h=A(t[a-3],t[a-2],t[a-1],t[a+3],t[a+4],t[a+5],n);l[c]=l[c-4]}else for(let e=0;e<r;e++){let r=i[e],s=i[e+1]-1,a=3*r,o=3*s,n=A(t[a],t[a+1],t[a+2],t[o],t[o+1],t[o+2],d*Math.random()),h=4*r+3,c=4*s+3;for(let e=h;e<=c;e+=4)l[e]=n}if(this.fiberOcclusion>0){this.createFiberDensityMap();for(let e=0;e<r;e++){let t=i[e],r=i[e+1]-1,s=4*t+3,a=4*r+3,o=t,n=Math.min(this.fiberOcclusion,.99);for(let e=s;e<=a;e+=4){var v,x;let t=this.fiberDensity[o++];if(t<=0)continue;let i=1-Math.min(t/=(1/n-2)*(1-t)+1,.9),r=l[e];v=r,r=(x=i)*(255&v)+(x*(v>>8&255)<<8)+(x*(v>>16&255)<<16),l[e]=r}}}let w=this.fiberLength,C=0xffffffff,b=[],y=-1;for(let e=0;e<r;e++){if(!(p[e]<0)&&!(this.fiberLengths[e]<w)&&++y%this.fiberDecimationStride==0){for(let t=i[e];t<i[e+1];t++)b.push(t);b.push(C)}}this.fiberSides>2&&this.fiberRadius>0?this.linesToCylinders(e,a,b):(this.indexCount=b.length,e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Uint32Array.from(l),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(b),e.STATIC_DRAW))}indexNearestXYZmm(e,t,i){let r=this.pts,s=this.pts.length/3,a=0,l=1/0,o=0;for(let n=0;n<s;n++){let s=Math.pow(r[a]-e,2)+Math.pow(r[a+1]-t,2)+Math.pow(r[a+2]-i,2);s<l&&(l=s,o=n),a+=3}return[o,l=Math.sqrt(l)]}unloadMesh(e){if(e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindVertexArray(null),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteVertexArray(this.vao),e.deleteVertexArray(this.vaoFiber),this.offsetPt0=null,this.tris=null,this.pts=null,this.layers&&this.layers.length>0)for(let e=0;e<this.layers.length;e++)this.layers[e].values=null;if(this.dpg&&this.dpg.length>0)for(let e=0;e<this.dpg.length;e++)this.dpg[e].vals=null;if(this.dps&&this.dps.length>0)for(let e=0;e<this.dps.length;e++)this.dps[e].vals=null}updateMesh(e){if(this.offsetPt0){this.updateFibers(e);return}if(this.hasConnectome)return;if(!this.pts||!this.tris||!this.rgba255){I.warn("underspecified mesh");return}function t(e,t,i){return e*(1-i)+t*i}function i(e,t){return Math.min(e+t,255)}let r=this.generatePosNormClr(this.pts,this.tris,this.rgba255),s=this.pts.length/3,a=new Uint8Array(r.buffer),l=0,o=new Uint8Array(4*s);if(this.layers&&this.layers.length>0)for(let e=0;e<this.layers.length;e++){let r=this.layers[e],n=r.opacity;if(n<=0||r.cal_min>r.cal_max)continue;if(void 0===r.outlineBorder&&(r.outlineBorder=0),void 0===r.isAdditiveBlend&&(r.isAdditiveBlend=!1),r.colormapLabel&&r.colormapLabel.R&&!r.colormapLabel.lut&&(r.colormapLabel=tG.makeLabelLut(r.colormapLabel)),r.colormapLabel&&r.colormapLabel.lut){let e=r.colormapLabel.lut,i=Math.floor(e.length/4),l=s*Math.min(Math.max(r.frame4D,0),r.nFrame4D-1),o=new Uint8Array(4*s),h=0;for(let t=0;t<r.values.length;t++){let s=4*Math.min(Math.max(r.values[t+l],0),i-1);o[h+0]=e[s+0],o[h+1]=e[s+1],o[h+2]=e[s+2],h+=4}let d=Array(s).fill(!1);r.outlineBorder>0&&(d=tK.getClusterBoundary(o,this.tris)),h=0;for(let e=0;e<r.values.length;e++){let i=n;d[e]&&(i=r.outlineBorder);let s=28*e+24;7!==this.f32PerVertex&&(s=20*e+16),a[s+0]=t(a[s+0],o[h+0],i),a[s+1]=t(a[s+1],o[h+1],i),a[s+2]=t(a[s+2],o[h+2],i),h+=4}continue}if(r.values instanceof Uint8Array){let e=new Uint8Array(r.values.buffer),i=Array(s).fill(!0);r.outlineBorder>0&&(i=tK.getClusterBoundary(e,this.tris));let l=0;for(let s=0;s<r.values.length;s++){let o=28*s+24;7!==this.f32PerVertex&&(o=20*s+16);let h=n;i[s]&&(h=r.outlineBorder),a[o+0]=t(a[o+0],e[l+0],h),a[o+1]=t(a[o+1],e[l+1],h),a[o+2]=t(a[o+2],e[l+2],h),l+=4}continue}let h=tG.colormap(r.colormap,r.colormapInvert),d=s*Math.min(Math.max(r.frame4D,0),r.nFrame4D-1);r.isAdditiveBlend&&(l=Math.max(l,n)),r.useNegativeCmap&&(r.cal_min=Math.max(0,r.cal_min),r.cal_max=Math.max(r.cal_min+1e-6,r.cal_max)),void 0===r.isTransparentBelowCalMin&&(r.isTransparentBelowCalMin=!0);let c=r.cal_min;r.alphaThreshold&&(c=Math.min(c,0));let m=255/(r.cal_max-c),A=r.cal_min;if(!r.isTransparentBelowCalMin&&(A=Number.NEGATIVE_INFINITY),r.outlineBorder<=0)for(let e=0;e<s;e++){let s=r.values[e+d];if(s<A)continue;let l=Math.round((s-c)*m);if(l<0&&r.isTransparentBelowCalMin)continue;l=4*Math.min(255,l=Math.max(0,l));let g=28*e+24;if(7!==this.f32PerVertex&&(g=20*e+16),r.isAdditiveBlend){let t=4*e;o[t+0]=i(o[t+0],h[l+0]),o[t+1]=i(o[t+1],h[l+1]),o[t+2]=i(o[t+2],h[l+2]),o[t+3]=i(o[t+3],255)}else a[g+0]=t(a[g+0],h[l+0],n),a[g+1]=t(a[g+1],h[l+1],n),a[g+2]=t(a[g+2],h[l+2],n)}else{let e=new Uint8Array(s);for(let t=0;t<s;t++){let i=Math.round((r.values[t+d]-r.cal_min)*m);if(!(i<0))i=Math.min(255,i),e[t]=i}let i=tK.getClusterBoundaryU8(e,this.tris);for(let l=0;l<s;l++){if(e[l]<1)continue;let s=n;i[l]&&(s=r.outlineBorder);let o=4*e[l],d=28*l+24;7!==this.f32PerVertex&&(d=20*l+16),a[d+0]=t(a[d+0],h[o+0],s),a[d+1]=t(a[d+1],h[o+1],s),a[d+2]=t(a[d+2],h[o+2],s)}}if(r.useNegativeCmap){let e=tG.colormap(r.colormapNegative,r.colormapInvert);if(r.outlineBorder<=0){let l=r.cal_min,h=r.cal_max;isFinite(r.cal_minNeg)&&isFinite(r.cal_minNeg)&&(l=-r.cal_minNeg,h=-r.cal_maxNeg),h<l&&([l,h]=[h,l]);let c=l;0===c&&(c=Number.EPSILON),r.alphaThreshold&&(l=0);let m=255/(h-l);for(let h=0;h<s;h++){let s=-r.values[h+d];if(s<c)continue;let A=Math.round((s-l)*m);if(A<0)continue;A=4*Math.min(255,A);let g=28*h+24;if(7!==this.f32PerVertex&&(g=20*h+16),r.isAdditiveBlend){let t=4*h;o[t+0]=i(o[t+0],e[A+0]),o[t+1]=i(o[t+1],e[A+1]),o[t+2]=i(o[t+2],e[A+2]),o[t+3]=i(o[t+3],255)}else a[g+0]=t(a[g+0],e[A+0],n),a[g+1]=t(a[g+1],e[A+1],n),a[g+2]=t(a[g+2],e[A+2],n)}}else{let i=new Uint8Array(s);for(let e=0;e<s;e++){let t=Math.round((-r.values[e+d]-r.cal_min)*m);if(!(t<0))i[e]=Math.min(255,t)}let l=tK.getClusterBoundaryU8(i,this.tris);for(let i=0;i<s;i++){let s=255,o=n;l[i]&&(o=r.outlineBorder),s=4*Math.min(255,s);let h=28*i+24;7!==this.f32PerVertex&&(h=20*i+16),a[h+0]=t(a[h+0],e[s+0],o),a[h+1]=t(a[h+1],e[s+1],o),a[h+2]=t(a[h+2],e[s+2],o)}}}}if(l>0)for(let e=0;e<s;e++){let i=function(e,t){return Math.min(e*t*(1/255),255)},r=28*e+24;7!==this.f32PerVertex&&(r=20*e+16);let s=4*e,n=Math.min(l,o[s+3]/255);if(!(n<=0))a[r+0]=i(a[r+0],o[s+0]),a[r+1]=i(a[r+1],o[s+1]),a[r+2]=i(a[r+2],o[s+2]),a[r+0]=t(a[r+0],o[s+0],n),a[r+1]=t(a[r+1],o[s+1],n),a[r+2]=t(a[r+2],o[s+2],n)}e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(this.tris),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),this.indexCount=this.tris.length,this.vertexCount=this.pts.length}reverseFaces(e){if(this.offsetPt0||this.hasConnectome)return;let t=this.tris||[];for(let e=0;e<t.length;e+=3){let i=t[e];t[e]=t[e+1],t[e+1]=i}this.updateMesh(e)}hierarchicalOrder(){let e=this.tris.length/3,t=Math.log(e/20)/Math.log(4);if(e!==20*Math.pow(4,t)||this.pts.length/3!=10*Math.pow(4,t)+2)return NaN;for(let e=0;e<15;e+=3)if(0!==this.tris[e])return NaN;for(let e=15;e<24;e+=3)if(3!==this.tris[e])return NaN;for(let e=24;e<30;e+=3)if(4!==this.tris[e])return NaN;return t}decimateFaces(e,t){let i=this.tris;for(let r=e-1;r>=t;r--){let e=10*Math.pow(4,r+1)+2,t=10*Math.pow(4,r)+2,s=i.length/3,a=20*Math.pow(4,r);console.log(`order ${r+1} -> ${r} vertices ${e} -> ${t} faces ${s} -> ${a}`);let l=Array.from({length:e},(e,t)=>t+1);for(let e=0;e<s;e++){let t=i[3*e],r=i[3*e+1],s=i[3*e+2];l[t-1]=Math.min(l[t-1],r,s)}let o=new Uint32Array(3*a);for(let e=0;e<a;e++)o[3*e]=l[i[3*e]-1],o[3*e+1]=l[i[3*e+1]-1],o[3*e+2]=l[i[3*e+2]-1];i=o}this.tris=new Uint32Array(i)}decimateHierarchicalMesh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=this.hierarchicalOrder();if(isNaN(i))return I.warn("Unable to decimate mesh: it does not have a hierarchical structure"),!1;if(t>=i)return I.warn(`Unable to decimate mesh: input order (${i}) must be larger than downsampled order (${t})`),!1;let r=this.pts.length/3,s=10*Math.pow(4,t)+2;if(this.pts=new Float32Array(this.pts.slice(0,3*s)),this.decimateFaces(i,t),this.layers&&this.layers.length>0)for(let e=0;e<this.layers.length;e++){let t=this.layers[e];t.values instanceof Float32Array||t.values.length!==r?t.values=new Float32Array(t.values.slice(0,s)):I.warn("decimation logic needs to be updated")}return this.updateMesh(e),!0}async setLayerProperty(e,t,i,r){let s=this.layers[e];if(!s||!(t in s)){I.warn("mesh does not have property ",t," for layer ",s);return}if("colormapLabel"===t){if("object"==typeof i)s[t]=tG.makeLabelLut(i);else if("string"==typeof i){let e=await tG.makeLabelLutFromUrl(i);s[t]=e,this.updateMesh(r);return}else I.error("colormapLabel requires a string or object")}else s[t]=i;this.updateMesh(r)}setProperty(e,t,i){if(!(e in this)){I.warn("mesh does not have property ",e,this);return}this[e]=t,this.updateMesh(i)}generatePosNormClr(e,t,i){(e.length<3||i.length<4)&&(I.error("Catastrophic failure generatePosNormClr()"),I.debug("this",this),I.debug("pts",e),I.debug("rgba",i));let r=tK.generateNormals(e,t),s=e.length/3,a=s===i.length/4,l=this.f32PerVertex,o=new Float32Array(s*l),n=new Uint8Array(o.buffer),h=0,d=0,c=0,m=(l-1)*4;for(let t=0;t<s;t++)o[c+0]=e[h+0],o[c+1]=e[h+1],o[c+2]=e[h+2],7!==l?(n[m-4]=127*r[h+0],n[m-3]=127*r[h+1],n[m-2]=127*r[h+2]):(o[c+3]=r[h+0],o[c+4]=r[h+1],o[c+5]=r[h+2]),n[m]=i[d+0],n[m+1]=i[d+1],n[m+2]=i[d+2],n[m+3]=i[d+3],a&&(d+=4),h+=3,c+=l,m+=4*l;return o}static readMesh(t,i,r){let s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Uint8Array([255,255,255,255]),o=!(arguments.length>5)||void 0===arguments[5]||arguments[5],n=new Uint32Array([]),h=new Float32Array([]),d="",c=/(?:\.([^.]+))?$/,m=c.exec(i)[1];if("GZ"===(m=m.toUpperCase())&&(m=(m=c.exec(i.slice(0,-3))[1]).toUpperCase()),"JCON"===m&&I.error("you should never see this message: load using nvconnectome not nvmesh"),"JSON"===m&&I.error("you should never see this message: load using nvconnectome not nvmesh"),l[3]=Math.max(1,l[3]),"TCK"===m||"TRK"===m||"TT"===m||"TRX"===m||"TRACT"===m){if(void 0===(s="TCK"===m?tH.readTCK(t):"TRACT"===m?tH.readTRACT(t):"TT"===m?tH.readTT(t):"TRX"===m?tH.readTRX(t):tH.readTRK(t))){let e=new Float32Array([0,0,0,0,0,0]);s={pts:e,offsetPt0:new Uint32Array([0])},I.error("Creating empty tracts")}return l[3]=0,new e(s.pts,s.offsetPt0,i,l,a,o,r,"inferno",s.dpg||null,s.dps||null,s.dpv||null)}if("GII"===m)s=tH.readGII(t);else if("MZ3"===m)((s=tH.readMZ3(t))instanceof Float32Array||null===s.positions)&&I.warn("MZ3 does not have positions (statistical overlay?)");else if("ASC"===m)s=tH.readASC(t);else if("DFS"===m)s=tH.readDFS(t);else if("BYU"===m||"G"===m)s=tH.readGEO(t);else if("GEO"===m)s=tH.readGEO(t,!0);else if("ICO"===m||"TRI"===m)s=tH.readICO(t);else if("OFF"===m)s=tH.readOFF(t);else if("NV"===m)s=tH.readNV(t);else if("OBJ"===m)s=tH.readOBJ(t);else if("PLY"===m)s=tH.readPLY(t);else if("X3D"===m)s=tH.readX3D(t);else if("FIB"===m||"VTK"===m){if("offsetPt0"in(s=tH.readVTK(t)))return l[3]=0,new e(s.pts,s.offsetPt0,i,l,a,o,r,"inferno")}else s="SRF"===m?tH.readSRF(t):"STL"===m?tH.readSTL(t):tH.readFreeSurfer(t);if(s.anatomicalStructurePrimary&&(d=s.anatomicalStructurePrimary),s instanceof Float32Array)throw Error("fatal: unknown mesh type loaded");if(!s.positions)throw Error("positions not loaded");if(!s.indices)throw Error("indices not loaded");if(h=s.positions,n=s.indices,"rgba255"in s&&s.rgba255.length>0&&(l=s.rgba255),"colors"in s&&s.colors&&s.colors.length===h.length){let e=h.length/3;l=new Uint8Array(4*e);let t=0,i=0;for(let r=0;r<e;r++)l[i++]=255*s.colors[t],l[i++]=255*s.colors[t+1],l[i++]=255*s.colors[t+2],l[i++]=255,t+=3}let A=h.length/3;if(n.length/3<1||A<3)throw Error("Mesh should have at least one triangle and three vertices");l[3]=Math.max(1,l[3]);let g=new e(h,n,i,l,a,o,r,null,null,null,null,!0,d);if("scalars"in s&&s.scalars.length>0){let e=tH.readLayer(i,t,g,a,"gray");void 0===e?I.warn("readLayer() failed to convert scalars"):(g.layers.push(e),g.updateMesh(r))}return g}static async loadLayer(e,t){let i,r;if(void 0!==e.base64)i=function(e){let t=window.atob(e),i=t.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=t.charCodeAt(e);return r.buffer}(e.base64);else{if(!e.url)throw Error("layer: missing url");let t=await fetch(e.url,{headers:e.headers});if(!t.ok)throw Error(t.statusText);i=await t.arrayBuffer()}let s=[];if(e.name&&""!==e.name)r=e.name;else{if(!e.url)throw Error("layer: missing url");try{s=new URL(e.url).pathname.split("/")}catch(t){s=e.url.split("/")}finally{r=s.slice(-1)[0]}}r.indexOf("?")>-1&&(r=r.slice(0,r.indexOf("?")));let a=.5;"opacity"in e&&(a=e.opacity);let l="warm";"colormap"in e&&(l=e.colormap);let o="winter";"colormapNegative"in e&&(o=e.colormapNegative);let n=!1;"useNegativeCmap"in e&&(n=e.useNegativeCmap);let h=null;"cal_min"in e&&(h=e.cal_min);let d=null;"cal_max"in e&&(d=e.cal_max);let c=tH.readLayer(r,i,t,a,l,o,n,h,d);c&&t.layers.push(c)}static async loadFromUrl(){let t,{url:i="",headers:r={},gl:s,name:a="",opacity:l=1,rgba255:o=[255,255,255,255],visible:n=!0,layers:h=[],buffer:d=new ArrayBuffer(0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=i.split("/");if(""===a){try{c=new URL(i).pathname.split("/")}catch(e){c=i.split("/")}(a=c.slice(-1)[0]).indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}if(""===i)throw Error("url must not be empty");if(!s)throw Error("gl context is null");if(d.byteLength>0)t=d;else{let e=await fetch(i,{headers:r});if(!e.ok)throw Error(e.statusText);t=await e.arrayBuffer()}let m=await this.readMesh(t,a,s,l,new Uint8Array(o),n);if(!h||h.length<1)return m;for(let t=0;t<h.length;t++)await e.loadLayer(h[t],m);return m.updateMesh(s),m}static async readFileAsync(e){return new Promise((t,i)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=i,r.readAsArrayBuffer(e)})}static async loadFromFile(){let{file:t,gl:i,name:r="",opacity:s=1,rgba255:a=[255,255,255,255],visible:l=!0,layers:o=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t)throw Error("file must be set");if(!i)throw Error("rendering context must be set");let n=await e.readFileAsync(t),h=e.readMesh(n,r,i,s,new Uint8Array(a),l);if(!o||o.length<1)return h;for(let t=0;t<o.length;t++)await e.loadLayer(o[t],h);return h.updateMesh(i),h}async loadFromBase64(){let{base64:t,gl:i,name:r="",opacity:s=1,rgba255:a=[255,255,255,255],visible:l=!0,layers:o=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t)throw Error("base64 must bet set");if(!i)throw Error("rendering context must be set");let n=function(e){let t=window.atob(e),i=t.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=t.charCodeAt(e);return r.buffer}(t),h=await e.readMesh(n,r,i,s,new Uint8Array(a),l);if(!o||o.length<1)return h;for(let t=0;t<o.length;t++)await e.loadLayer(o[t],h);return h.updateMesh(i),h}static readGII(e){return tH.readGII(e)}static readX3D(e){return tH.readX3D(e)}static readNII(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tH.readNII(e,t)}static readNII2(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tH.readNII2(e,t)}static readMGH(e){return tH.readMGH(e)}static readSTL(e){return tH.readSTL(e)}static readTxtSTL(e){return tH.readTxtSTL(e)}static readSRF(e){return tH.readSRF(e)}static readFreeSurfer(e){return tH.readFreeSurfer(e)}static readOBJ(e){return tH.readOBJ(e)}static readOFF(e){return tH.readOFF(e)}static readGEO(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return tH.readGEO(e,t)}static readICO(e){return tH.readICO(e)}static readPLY(e){return tH.readPLY(e)}static readMZ3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return tH.readMZ3(e,t)}static readVTK(e){return tH.readVTK(e)}static readASC(e){return tH.readASC(e)}static readNV(e){return tH.readNV(e)}static readANNOT(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tH.readANNOT(e,t,i)}static readCURV(e,t){return tH.readCURV(e,t)}static readSTC(e,t){return tH.readSTC(e,t)}static readSMP(e,t){return tH.readSMP(e,t)}static readTxtVTK(e){return tH.readTxtVTK(e)}static readTRK(e){return tH.readTRK(e)}static readTCK(e){return tH.readTCK(e)}static readTSF(e){return tH.readTSF(e)}static readTT(e){return tH.readTT(e)}static readTRX(e){return tH.readTRX(e)}static readTRACT(e){return tH.readTRACT(e)}},tX="data:image/png;base64,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",tq={atlas:{type:"msdf",distanceRange:2,size:59.65625,width:512,height:256,yOrigin:"bottom"},metrics:{emSize:1,lineHeight:1.171875,ascender:.927734375,descender:-.244140625,underlineY:-.09765625,underlineThickness:.048828125},glyphs:[{unicode:32,advance:.24755859375},{unicode:33,advance:.25732421875,planeBounds:{left:.056159633438645884,bottom:-.02437761405677056,right:.20702396031135412,top:.7299440203067705},atlasBounds:{left:488.5,bottom:145.5,right:497.5,top:190.5}},{unicode:34,advance:.31982421875,planeBounds:{left:.049409125974004715,bottom:.48691155587022,right:.2840869677759953,top:.77187750662978},atlasBounds:{left:486.5,bottom:213.5,right:500.5,top:230.5}},{unicode:35,advance:.61572265625,planeBounds:{left:.037219103997511785,bottom:-.02169206718177056,right:.6239137085024882,top:.7326295671817705},atlasBounds:{left:66.5,bottom:51.5,right:101.5,top:96.5}},{unicode:36,advance:.5615234375,planeBounds:{left:.02956531458715296,bottom:-.12381369908983761,right:.5324464041628472,top:.8484230740898377},atlasBounds:{left:109.5,bottom:197.5,right:139.5,top:255.5}},{unicode:37,advance:.732421875,planeBounds:{left:.026481776289942378,bottom:-.030073418674698794,right:.7137525987100576,top:.7410109186746989},atlasBounds:{left:88.5,bottom:144.5,right:129.5,top:190.5}},{unicode:38,advance:.62158203125,planeBounds:{left:.03225572125458355,bottom:-.030073418674698794,right:.6357130287454166,top:.7410109186746989},atlasBounds:{left:130.5,bottom:144.5,right:166.5,top:190.5}},{unicode:39,advance:.17431640625,planeBounds:{left:.028244602049502358,bottom:.49895501673814824,right:.14558352295049765,top:.7671582645118518},atlasBounds:{left:498.5,bottom:62.5,right:505.5,top:78.5}},{unicode:40,advance:.341796875,planeBounds:{left:.042983329377291775,bottom:-.250029542422407,right:.34471198312270823,top:.8227834486724072},atlasBounds:{left:.5,bottom:191.5,right:18.5,top:255.5}},{unicode:41,advance:.34765625,planeBounds:{left:-.003159248747708225,bottom:-.250029542422407,right:.29856940499770823,top:.8227834486724072},atlasBounds:{left:19.5,bottom:191.5,right:37.5,top:255.5}},{unicode:42,advance:.4306640625,planeBounds:{left:-.011208599684062338,bottom:.27785390031593765,right:.44138438093406235,top:.7304468809340623},atlasBounds:{left:449.5,bottom:23.5,right:476.5,top:50.5}},{unicode:43,advance:.56689453125,planeBounds:{left:.01353503347629649,bottom:.053493525733368255,right:.5499415290237036,top:.6066627242666317},atlasBounds:{left:361.5,bottom:17.5,right:393.5,top:50.5}},{unicode:44,advance:.1962890625,planeBounds:{left:-.009919475797210583,bottom:-.15981695975478,right:.1744702570472106,top:.12514899100478},atlasBounds:{left:498.5,bottom:79.5,right:509.5,top:96.5}},{unicode:45,advance:.27587890625,planeBounds:{left:-.00527594412977999,bottom:.24333249267450235,right:.27969000662978,top:.36067141357549765},atlasBounds:{left:52.5,bottom:7.5,right:69.5,top:14.5}},{unicode:46,advance:.26318359375,planeBounds:{left:.051032680313645884,bottom:-.027092319686354116,right:.20189700718635412,top:.12377200718635412},atlasBounds:{left:501.5,bottom:221.5,right:510.5,top:230.5}},{unicode:47,advance:.412109375,planeBounds:{left:-.013733006073205867,bottom:-.08573505127848349,right:.4053345685732059,top:.7356373950284835},atlasBounds:{left:252.5,bottom:206.5,right:277.5,top:255.5}},{unicode:48,advance:.5615234375,planeBounds:{left:.037458384830081196,bottom:-.030073418674698794,right:.5235767714199189,top:.7410109186746989},atlasBounds:{left:167.5,bottom:144.5,right:196.5,top:190.5}},{unicode:49,advance:.5615234375,planeBounds:{left:.06023674350936354,bottom:-.01998308280677056,right:.37872810024063647,top:.7343385515567705},atlasBounds:{left:488.5,bottom:97.5,right:507.5,top:142.5}},{unicode:50,advance:.5615234375,planeBounds:{left:.025334353719224725,bottom:-.01680925468177056,right:.5449781462807752,top:.7375123796817705},atlasBounds:{left:278.5,bottom:51.5,right:309.5,top:96.5}},{unicode:51,advance:.5615234375,planeBounds:{left:.028181041080081196,bottom:-.030073418674698794,right:.5142994276699189,top:.7410109186746989},atlasBounds:{left:197.5,bottom:144.5,right:226.5,top:190.5}},{unicode:52,advance:.5615234375,planeBounds:{left:.005886103858368255,bottom:-.02169206718177056,right:.5590553023916317,top:.7326295671817705},atlasBounds:{left:310.5,bottom:51.5,right:343.5,top:96.5}},{unicode:53,advance:.5615234375,planeBounds:{left:.055524791080081196,bottom:-.02657487968177056,right:.5416431776699189,top:.7277467546817705},atlasBounds:{left:344.5,bottom:51.5,right:373.5,top:96.5}},{unicode:54,advance:.5615234375,planeBounds:{left:.046003306705081196,bottom:-.034712090549698794,right:.5321216932949189,top:.7363722467996989},atlasBounds:{left:227.5,bottom:144.5,right:256.5,top:190.5}},{unicode:55,advance:.5615234375,planeBounds:{left:.018010134969224725,bottom:-.02169206718177056,right:.5376539275307752,top:.7326295671817705},atlasBounds:{left:374.5,bottom:51.5,right:405.5,top:96.5}},{unicode:56,advance:.5615234375,planeBounds:{left:.037702525455081196,bottom:-.030073418674698794,right:.5238209120449189,top:.7410109186746989},atlasBounds:{left:257.5,bottom:144.5,right:286.5,top:190.5}},{unicode:57,advance:.5615234375,planeBounds:{left:.029401744205081196,bottom:-.025434746799698794,right:.5155201307949189,top:.7456495905496989},atlasBounds:{left:287.5,bottom:144.5,right:316.5,top:190.5}},{unicode:58,advance:.2421875,planeBounds:{left:.046394008438645884,bottom:-.029431286627488215,right:.19725833531135412,top:.5572633178774882},atlasBounds:{left:439.5,bottom:61.5,right:448.5,top:96.5}},{unicode:59,advance:.21142578125,planeBounds:{left:.001066852327789419,bottom:-.16459733294591408,right:.1854565851722106,top:.556198895445914},atlasBounds:{left:406.5,bottom:53.5,right:417.5,top:96.5}},{unicode:60,advance:.50830078125,planeBounds:{left:.016948142433865897,bottom:.0726146348300812,right:.4527784200661341,top:.5587330214199189},atlasBounds:{left:394.5,bottom:21.5,right:420.5,top:50.5}},{unicode:61,advance:.548828125,planeBounds:{left:.051535540940937666,bottom:.17620354038436353,right:.5041285215590624,top:.49469489711563647},atlasBounds:{left:477.5,bottom:31.5,right:504.5,top:50.5}},{unicode:62,advance:.5224609375,planeBounds:{left:.047629290940937666,bottom:.0731029160800812,right:.5002222715590624,top:.5592213026699189},atlasBounds:{left:421.5,bottom:21.5,right:448.5,top:50.5}},{unicode:63,advance:.47216796875,planeBounds:{left:.016704001808865897,bottom:-.027876153049698794,right:.4525342794411341,top:.7432081842996989},atlasBounds:{left:317.5,bottom:144.5,right:343.5,top:190.5}},{unicode:64,advance:.89794921875,planeBounds:{left:.034064457306783605,bottom:-.23896750384690937,right:.8721996065996072,top:.7165065663469093},atlasBounds:{left:155.5,bottom:198.5,right:205.5,top:255.5}},{unicode:65,advance:.65234375,planeBounds:{left:-.008838044092129387,bottom:-.02169206718177056,right:.6616700753421295,top:.7326295671817705},atlasBounds:{left:237.5,bottom:51.5,right:277.5,top:96.5}},{unicode:66,advance:.62255859375,planeBounds:{left:.06464099434422473,bottom:-.02169206718177056,right:.5842847869057752,top:.7326295671817705},atlasBounds:{left:205.5,bottom:51.5,right:236.5,top:96.5}},{unicode:67,advance:.65087890625,planeBounds:{left:.038439807122511785,bottom:-.030073418674698794,right:.6251344116274882,top:.7410109186746989},atlasBounds:{left:344.5,bottom:144.5,right:379.5,top:190.5}},{unicode:68,advance:.65576171875,planeBounds:{left:.06301501010836826,bottom:-.02169206718177056,right:.6161842086416317,top:.7326295671817705},atlasBounds:{left:162.5,bottom:51.5,right:195.5,top:96.5}},{unicode:69,advance:.568359375,planeBounds:{left:.0652904160800812,bottom:-.02169206718177056,right:.5514088026699189,top:.7326295671817705},atlasBounds:{left:132.5,bottom:51.5,right:161.5,top:96.5}},{unicode:70,advance:.552734375,planeBounds:{left:.059675181705081196,bottom:-.02169206718177056,right:.5457935682949189,top:.7326295671817705},atlasBounds:{left:102.5,bottom:51.5,right:131.5,top:96.5}},{unicode:71,advance:.68115234375,planeBounds:{left:.040148791497511785,bottom:-.030073418674698794,right:.6268433960024882,top:.7410109186746989},atlasBounds:{left:380.5,bottom:144.5,right:415.5,top:190.5}},{unicode:72,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:30.5,bottom:51.5,right:65.5,top:96.5}},{unicode:73,advance:.27197265625,planeBounds:{left:.06917965680657412,bottom:-.02169206718177056,right:.20328128069342588,top:.7326295671817705},atlasBounds:{left:196.5,bottom:51.5,right:204.5,top:96.5}},{unicode:74,advance:.5517578125,planeBounds:{left:.007184947330081194,bottom:-.02657487968177056,right:.4933033339199188,top:.7277467546817705},atlasBounds:{left:.5,bottom:51.5,right:29.5,top:96.5}},{unicode:75,advance:.626953125,planeBounds:{left:.061633166497511785,bottom:-.02169206718177056,right:.6483277710024882,top:.7326295671817705},atlasBounds:{left:452.5,bottom:97.5,right:487.5,top:142.5}},{unicode:76,advance:.5380859375,planeBounds:{left:.06341786132300943,bottom:-.02169206718177056,right:.5327735449269906,top:.7326295671817705},atlasBounds:{left:423.5,bottom:97.5,right:451.5,top:142.5}},{unicode:77,advance:.873046875,planeBounds:{left:.05911847969322944,bottom:-.02169206718177056,right:.8134401140567705,top:.7326295671817705},atlasBounds:{left:377.5,bottom:97.5,right:422.5,top:142.5}},{unicode:78,advance:.712890625,planeBounds:{left:.062365588372511785,bottom:-.02169206718177056,right:.6490601928774882,top:.7326295671817705},atlasBounds:{left:341.5,bottom:97.5,right:376.5,top:142.5}},{unicode:79,advance:.6875,planeBounds:{left:.033395854136655315,bottom:-.030073418674698794,right:.6536158646133446,top:.7410109186746989},atlasBounds:{left:416.5,bottom:144.5,right:453.5,top:190.5}},{unicode:80,advance:.630859375,planeBounds:{left:.061550166358368255,bottom:-.02169206718177056,right:.6147193648916317,top:.7326295671817705},atlasBounds:{left:273.5,bottom:97.5,right:306.5,top:142.5}},{unicode:81,advance:.6875,planeBounds:{left:.030466166636655315,bottom:-.14391866037519643,right:.6506861771133446,top:.7445045978751964},atlasBounds:{left:214.5,bottom:202.5,right:251.5,top:255.5}},{unicode:82,advance:.61572265625,planeBounds:{left:.06350329135836826,bottom:-.02169206718177056,right:.6166724898916317,top:.7326295671817705},atlasBounds:{left:186.5,bottom:97.5,right:219.5,top:142.5}},{unicode:83,advance:.59326171875,planeBounds:{left:.020778681983368255,bottom:-.030073418674698794,right:.5739478805166317,top:.7410109186746989},atlasBounds:{left:454.5,bottom:144.5,right:487.5,top:190.5}},{unicode:84,advance:.5966796875,planeBounds:{left:.005480822747511787,bottom:-.02169206718177056,right:.5921754272524882,top:.7326295671817705},atlasBounds:{left:112.5,bottom:97.5,right:147.5,top:142.5}},{unicode:85,advance:.6484375,planeBounds:{left:.049098994483368255,bottom:-.02657487968177056,right:.6022681930166317,top:.7277467546817705},atlasBounds:{left:78.5,bottom:97.5,right:111.5,top:142.5}},{unicode:86,advance:.63623046875,planeBounds:{left:-.008269192599201152,bottom:-.02169206718177056,right:.6454762238492011,top:.7326295671817705},atlasBounds:{left:38.5,bottom:97.5,right:77.5,top:142.5}},{unicode:87,advance:.88720703125,planeBounds:{left:.011923628617731797,bottom:-.02169206718177056,right:.8835841838822683,top:.7326295671817705},atlasBounds:{left:220.5,bottom:97.5,right:272.5,top:142.5}},{unicode:88,advance:.626953125,planeBounds:{left:.004098979136655316,bottom:-.02169206718177056,right:.6243189896133446,top:.7326295671817705},atlasBounds:{left:.5,bottom:97.5,right:37.5,top:142.5}},{unicode:89,advance:.6005859375,planeBounds:{left:-.010793598988344685,bottom:-.02169206718177056,right:.6094264114883446,top:.7326295671817705},atlasBounds:{left:148.5,bottom:97.5,right:185.5,top:142.5}},{unicode:90,advance:.5986328125,planeBounds:{left:.024196650733368255,bottom:-.02169206718177056,right:.5773658492666317,top:.7326295671817705},atlasBounds:{left:307.5,bottom:97.5,right:340.5,top:142.5}},{unicode:91,advance:.26513671875,planeBounds:{left:.05437250871693295,bottom:-.17280296457569408,right:.27228764753306706,top:.8329592145756942},atlasBounds:{left:59.5,bottom:195.5,right:72.5,top:255.5}},{unicode:92,advance:.41015625,planeBounds:{left:.0014037126767941326,bottom:-.08573505127848349,right:.4204712873232059,top:.7356373950284835},atlasBounds:{left:278.5,bottom:206.5,right:303.5,top:255.5}},{unicode:93,advance:.26513671875,planeBounds:{left:-.020659233400995285,bottom:-.17280296457569408,right:.2140186084009953,top:.8329592145756942},atlasBounds:{left:94.5,bottom:195.5,right:108.5,top:255.5}},{unicode:94,advance:.41796875,planeBounds:{left:.006855376669722368,bottom:.33229482979472236,right:.40916024833027764,top:.7345997014552776},atlasBounds:{left:486.5,bottom:231.5,right:510.5,top:255.5}},{unicode:95,advance:.451171875,planeBounds:{left:-.017473255794918804,bottom:-.09553469482549765,right:.4686451307949188,top:.021804226075497646},atlasBounds:{left:70.5,bottom:7.5,right:99.5,top:14.5}},{unicode:96,advance:.30908203125,planeBounds:{left:.00391839948107648,bottom:.5860277898277895,right:.2553589442689235,top:.7704175226722105},atlasBounds:{left:36.5,bottom:3.5,right:51.5,top:14.5}},{unicode:97,advance:.5439453125,planeBounds:{left:.028181041080081196,bottom:-.029187146002488215,right:.5142994276699189,top:.5575074585024882},atlasBounds:{left:30.5,bottom:15.5,right:59.5,top:50.5}},{unicode:98,advance:.56103515625,planeBounds:{left:.048932994205081196,bottom:-.032187684160555265,right:.5350513807949189,top:.7724220591605554},atlasBounds:{left:304.5,bottom:207.5,right:333.5,top:255.5}},{unicode:99,advance:.5234375,planeBounds:{left:.024518931705081196,bottom:-.029187146002488215,right:.5106373182949189,top:.5575074585024882},atlasBounds:{left:.5,bottom:15.5,right:29.5,top:50.5}},{unicode:100,advance:.56396484375,planeBounds:{left:.026227916080081196,bottom:-.032187684160555265,right:.5123463026699189,top:.7724220591605554},atlasBounds:{left:334.5,bottom:207.5,right:363.5,top:255.5}},{unicode:101,advance:.52978515625,planeBounds:{left:.026472056705081196,bottom:-.029187146002488215,right:.5125904432949189,top:.5575074585024882},atlasBounds:{left:468.5,bottom:61.5,right:497.5,top:96.5}},{unicode:102,advance:.34716796875,planeBounds:{left:.004575110905578838,bottom:-.022177918535555265,right:.3733545765944212,top:.7824318247855554},atlasBounds:{left:364.5,bottom:207.5,right:386.5,top:255.5}},{unicode:103,advance:.56103515625,planeBounds:{left:.026960337955081196,bottom:-.22888445766762702,right:.5130787245449189,top:.558962582667627},atlasBounds:{left:28.5,bottom:143.5,right:57.5,top:190.5}},{unicode:104,advance:.55078125,planeBounds:{left:.049826556565937666,bottom:-.01892352016762703,right:.5024195371840624,top:.768923520167627},atlasBounds:{left:.5,bottom:143.5,right:27.5,top:190.5}},{unicode:105,advance:.24267578125,planeBounds:{left:.046882289688645884,bottom:-.01680925468177056,right:.19774661656135412,top:.7375123796817705},atlasBounds:{left:498.5,bottom:145.5,right:507.5,top:190.5}},{unicode:106,advance:.23876953125,planeBounds:{left:-.048979545900995285,bottom:-.2324562772148376,right:.1856982959009953,top:.7397804959648377},atlasBounds:{left:140.5,bottom:197.5,right:154.5,top:255.5}},{unicode:107,advance:.5068359375,planeBounds:{left:.044294322330081196,bottom:-.01892352016762703,right:.5304127089199189,top:.768923520167627},atlasBounds:{left:58.5,bottom:143.5,right:87.5,top:190.5}},{unicode:108,advance:.24267578125,planeBounds:{left:.05428707868157412,bottom:-.01892352016762703,right:.18838870256842588,top:.768923520167627},atlasBounds:{left:477.5,bottom:208.5,right:485.5,top:255.5}},{unicode:109,advance:.87646484375,planeBounds:{left:.04430890170737297,bottom:-.024304333502488215,right:.832155942042627,top:.5623902710024882},atlasBounds:{left:116.5,bottom:15.5,right:163.5,top:50.5}},{unicode:110,advance:.5517578125,planeBounds:{left:.049826556565937666,bottom:-.024304333502488215,right:.5024195371840624,top:.5623902710024882},atlasBounds:{left:60.5,bottom:15.5,right:87.5,top:50.5}},{unicode:111,advance:.5703125,planeBounds:{left:.025090213094224725,bottom:-.029187146002488215,right:.5447340056557752,top:.5575074585024882},atlasBounds:{left:193.5,bottom:15.5,right:224.5,top:50.5}},{unicode:112,advance:.56103515625,planeBounds:{left:.048444712955081196,bottom:-.22644305141762702,right:.5345630995449189,top:.561403988917627},atlasBounds:{left:447.5,bottom:208.5,right:476.5,top:255.5}},{unicode:113,advance:.568359375,planeBounds:{left:.025983775455081196,bottom:-.22644305141762702,right:.5121021620449189,top:.561403988917627},atlasBounds:{left:417.5,bottom:208.5,right:446.5,top:255.5}},{unicode:114,advance:.33837890625,planeBounds:{left:.045180595002291775,bottom:-.024304333502488215,right:.34690924874770823,top:.5623902710024882},atlasBounds:{left:449.5,bottom:61.5,right:467.5,top:96.5}},{unicode:115,advance:.515625,planeBounds:{left:.021669814448009427,bottom:-.029187146002488215,right:.4910254980519906,top:.5575074585024882},atlasBounds:{left:164.5,bottom:15.5,right:192.5,top:50.5}},{unicode:116,advance:.32666015625,planeBounds:{left:-.019433670483564695,bottom:-.02877457520298586,right:.3158203892335647,top:.675258950202986},atlasBounds:{left:418.5,bottom:54.5,right:438.5,top:96.5}},{unicode:117,advance:.55126953125,planeBounds:{left:.048117572190937666,bottom:-.034069958502488215,right:.5007105528090624,top:.5526246460024882},atlasBounds:{left:88.5,bottom:15.5,right:115.5,top:50.5}},{unicode:118,advance:.484375,planeBounds:{left:-.002092396419918806,bottom:-.02080579450955998,right:.4840259901699188,top:.5491261070095601},atlasBounds:{left:331.5,bottom:16.5,right:360.5,top:50.5}},{unicode:119,advance:.75146484375,planeBounds:{left:-.002649098431770561,bottom:-.02080579450955998,right:.7516725359317705,top:.5491261070095601},atlasBounds:{left:225.5,bottom:16.5,right:270.5,top:50.5}},{unicode:120,advance:.49560546875,planeBounds:{left:-.0046143729128470395,bottom:-.02080579450955998,right:.4982667166628471,top:.5491261070095601},atlasBounds:{left:300.5,bottom:16.5,right:330.5,top:50.5}},{unicode:121,advance:.47314453125,planeBounds:{left:-.007219349544918806,bottom:-.23645281704262702,right:.4788990370449188,top:.551394223292627},atlasBounds:{left:387.5,bottom:208.5,right:416.5,top:255.5}},{unicode:122,advance:.49560546875,planeBounds:{left:.018007705073009427,bottom:-.02080579450955998,right:.4873633886769906,top:.5491261070095601},atlasBounds:{left:271.5,bottom:16.5,right:299.5,top:50.5}},{unicode:123,advance:.33837890625,planeBounds:{left:.011572188891435306,bottom:-.20234398020069408,right:.3468262486085647,top:.8034181989506942},atlasBounds:{left:73.5,bottom:195.5,right:93.5,top:255.5}},{unicode:124,advance:.24365234375,planeBounds:{left:.06315671142450235,bottom:-.15466084787519643,right:.18049563232549765,top:.7337624103751964},atlasBounds:{left:206.5,bottom:202.5,right:213.5,top:255.5}},{unicode:125,advance:.33837890625,planeBounds:{left:-.010156326733564695,bottom:-.20234398020069408,right:.3250977329835647,top:.8034181989506942},atlasBounds:{left:38.5,bottom:195.5,right:58.5,top:255.5}},{unicode:126,advance:.68017578125,planeBounds:{left:.046984728997511785,bottom:.1766063915990047,right:.6336793335024882,top:.4112842334009953},atlasBounds:{left:.5,bottom:.5,right:35.5,top:14.5}}],kerning:[]},tj=()=>{let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]};var tZ=((r=tZ||{})[r.UNKNOWN=0]="UNKNOWN",r[r.NII=1]="NII",r[r.DCM=2]="DCM",r[r.DCM_MANIFEST=3]="DCM_MANIFEST",r[r.MIH=4]="MIH",r[r.MIF=5]="MIF",r[r.NHDR=6]="NHDR",r[r.NRRD=7]="NRRD",r[r.MHD=8]="MHD",r[r.MHA=9]="MHA",r[r.MGH=10]="MGH",r[r.MGZ=11]="MGZ",r[r.V=12]="V",r[r.V16=13]="V16",r[r.VMR=14]="VMR",r[r.HEAD=15]="HEAD",r[r.DCM_FOLDER=16]="DCM_FOLDER",r[r.SRC=17]="SRC",r[r.FIB=18]="FIB",r),tJ=Object.freeze({...tZ,parse:e=>{let t=0;switch(e.toUpperCase()){case"":case"DCM":t=2;break;case"TXT":t=3;break;case"FIB":t=18;break;case"NII":t=1;break;case"MIH":t=4;break;case"MIF":t=5;break;case"NHDR":t=6;break;case"NRRD":t=7;break;case"MHD":t=8;break;case"MHA":t=9;break;case"MGH":t=10;break;case"MGZ":t=11;break;case"SRC":t=17;break;case"V":t=12;break;case"V16":t=13;break;case"VMR":t=14;break;case"HEAD":t=15}return t}}),t_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"gray",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:NaN,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:NaN,o=!(arguments.length>7)||void 0===arguments[7]||arguments[7],n=arguments.length>8&&void 0!==arguments[8]?arguments[8]:.02,h=arguments.length>9&&void 0!==arguments[9]&&arguments[9],d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],c=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"",m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,A=arguments.length>13&&void 0!==arguments[13]?arguments[13]:tJ.UNKNOWN,g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:NaN,u=arguments.length>15&&void 0!==arguments[15]?arguments[15]:NaN,f=!(arguments.length>16)||void 0===arguments[16]||arguments[16],p=arguments.length>17&&void 0!==arguments[17]&&arguments[17],v=arguments.length>18&&void 0!==arguments[18]?arguments[18]:null;return{url:e,urlImageData:t,name:i,colormap:r,colorMap:r,opacity:s,cal_min:a,cal_max:l,trustCalMinMax:o,percentileFrac:n,ignoreZeroVoxels:h,useQFormNotSForm:d,colormapNegative:c,imageType:A,cal_minNeg:g,cal_maxNeg:u,colorbarVisible:f,frame4D:m,alphaThreshold:p,colormapLabel:v}};function t$(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80;e=e.replace(/[`$]/g,"");let i=[],r=Math.min(t,e.length);for(let t=0;t<r;t++){let r=e.charCodeAt(t);i.push(255&r)}return i}function t1(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!0;i&&(r=e.littleEndian);let s=new Uint8Array(348),a=new DataView(s.buffer);a.setInt32(0,348,r),a.setUint8(38,114),a.setUint8(39,e.dim_info);for(let t=0;t<8;t++)a.setUint16(40+2*t,e.dims[t],r);a.setFloat32(56,e.intent_p1,r),a.setFloat32(60,e.intent_p2,r),a.setFloat32(64,e.intent_p3,r),a.setInt16(68,e.intent_code,r),t?(a.setInt16(70,2,r),a.setInt16(72,8,r)):(a.setInt16(70,e.datatypeCode,r),a.setInt16(72,e.numBitsPerVoxel,r)),a.setInt16(74,e.slice_start,r);for(let t=0;t<8;t++)a.setFloat32(76+4*t,e.pixDims[t],r);t?(a.setFloat32(108,352,r),a.setFloat32(112,1,r),a.setFloat32(116,0,r)):(a.setFloat32(108,352,r),a.setFloat32(112,e.scl_slope,r),a.setFloat32(116,e.scl_inter,r)),a.setInt16(120,e.slice_end,r),a.setUint8(122,e.slice_code),0===e.xyzt_units?a.setUint8(123,10):a.setUint8(123,e.xyzt_units),t?(a.setFloat32(124,0,r),a.setFloat32(128,0,r)):(a.setFloat32(124,e.cal_max,r),a.setFloat32(128,e.cal_min,r)),a.setFloat32(132,e.slice_duration,r),a.setFloat32(136,e.toffset,r),s.set(t$(e.description),148),s.set(t$(e.aux_file),228),a.setInt16(252,e.qform_code,r),e.sform_code<1||e.sform_code<1?a.setInt16(254,1,r):a.setInt16(254,e.sform_code,r),a.setFloat32(256,e.quatern_b,r),a.setFloat32(260,e.quatern_c,r),a.setFloat32(264,e.quatern_d,r),a.setFloat32(268,e.qoffset_x,r),a.setFloat32(272,e.qoffset_y,r),a.setFloat32(276,e.qoffset_z,r);let l=e.affine.flat();for(let e=0;e<12;e++)a.setFloat32(280+4*e,l[e],r);return a.setInt32(344,3222382,!0),s}function t0(e){let t=[!1,!1,!1,!1],i=[!1,!1,!1,!1];for(let t=0;t<4;t++)for(let i=0;i<4;i++)if(isNaN(e[t][i]))return!1;for(let r=0;r<3;r++)for(let s=0;s<3;s++){if(0!==e[r][s])t[r]=!0,i[s]=!0}for(let e=0;e<3;e++)if(!t[e]||!i[e])return!1;return!0}var t2=class e{constructor(e=null,t="",i="gray",r=1,s=null,a=NaN,l=NaN,o=!0,n=.02,h=!1,d=!1,m="",A=0,g=tJ.UNKNOWN,u=NaN,p=NaN,v=!0,x=null){if(C(this,"name"),C(this,"id"),C(this,"url"),C(this,"headers"),C(this,"_colormap"),C(this,"_opacity"),C(this,"percentileFrac"),C(this,"ignoreZeroVoxels"),C(this,"trustCalMinMax"),C(this,"colormapNegative"),C(this,"colormapLabel"),C(this,"colormapInvert"),C(this,"nFrame4D"),C(this,"frame4D"),C(this,"nTotalFrame4D"),C(this,"cal_minNeg"),C(this,"cal_maxNeg"),C(this,"colorbarVisible",!0),C(this,"modulationImage",null),C(this,"modulateAlpha",0),C(this,"series",[]),C(this,"nVox3D"),C(this,"oblique_angle"),C(this,"maxShearDeg"),C(this,"useQFormNotSForm"),C(this,"alphaThreshold"),C(this,"pixDims"),C(this,"matRAS"),C(this,"pixDimsRAS"),C(this,"obliqueRAS"),C(this,"dimsRAS"),C(this,"permRAS"),C(this,"img2RASstep"),C(this,"img2RASstart"),C(this,"toRAS"),C(this,"toRASvox"),C(this,"frac2mm"),C(this,"frac2mmOrtho"),C(this,"extentsMinOrtho"),C(this,"extentsMaxOrtho"),C(this,"mm2ortho"),C(this,"hdr",null),C(this,"imageType"),C(this,"img"),C(this,"imaginary"),C(this,"v1"),C(this,"fileObject"),C(this,"dims"),C(this,"onColormapChange",()=>{}),C(this,"onOpacityChange",()=>{}),C(this,"mm000"),C(this,"mm100"),C(this,"mm010"),C(this,"mm001"),C(this,"cal_min"),C(this,"cal_max"),C(this,"robust_min"),C(this,"robust_max"),C(this,"global_min"),C(this,"global_max"),C(this,"urlImgData"),C(this,"isManifest"),C(this,"limitFrames4D"),this.name=t,this.id=(0,c.v4)(),this._colormap=i,this._opacity=r>1?1:r,this.percentileFrac=n,this.ignoreZeroVoxels=h,this.trustCalMinMax=o,this.colormapNegative=m,this.colormapLabel=x,this.frame4D=A,this.cal_minNeg=u,this.cal_maxNeg=p,this.colorbarVisible=v,this.useQFormNotSForm=d,!e)return;let w=/(?:\.([^.]+))?$/,b=w.exec(t)[1]||"";"GZ"===(b=b.toUpperCase())&&(b=(b=w.exec(t.slice(0,-3))[1]).toUpperCase());let y=null;switch(g===tJ.UNKNOWN&&(g=tJ.parse(b)),this.imageType=g,g){case tJ.DCM_FOLDER:case tJ.DCM_MANIFEST:case tJ.DCM:y=this.readDICOM(e);break;case tJ.FIB:[y,this.v1]=this.readFIB(e);break;case tJ.MIH:case tJ.MIF:y=this.readMIF(e,s);break;case tJ.NHDR:case tJ.NRRD:y=this.readNRRD(e,s);break;case tJ.MHD:case tJ.MHA:y=this.readMHA(e,s);break;case tJ.MGH:case tJ.MGZ:y=this.readMGH(e);break;case tJ.SRC:y=this.readSRC(e);break;case tJ.V:y=this.readECAT(e);break;case tJ.V16:y=this.readV16(e);break;case tJ.VMR:y=this.readVMR(e);break;case tJ.HEAD:y=this.readHEAD(e,s);break;case tJ.NII:this.hdr=f.readHeader(e),null!==this.hdr&&(0===this.hdr.cal_min&&255===this.hdr.cal_max&&(this.hdr.cal_max=0),y=f.isCompressed(e)?f.readImage(this.hdr,f.decompress(e)):f.readImage(this.hdr,e));break;default:throw Error("Image type not supported")}if(this.hdr&&"number"==typeof this.hdr.magic&&(this.hdr.magic="n+1"),this.nFrame4D=1,this.hdr)for(let e=4;e<7;e++)this.hdr.dims[e]>1&&(this.nFrame4D*=this.hdr.dims[e]);if(this.frame4D=Math.min(this.frame4D,this.nFrame4D-1),this.nTotalFrame4D=this.nFrame4D,!this.hdr||!y)return;this.nVox3D=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3];let M=this.nVox3D*(this.hdr.numBitsPerVoxel/8),D=y.byteLength/M;D!==this.nFrame4D&&(D>0&&D*M===y.byteLength?I.debug("Loading the first "+D+" of "+this.nFrame4D+" volumes"):I.warn("This header does not match voxel data",this.hdr,y.byteLength),this.nFrame4D=D),(1007===this.hdr.intent_code||2003===this.hdr.intent_code)&&3===this.nFrame4D&&16===this.hdr.datatypeCode&&(y=this.float32V1asRGBA(new Float32Array(y))),(0===this.hdr.pixDims[1]||0===this.hdr.pixDims[2]||0===this.hdr.pixDims[3])&&I.error("pixDims not plausible",this.hdr),(isNaN(this.hdr.scl_slope)||0===this.hdr.scl_slope)&&(this.hdr.scl_slope=1),isNaN(this.hdr.scl_inter)&&(this.hdr.scl_inter=0);let F=t0(this.hdr.affine);if(d||!F||this.hdr.qform_code>this.hdr.sform_code){I.debug("spatial transform based on QForm");let e=this.hdr.quatern_b,t=this.hdr.quatern_c,i=this.hdr.quatern_d,r=Math.sqrt(1-(Math.pow(e,2)+Math.pow(t,2)+Math.pow(i,2))),s=0===this.hdr.pixDims[0]?1:this.hdr.pixDims[0],a=[[r*r+e*e-t*t-i*i,2*e*t-2*r*i,2*e*i+2*r*t],[2*e*t+2*r*i,r*r+t*t-e*e-i*i,2*t*i-2*r*e],[2*e*i-2*r*t,2*t*i+2*r*e,r*r+i*i-t*t-e*e]],l=this.hdr.affine;for(let e=0;e<3;e+=1)for(let t=0;t<3;t+=1)l[e][t]=a[e][t]*this.hdr.pixDims[t+1],2===t&&(l[e][t]*=s);l[0][3]=this.hdr.qoffset_x,l[1][3]=this.hdr.qoffset_y,l[2][3]=this.hdr.qoffset_z,this.hdr.affine=l}if(!(F=t0(this.hdr.affine))){I.debug("Defective NIfTI: spatial transform does not make sense");let e=this.hdr.pixDims[1],t=this.hdr.pixDims[2],i=this.hdr.pixDims[3];(isNaN(e)||0===e)&&(e=1),(isNaN(t)||0===t)&&(t=1),(isNaN(i)||0===i)&&(i=1),this.hdr.pixDims[1]=e,this.hdr.pixDims[2]=t,this.hdr.pixDims[3]=i;let r=[[e,0,0,0],[0,t,0,0],[0,0,i,0],[0,0,0,1]];this.hdr.affine=r}if(128!==this.hdr.datatypeCode&&2304!==this.hdr.datatypeCode&&this.hdr.littleEndian!==tj()&&this.hdr.numBitsPerVoxel>8){if(16===this.hdr.numBitsPerVoxel){let e=new Uint16Array(y);for(let t=0;t<e.length;t++){let i=e[t];e[t]=((255&i)<<8|i>>8&255)<<16>>16}}else if(32===this.hdr.numBitsPerVoxel){let e=new Uint32Array(y);for(let t=0;t<e.length;t++){let i=e[t];e[t]=(255&i)<<24|(65280&i)<<8|i>>8&65280|i>>24&255}}else if(64===this.hdr.numBitsPerVoxel){let e=this.hdr.numBitsPerVoxel/8,t=new Uint8Array(y);for(let i=0;i<t.length;i+=e){let r=e-1;for(let e=0;e<r;e++){let s=t[i+e];t[i+e]=t[i+r],t[i+r]=s,r--}}}}switch(this.hdr.datatypeCode){case 2:case 128:case 2304:this.img=new Uint8Array(y);break;case 4:this.img=new Int16Array(y);break;case 16:this.img=new Float32Array(y);break;case 64:this.img=new Float64Array(y);break;case 512:this.img=new Uint16Array(y);break;case 256:{let e=new Int8Array(y),t=e.length;this.img=new Int16Array(t);for(let i=0;i<t;i++)this.img[i]=e[i];this.hdr.datatypeCode=4,this.hdr.numBitsPerVoxel=16;break}case 1:{let e=this.hdr.dims[1]*this.hdr.dims[2]*Math.max(1,this.hdr.dims[3])*Math.max(1,this.hdr.dims[4]),t=new Uint8Array(y);this.img=new Uint8Array(e);let i=new Uint8Array(8);for(let e=0;e<8;e++)i[e]=Math.pow(2,e);let r=-1;for(let s=0;s<e;s++){let e=s%8;0===e&&r++,(t[r]&i[e])!=0&&(this.img[s]=1)}this.hdr.datatypeCode=2,this.hdr.numBitsPerVoxel=8;break}case 768:{let e=new Uint32Array(y),t=e.length;this.img=new Float64Array(t);for(let i=0;i<t-1;i++)this.img[i]=e[i];this.hdr.datatypeCode=64;break}case 8:{let e=new Int32Array(y),t=e.length;this.img=new Float64Array(t);for(let i=0;i<t-1;i++)this.img[i]=e[i];this.hdr.datatypeCode=64;break}case 1024:{let e=new BigInt64Array(y),t=e.length;this.img=new Float64Array(t);for(let i=0;i<t-1;i++)this.img[i]=Number(e[i]);this.hdr.datatypeCode=64;break}case 32:{let e=new Float32Array(y),t=Math.floor(e.length/2);this.imaginary=new Float32Array(t),this.img=new Float32Array(t);let i=0;for(let r=0;r<t-1;r++)this.img[r]=e[i],this.imaginary[r]=e[i+1],i+=2;this.hdr.datatypeCode=16;break}default:throw Error("datatype "+this.hdr.datatypeCode+" not supported")}this.calculateRAS(),!isNaN(a)&&(this.hdr.cal_min=a),!isNaN(l)&&(this.hdr.cal_max=l),this.calMinMax()}computeObliqueAngle(e){let t=h.d9(e);h.p4(t,e);let i=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=Math.max(Math.max(Math.abs(t[0]),Math.abs(t[1])),Math.abs(t[2]))/i,s=Math.sqrt(t[4]*t[4]+t[5]*t[5]+t[6]*t[6]),a=Math.max(Math.max(Math.abs(t[4]),Math.abs(t[5])),Math.abs(t[6]))/s,l=Math.sqrt(t[8]*t[8]+t[9]*t[9]+t[10]*t[10]),o=Math.abs(180*Math.acos(Math.min(Math.min(r,a),Math.max(Math.max(Math.abs(t[8]),Math.abs(t[9])),Math.abs(t[10]))/l))/3.141592653);return o>.01?I.warn("Warning voxels not aligned with world space: "+o+" degrees from plumb.\n"):o=0,o}float32V1asRGBA(e){e.length!==3*this.nVox3D&&I.warn("float32V1asRGBA() expects "+3*this.nVox3D+"voxels, got ",+e.length);let t=e.slice();this.hdr.datatypeCode=2304,this.nFrame4D=1;for(let e=4;e<7;e++)this.hdr.dims[e]=1;this.hdr.dims[0]=3;let i=new Uint8Array(4*this.nVox3D),r=1;for(let e=0;e<3*this.nVox3D;e++){if(!isNaN(t[e]))r=Math.max(r,Math.abs(t[e]))}let s=255/r,a=2*this.nVox3D,l=0;for(let e=0;e<this.nVox3D;e++){let r=t[e],o=t[e+this.nVox3D],n=t[e+a];i[l]=Math.abs(r*s),i[l+1]=Math.abs(o*s),i[l+2]=Math.abs(n*s);let h=1*Number(r>0),d=2*Number(o>0),c=248+h+d+4*Number(n>0);Math.abs(r)+Math.abs(o)+Math.abs(n)<.1&&(c=0),i[l+3]=c,l+=4}return i}loadImgV1(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.v1;if(!r&&3===this.nFrame4D&&this.img.constructor===Float32Array&&(r=this.img.slice()),!r)return I.warn("Image does not have V1 data"),!1;if(e)for(let e=0;e<this.nVox3D;e++)r[e]=-r[e];if(t)for(let e=this.nVox3D;e<2*this.nVox3D;e++)r[e]=-r[e];if(i)for(let e=2*this.nVox3D;e<3*this.nVox3D;e++)r[e]=-r[e];return this.img=this.float32V1asRGBA(r),!0}calculateOblique(){if(!this.matRAS)throw Error("matRAS not defined");if(void 0===this.pixDimsRAS)throw Error("pixDimsRAS not defined");if(!this.dimsRAS)throw Error("dimsRAS not defined");this.oblique_angle=this.computeObliqueAngle(this.matRAS);let e=this.vox2mm([0,0,0],this.matRAS),t=this.vox2mm([1/this.pixDimsRAS[1],0,0],this.matRAS),i=this.vox2mm([0,1/this.pixDimsRAS[2],0],this.matRAS),r=this.vox2mm([0,0,1/this.pixDimsRAS[3]],this.matRAS);n.$X(t,t,e),n.$X(i,i,e),n.$X(r,r,e);let s=h.al(t[0],t[1],t[2],0,i[0],i[1],i[2],0,r[0],r[1],r[2],0,0,0,0,1);this.obliqueRAS=h.d9(s);let a=Math.abs(90-n.EU(t,i)*(180/Math.PI)),l=Math.abs(90-n.EU(t,r)*(180/Math.PI)),d=Math.abs(90-n.EU(i,r)*(180/Math.PI));this.maxShearDeg=Math.max(Math.max(a,l),d),this.maxShearDeg>.1&&I.warn("Warning: voxels are rhomboidal, maximum shear is %f degrees.",this.maxShearDeg);let c=o.al(this.dimsRAS[1],this.dimsRAS[2],this.dimsRAS[3],1),m=h.d9(this.matRAS);h.p4(m,m);let A=o.al(-.5,-.5,-.5,0);h.Iu(m,m,n.al(A[0],A[1],A[2])),m[0]*=c[0],m[1]*=c[0],m[2]*=c[0],m[4]*=c[1],m[5]*=c[1],m[6]*=c[1],m[8]*=c[2],m[9]*=c[2],m[10]*=c[2],this.frac2mm=h.d9(m);let g=this.pixDimsRAS[1],u=this.pixDimsRAS[2],f=this.pixDimsRAS[3],p=h.d9(m);p[0]=g*c[0],p[1]=0,p[2]=0,p[4]=0,p[5]=u*c[1],p[6]=0,p[8]=0,p[9]=0,p[10]=f*c[2];let v=this.mm2vox([0,0,0],!0);p[12]=(-v[0]-.5)*g,p[13]=(-v[1]-.5)*u,p[14]=(-v[2]-.5)*f,this.frac2mmOrtho=h.d9(p),this.extentsMinOrtho=[p[12],p[13],p[14]],this.extentsMaxOrtho=[p[0]+p[12],p[5]+p[13],p[10]+p[14]],this.mm2ortho=h.Ue(),h.U_(this.mm2ortho,s)}THD_daxes_to_NIFTI(e,t,i){let r=this.hdr;if(null===r)throw Error("HDR is not set");r.sform_code=2;let s="xxyyzzg",a=-1,l=-1,o=-1,n=["x","y","z"];n[0]=s[i[0]],n[1]=s[i[1]],n[2]=s[i[2]];let h=e.slice(0,3),d=t.slice(0,3);for(let e=0;e<3;e++)"x"===n[e]?a=e:"y"===n[e]?l=e:o=e;if(!(a<0)&&!(l<0)&&!(o<0)&&a!==l&&a!==o&&l!==o)r.pixDims[1]=Math.abs(h[0]),r.pixDims[2]=Math.abs(h[1]),r.pixDims[3]=Math.abs(h[2]),r.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],r.affine[0][a]=-h[a],r.affine[1][l]=-h[l],r.affine[2][o]=h[o],r.affine[0][3]=-d[a],r.affine[1][3]=-d[l],r.affine[2][3]=d[o]}SetPixDimFromSForm(){if(!this.hdr)throw Error("hdr not defined");let e=this.hdr.affine,t=h.al(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],e[3][0],e[3][1],e[3][2],e[3][3]),i=this.vox2mm([0,0,0],t),r=this.vox2mm([1,0,0],t);n.$X(r,r,i);let s=this.vox2mm([0,1,0],t);n.$X(s,s,i);let a=this.vox2mm([0,0,1],t);n.$X(a,a,i),this.hdr.pixDims[1]=n.kE(r),this.hdr.pixDims[2]=n.kE(s),this.hdr.pixDims[3]=n.kE(a)}readDICOM(e){let t;if(this.series=new p.Series,Array.isArray(e))for(let t=0;t<e.length;t++){let i=new DataView(e[t]),r=p.Series.parseImage(i);null===r?I.error(p.Series.parserError):r.hasPixelData()&&(0===this.series.images.length||r.getSeriesId()===this.series.images[0].getSeriesId())&&this.series.addImage(r)}else{let t=p.Series.parseImage(new DataView(e));null===t?I.error(p.Series.parserError):t.hasPixelData()&&(0===this.series.images.length||t.getSeriesId()===this.series.images[0].getSeriesId())&&this.series.addImage(t)}this.series.buildSeries(),this.hdr=new f.NIFTI1;let i=this.hdr;i.scl_inter=0,i.scl_slope=1,this.series.images[0].getDataScaleIntercept()&&(i.scl_inter=this.series.images[0].getDataScaleIntercept()),this.series.images[0].getDataScaleSlope()&&(i.scl_slope=this.series.images[0].getDataScaleSlope()),i.dims=[3,1,1,1,0,0,0,0],i.pixDims=[1,1,1,1,1,0,0,0],i.dims[1]=this.series.images[0].getCols(),i.dims[2]=this.series.images[0].getRows(),i.dims[3]=this.series.images[0].getNumberOfFrames(),this.series.images.length>1&&(i.dims[3]>1&&I.debug("To Do: multiple slices per file and multiple files (XA30 DWI)"),i.dims[3]=this.series.images.length);let r=this.series.images[0].getPixelSpacing();if(i.pixDims[1]=r[0],i.pixDims[2]=r[1],this.series.images.length>1){let e=n.al(...this.series.images[0].getImagePosition()),t=n.al(...this.series.images[1].getImagePosition()),r=n.al(0,0,0);n.$X(r,e,t),i.pixDims[3]=n.kE(r)}else i.pixDims[3]=this.series.images[0].getSliceThickness();i.pixDims[4]=this.series.images[0].getTR()/1e3;let s=this.series.images[0].getDataType(),a=this.series.images[0].getBitsAllocated();i.numBitsPerVoxel=a,this.hdr.littleEndian=this.series.images[0].littleEndian,8===a&&2===s?i.datatypeCode=256:8===a&&3===s?i.datatypeCode=2:16===a&&2===s?i.datatypeCode=4:16===a&&3===s?i.datatypeCode=512:32===a&&2===s?i.datatypeCode=8:32===a&&3===s?i.datatypeCode=768:32===a&&4===s?i.datatypeCode=16:64===a&&4===s?i.datatypeCode=64:1===a?i.datatypeCode=1:I.warn("Unsupported DICOM format: "+s+" "+a);let l=i.pixDims.slice(1,4),o=function(e,t,i){let r=null;if(e){let s={colSize:t[0],rowSize:t[1],sliceSize:t[2]},a=[e[0],e[1],e[2]],l=[e[3],e[4],e[5]],o=[a[1]*l[2]-a[2]*l[1],a[2]*l[0]-a[0]*l[2],a[0]*l[1]-a[1]*l[0]];r=[[-(a[0]*s.colSize*1),-(l[0]*s.rowSize*1),-(o[0]*s.sliceSize*1),-1*i[0]],[-(a[1]*s.colSize*1),-(l[1]*s.rowSize*1),-(o[1]*s.sliceSize*1),-1*i[1]],[a[2]*s.colSize,l[2]*s.rowSize,o[2]*s.sliceSize,i[2]],[0,0,0,1]]}return r}(this.series.images[0].getImageDirections(),l,this.series.images[0].getImagePosition());o&&(i.sform_code=1,i.affine=[[o[0][0],o[0][1],o[0][2],o[0][3]],[o[1][0],o[1][1],o[1][2],o[1][3]],[o[2][0],o[2][1],o[2][2],o[2][3]],[0,0,0,1]]);let h=this.series.validatePixelDataLength(this.series.images[0]),d=new Uint8Array(new ArrayBuffer(h*this.series.images.length));for(let e=0;e<this.series.images.length;e++)t=this.series.isMosaic?this.series.getMosaicData(this.series.images[e],this.series.images[e].getPixelDataBytes()):this.series.images[e].getPixelDataBytes(),h=this.series.validatePixelDataLength(this.series.images[e]),this.series.images[e].clearPixelData(),d.set(new Uint8Array(t,0,h),h*e);return d.buffer}readECAT(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=new DataView(e),r=i.getInt32(0,!1),s=i.getInt16(50,!1);if(0x4d415452!==r||s<1||s>14)throw Error("Not a valid ECAT file");let a=512,l=0,o=[],n=new Float32Array;for(;;){let e=i.getInt32(a,!1);if(e+i.getInt32(a+12,!1)!==31)break;let r=a+20,s=0,h=0;for(;s<31&&(h=i.getInt32(r,!1),r+=16,0!==h);){;s++;let e=512*h,r=e-512,a=i.getUint16(r,!1);t.dims[1]=i.getUint16(r+4,!1),t.dims[2]=i.getUint16(r+6,!1),t.dims[3]=i.getUint16(r+8,!1);let d=i.getFloat32(r+26,!1);t.pixDims[1]=10*i.getFloat32(r+34,!1),t.pixDims[2]=10*i.getFloat32(r+38,!1),t.pixDims[3]=10*i.getFloat32(r+42,!1),t.pixDims[4]=i.getUint32(r+46,!1)/1e3,o.push(t.pixDims[4]);let c=t.dims[1]*t.dims[2]*t.dims[3],m=new Float32Array(c);if(1===a)for(let t=0;t<c;t++)m[t]=i.getUint8(e)*d,e++;else if(6===a)for(let t=0;t<c;t++)m[t]=i.getUint16(e,!1)*d,e+=2;else if(7===a)for(let t=0;t<c;t++)m[t]=i.getUint32(e,!1)*d,e+=4;else I.warn("Unknown ECAT data type "+a);let A=n.slice(0);(n=new Float32Array(A.length+m.length)).set(A),n.set(m,A.length),l++}if(0===h)break;a+=512}if(t.dims[4]=l,t.pixDims[4]=o[0],l>1){t.dims[0]=4;let e=!1;for(let t=0;t<l;t++)o[t]!==o[0]&&(e=!0);e&&I.warn("Frame durations vary")}return t.sform_code=1,t.affine=[[-t.pixDims[1],0,0,(t.dims[1]-2)*.5*t.pixDims[1]],[0,-t.pixDims[2],0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,0,-t.pixDims[3],(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],t.numBitsPerVoxel=32,t.datatypeCode=16,n}readV16(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=new DataView(e);return t.dims[1]=i.getUint16(0,!0),t.dims[2]=i.getUint16(2,!0),t.dims[3]=i.getUint16(4,!0),2*t.dims[1]*t.dims[2]*t.dims[3]+6!==e.byteLength&&I.warn("This does not look like a valid BrainVoyager V16 file"),t.numBitsPerVoxel=16,t.datatypeCode=512,I.warn("Warning: V16 files have no spatial transforms"),t.affine=[[0,0,-t.pixDims[1],(t.dims[1]-2)*.5*t.pixDims[1]],[-t.pixDims[2],0,0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,-t.pixDims[3],0,(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],t.littleEndian=!0,e.slice(6)}readVMR(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=new DataView(e),r=i.getUint16(0,!0);4!==r&&I.warn("Not a valid version 4 VMR image"),t.dims[1]=i.getUint16(2,!0),t.dims[2]=i.getUint16(4,!0),t.dims[3]=i.getUint16(6,!0);let s=t.dims[1]*t.dims[2]*t.dims[3];if(r>=4){let r=8+s,a=i.getUint32(r+88,!0);if(r+=92,a>0){let t=e.byteLength;for(let e=0;e<a;e++){for(;r<t&&0!==i.getUint8(r);)r++;for(r++,r+=4;r<t&&0!==i.getUint8(r);)r++;r++;let e=i.getUint32(r,!0);r+=4;for(let t=0;t<e;t++)r+=4}}t.pixDims[1]=i.getFloat32(r+2,!0),t.pixDims[2]=i.getFloat32(r+6,!0),t.pixDims[3]=i.getFloat32(r+10,!0)}return I.warn("Warning: VMR spatial transform not implemented"),t.affine=[[0,0,-t.pixDims[1],(t.dims[1]-2)*.5*t.pixDims[1]],[-t.pixDims[2],0,0,(t.dims[2]-2)*.5*t.pixDims[2]],[0,-t.pixDims[3],0,(t.dims[3]-2)*.5*t.pixDims[3]],[0,0,0,1]],I.debug(t),t.numBitsPerVoxel=8,t.datatypeCode=2,e.slice(8,8+s)}readMGH(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.littleEndian=!1,t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=e,r=new DataView(i);31===r.getUint8(0)&&139===r.getUint8(1)&&(r=new DataView(i=(0,m.iF)(new Uint8Array(e)).buffer));let s=r.getInt32(0,!1),a=r.getInt32(4,!1),l=r.getInt32(8,!1),o=r.getInt32(12,!1),n=r.getInt32(16,!1),d=r.getInt32(20,!1),c=r.getFloat32(30,!1),A=r.getFloat32(34,!1),g=r.getFloat32(38,!1),u=r.getFloat32(42,!1),p=r.getFloat32(46,!1),v=r.getFloat32(50,!1),x=r.getFloat32(54,!1),w=r.getFloat32(58,!1),C=r.getFloat32(62,!1),b=r.getFloat32(66,!1),y=r.getFloat32(70,!1),M=r.getFloat32(74,!1),D=r.getFloat32(78,!1),F=r.getFloat32(82,!1),T=r.getFloat32(86,!1);(1!==s||d<0||d>4)&&I.warn("Not a valid MGH file"),0===d?(t.numBitsPerVoxel=8,t.datatypeCode=2):4===d?(t.numBitsPerVoxel=16,t.datatypeCode=4):1===d?(t.numBitsPerVoxel=32,t.datatypeCode=8):3===d&&(t.numBitsPerVoxel=32,t.datatypeCode=16),t.dims[1]=a,t.dims[2]=l,t.dims[3]=o,t.dims[4]=n,n>1&&(t.dims[0]=4),t.pixDims[1]=c,t.pixDims[2]=A,t.pixDims[3]=g,t.vox_offset=284,t.sform_code=1;let E=h.al(u*t.pixDims[1],x*t.pixDims[2],b*t.pixDims[3],0,p*t.pixDims[1],w*t.pixDims[2],y*t.pixDims[3],0,v*t.pixDims[1],C*t.pixDims[2],M*t.pixDims[3],0,0,0,0,1),S=[t.dims[1]/2,t.dims[2]/2,t.dims[3]/2,1],V=[0,0,0,0];for(let e=0;e<3;e++){V[e]=0;for(let t=0;t<3;t++)V[e]=V[e]+E[t+4*e]*S[t]}t.affine=[[E[0],E[1],E[2],D-V[0]],[E[4],E[5],E[6],F-V[1]],[E[8],E[9],E[10],T-V[2]],[0,0,0,1]];let B=t.dims[1]*t.dims[2]*t.dims[3]*t.dims[4]*(t.numBitsPerVoxel/8);return i.slice(t.vox_offset,t.vox_offset+B)}readFIB(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.littleEndian=!1,t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=tW.readMatV4(e);if(!("dimension"in i)||!("dti_fa"in i))throw Error("Not a valid DSIstudio FIB file");let r="index0"in i&&"index1"in i&&"index2"in i;t.numBitsPerVoxel=32,t.datatypeCode=16,t.dims[1]=i.dimension[0],t.dims[2]=i.dimension[1],t.dims[3]=i.dimension[2],t.dims[4]=1,t.pixDims[1]=i.voxel_size[0],t.pixDims[2]=i.voxel_size[1],t.pixDims[3]=i.voxel_size[2],t.sform_code=1;let s=(t.dims[1]-1)*.5*t.pixDims[1],a=(t.dims[2]-1)*.5*t.pixDims[2],l=(t.dims[3]-1)*.5*t.pixDims[3];t.affine=[[t.pixDims[1],0,0,-s],[0,-t.pixDims[2],0,a],[0,0,t.pixDims[2],-l],[0,0,0,1]],t.littleEndian=!0;let o=t.dims[1]*t.dims[2]*t.dims[3],n=o*Math.ceil(t.numBitsPerVoxel/8),h=n*t.dims[4],d=new Uint8Array(new ArrayBuffer(12*o));if(r){let e=t.dims[1]*t.dims[2]*t.dims[3],r=new Float32Array(e),s=new Float32Array(e),a=new Float32Array(e),l=i.index0,o=i.odf_vertices;for(let t=0;t<e;t++){let e=3*l[t];r[t]=o[e+0],s[t]=o[e+1],a[t]=-o[e+2]}d.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),0*n),d.set(new Uint8Array(s.buffer,s.byteOffset,s.byteLength),1*n),d.set(new Uint8Array(a.buffer,a.byteOffset,a.byteLength),2*n)}let c=new Uint8Array(new ArrayBuffer(h)),m=Float32Array.from(i.dti_fa),A=new Uint8Array(m.buffer,m.byteOffset,m.byteLength);return c.set(A,0),"report"in i&&(t.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength)))),[c.buffer,new Float32Array(d.buffer)]}readSRC(e){this.hdr=new f.NIFTI1;let t=this.hdr;t.littleEndian=!1,t.dims=[3,1,1,1,0,0,0,0],t.pixDims=[1,1,1,1,1,0,0,0];let i=tW.readMatV4(e);if(!("dimension"in i)||!("image0"in i))throw Error("Not a valid DSIstudio SRC file");let r=0,s=0;for(let[e,t]of Object.entries(i)){if(!!e.startsWith("image")){if(0===r?s=t.length:s!==t.length&&(s=-1),t.constructor!==Uint16Array)throw Error("DSIstudio SRC files always use Uint16 datatype");r++}}if(s<1||r<1)throw Error("SRC file not valid DSI Studio data. The image(s) should have the same length");t.numBitsPerVoxel=16,t.datatypeCode=512,t.dims[1]=i.dimension[0],t.dims[2]=i.dimension[1],t.dims[3]=i.dimension[2],t.dims[4]=r,t.dims[4]>1&&(t.dims[0]=4),t.pixDims[1]=i.voxel_size[0],t.pixDims[2]=i.voxel_size[1],t.pixDims[3]=i.voxel_size[2],t.sform_code=1;let a=(t.dims[1]-1)*.5*t.pixDims[1],l=(t.dims[2]-1)*.5*t.pixDims[2],o=(t.dims[3]-1)*.5*t.pixDims[3];t.affine=[[t.pixDims[1],0,0,-a],[0,-t.pixDims[2],0,l],[0,0,t.pixDims[2],-o],[0,0,0,1]],t.littleEndian=!0;let n=t.dims[1]*t.dims[2]*t.dims[3]*(t.numBitsPerVoxel/8),h=new Uint8Array(new ArrayBuffer(n*t.dims[4])),d=0;for(let e=0;e<r;e++){let t=i[`image${e}`],r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);h.set(r,d),d+=n}return"report"in i&&(t.description=new TextDecoder().decode(i.report.subarray(0,Math.min(79,i.report.byteLength)))),h.buffer}readHEAD(e,t){this.hdr=new f.NIFTI1;let i=this.hdr;i.dims[0]=3,i.pixDims=[1,1,1,1,1,0,0,0];let r=[0,0,0],s=[0,0,0],a=[1,1,1],l=new TextDecoder().decode(e).split(/\r?\n/),o=(e.byteLength+8)%16,n=e.byteLength+(16-o);I.debug(e.byteLength,"len",n);let h=new Uint8Array(n);h.fill(0),h.set(new Uint8Array(e));let d=new f.NIFTIEXTENSION(n+8,42,h,!0);i.addExtension(d),i.extensionCode=42,i.extensionFlag[0]=1,i.extensionSize=n+8;let c=l.length,A=0,g=!1;for(;A<c;){let e=l[A];if(A++,!e.startsWith("type"))continue;let t=e.includes("integer-attribute"),o=e.includes("float-attribute");if(e=l[A],A++,!e.startsWith("name"))continue;let n=e.split("= "),h=n[1];e=l[A],A++;let d=parseInt((n=e.split("= "))[1]);if(!(d<1)){if(e=l[A],A++,n=e.trim().split(/\s+/),o||t){for(;n.length<d;){e=l[A],A++;let t=e.trim().split(/\s+/);n.push(...t)}for(let e=0;e<d;e++)n[e]=parseFloat(n[e])}switch(h){case"BYTEORDER_STRING":n[0].includes("LSB_FIRST")?i.littleEndian=!0:n[0].includes("MSB_FIRST")&&(i.littleEndian=!1);break;case"BRICK_TYPES":{i.dims[4]=d;let e=parseInt(n[0]);0===e?(i.numBitsPerVoxel=8,i.datatypeCode=2):1===e?(i.numBitsPerVoxel=16,i.datatypeCode=4):3===e?(i.numBitsPerVoxel=32,i.datatypeCode=16):I.warn("Unknown BRICK_TYPES ",e)}break;case"IJK_TO_DICOM_REAL":if(d<12)break;g=!0,i.sform_code=2,i.affine=[[-n[0],-n[1],-n[2],-n[3]],[-n[4],-n[5],-n[6],-n[7]],[n[8],n[9],n[10],n[11]],[0,0,0,1]];break;case"DATASET_DIMENSIONS":d=Math.max(d,3);for(let e=0;e<d;e++)i.dims[e+1]=n[e];break;case"ORIENT_SPECIFIC":r=n;break;case"ORIGIN":s=n;break;case"DELTA":a=n;break;case"TAXIS_FLOATS":i.pixDims[4]=n[0];break;default:I.warn("Unknown:",h)}}}g?this.SetPixDimFromSForm():this.THD_daxes_to_NIFTI(a,s,r);let u=i.numBitsPerVoxel/8*i.dims[1]*i.dims[2]*i.dims[3]*i.dims[4];if(!t)throw Error("pairedImgData not set");return t.byteLength<u?(0,m.iF)(new Uint8Array(t)).buffer:t.slice(0)}readMHA(e,t){let i=e.byteLength;if(i<20)throw Error("File too small to be VTK: bytes = "+e.byteLength);let r=new Uint8Array(e),s=0;function a(e){return 10===e||13===e}function l(){for(;s<i&&a(r[s]);)s++;let t=s;for(;s<i&&!a(r[s]);)s++;return s-t<2?"":new TextDecoder().decode(e.slice(t,s))}let o=l();this.hdr=new f.NIFTI1;let h=this.hdr;h.pixDims=[1,1,1,1,1,0,0,0],h.dims=[1,1,1,1,1,1,1,1],h.littleEndian=!0;let d=!1,c=!1,A=v.al(NaN,0,0,0,1,0,0,0,1),g=n.al(0,0,0);for(;""!==o;){let e=o.split(" ");if(e.length>2&&(e=e.slice(2)),o.startsWith("BinaryDataByteOrderMSB")&&e[0].includes("False")&&(h.littleEndian=!0),o.startsWith("BinaryDataByteOrderMSB")&&e[0].includes("True")&&(h.littleEndian=!1),o.startsWith("CompressedData")&&e[0].includes("True")&&(d=!0),o.startsWith("TransformMatrix"))for(let t=0;t<9;t++)A[t]=parseFloat(e[t]);if(o.startsWith("Offset"))for(let t=0;t<Math.min(e.length,3);t++)g[t]=parseFloat(e[t]);if(o.startsWith("ElementSpacing"))for(let t=0;t<e.length;t++)h.pixDims[t+1]=parseFloat(e[t]);if(o.startsWith("DimSize")){h.dims[0]=e.length;for(let t=0;t<e.length;t++)h.dims[t+1]=parseInt(e[t])}if(o.startsWith("ElementType"))switch(e[0]){case"MET_UCHAR":h.numBitsPerVoxel=8,h.datatypeCode=2;break;case"MET_CHAR":h.numBitsPerVoxel=8,h.datatypeCode=256;break;case"MET_SHORT":h.numBitsPerVoxel=16,h.datatypeCode=4;break;case"MET_USHORT":h.numBitsPerVoxel=16,h.datatypeCode=512;break;case"MET_INT":h.numBitsPerVoxel=32,h.datatypeCode=8;break;case"MET_UINT":h.numBitsPerVoxel=32,h.datatypeCode=768;break;case"MET_FLOAT":h.numBitsPerVoxel=32,h.datatypeCode=16;break;case"MET_DOUBLE":h.numBitsPerVoxel=64,h.datatypeCode=64;break;default:throw Error("Unsupported MHA data type: "+e[0])}if(o.startsWith("ObjectType")&&!e[0].includes("Image")&&I.warn("Only able to read ObjectType = Image, not "+o),o.startsWith("ElementDataFile")){"LOCAL"!==e[0]&&(c=!0);break}o=l()}let u=v.al(h.pixDims[1],0,0,0,h.pixDims[2],0,0,0,h.pixDims[3]);for(v.Jp(A,A,u),h.affine=[[-A[0],-A[3],-A[6],-g[0]],[-A[1],-A[4],-A[7],-g[1]],[A[2],A[5],A[8],g[2]],[0,0,0,1]];10===r[s];)s++;if(h.vox_offset=s,c&&t)return d?(0,m.iF)(new Uint8Array(t.slice(0))).buffer:t.slice(0);return d?(0,m.iF)(new Uint8Array(e.slice(h.vox_offset))).buffer:e.slice(h.vox_offset)}readMIF(e,t){let i,r,s;this.hdr=new f.NIFTI1;let a=this.hdr;a.pixDims=[1,1,1,1,1,0,0,0],a.dims=[1,1,1,1,1,1,1,1];let l=e.byteLength;if(l<20)throw Error("File too small to be MIF: bytes = "+l);let o=new Uint8Array(e);31===o[0]&&139===o[1]&&(I.debug("MIF with GZ decompression"),l=(e=(0,m.iF)(new Uint8Array(e)).buffer).byteLength);let n=0;function h(){for(;n<l&&10===o[n];)n++;let t=n;for(;n<l&&10!==o[n];)n++;return++n-t<1?"":new TextDecoder().decode(e.slice(t,n-1))}let d=h();if(!d.startsWith("mrtrix image"))throw Error("Not a valid MIF file");let c=[],A=!1,g=0,u=0,p=!1;for(d=h();n<l&&!d.startsWith("END");){let e=d.split(":");if(d=h(),e.length<2)break;let t=e[0];e=e[1].split(",");for(let t=0;t<e.length;t++)e[t]=e[t].trim();switch(t){case"dim":a.dims[0]=e.length;for(let t=0;t<e.length;t++)a.dims[t+1]=parseInt(e[t]);break;case"vox":for(let t=0;t<e.length;t++)a.pixDims[t+1]=parseFloat(e[t]),isNaN(a.pixDims[t+1])&&(a.pixDims[t+1]=0);break;case"layout":for(let t=0;t<e.length;t++)c.push(parseInt(e[t]));break;case"datatype":{let t=e[0];t.startsWith("Bit")?(A=!0,a.datatypeCode=2):t.startsWith("Int8")?a.datatypeCode=256:t.startsWith("UInt8")?a.datatypeCode=2:t.startsWith("Int16")?a.datatypeCode=4:t.startsWith("UInt16")?a.datatypeCode=512:t.startsWith("Int32")?a.datatypeCode=8:t.startsWith("UInt32")?a.datatypeCode=768:t.startsWith("Float32")?a.datatypeCode=16:t.startsWith("Float64")?a.datatypeCode=64:I.warn("Unsupported datatype "+t),t.includes("8")?a.numBitsPerVoxel=8:t.includes("16")?a.numBitsPerVoxel=16:t.includes("32")?a.numBitsPerVoxel=32:t.includes("64")&&(a.numBitsPerVoxel=64),a.littleEndian=!0,t.endsWith("LE")&&(a.littleEndian=!0),t.endsWith("BE")&&(a.littleEndian=!1)}break;case"transform":if(g>2||4!==e.length)break;a.affine[g][0]=parseFloat(e[0]),a.affine[g][1]=parseFloat(e[1]),a.affine[g][2]=parseFloat(e[2]),a.affine[g][3]=parseFloat(e[3]),g++;break;case"comments":a.description=e[0].substring(0,Math.min(79,e[0].length));break;case"RepetitionTime":u=parseFloat(e[0]);break;case"file":!(p=!e[0].startsWith(". "))&&(e=e[0].split(" "),a.vox_offset=parseInt(e[1]))}}let v=a.dims[0];v>5&&I.warn("reader only designed for a maximum of 5 dimensions (XYZTD)");let x=1;for(let e=0;e<v;e++)x*=Math.max(a.dims[e+1],1);for(let e=0;e<3;e++)for(let t=0;t<3;t++)a.affine[e][t]*=a.pixDims[t+1];if(I.debug("mif affine:"+a.affine[0]),u>0&&(a.pixDims[4]=u),p&&!t&&I.warn("MIH header provided without paired image data"),t&&p)i=t.slice(0);else if(A){a.numBitsPerVoxel=8;let t=new Uint8Array(x),r=new Uint8Array(e.slice(a.vox_offset,a.vox_offset+Math.ceil(x/8))),s=0;for(let e=0;e<x;e++){let i=e%8;t[e]=r[s]>>7-i&1,7===i&&s++}i=t.buffer}else i=e.slice(a.vox_offset,a.vox_offset+x*(a.numBitsPerVoxel/8));c.length!==a.dims[0]&&I.warn("dims does not match layout");let w=1,C=[1,1,1,1,1],b=[!1,!1,!1,!1,!1];for(let e=0;e<c.length;e++)for(let t=0;t<c.length;t++){if(Math.abs(c[t])===e)C[t]=w,(c[t]<0||Object.is(c[t],-0))&&(b[t]=!0),w*=a.dims[t+1]}let y=tW.range(0,a.dims[1]-1,1);b[0]&&(y=tW.range(a.dims[1]-1,0,-1));for(let e=0;e<a.dims[1];e++)y[e]*=C[0];let M=tW.range(0,a.dims[2]-1,1);b[1]&&(M=tW.range(a.dims[2]-1,0,-1));for(let e=0;e<a.dims[2];e++)M[e]*=C[1];let D=tW.range(0,a.dims[3]-1,1);b[2]&&(D=tW.range(a.dims[3]-1,0,-1));for(let e=0;e<a.dims[3];e++)D[e]*=C[2];let F=tW.range(0,a.dims[4]-1,1);b[3]&&(F=tW.range(a.dims[4]-1,0,-1));for(let e=0;e<a.dims[4];e++)F[e]*=C[3];let T=tW.range(0,a.dims[5]-1,1);b[4]&&(T=tW.range(a.dims[5]-1,0,-1));for(let e=0;e<a.dims[5];e++)T[e]*=C[4];let E=0;switch(a.datatypeCode){case 256:r=new Int8Array(i),s=new Int8Array(x);break;case 2:r=new Uint8Array(i),s=new Uint8Array(x);break;case 4:r=new Int16Array(i),s=new Int16Array(x);break;case 512:r=new Uint16Array(i),s=new Uint16Array(x);break;case 8:r=new Int32Array(i),s=new Int32Array(x);break;case 768:r=new Uint32Array(i),s=new Uint32Array(x);break;case 16:r=new Float32Array(i),s=new Float32Array(x);break;case 64:r=new Float64Array(i),s=new Float64Array(x);break;default:throw Error("unknown datatypeCode")}for(let e=0;e<a.dims[5];e++)for(let t=0;t<a.dims[4];t++)for(let i=0;i<a.dims[3];i++)for(let l=0;l<a.dims[2];l++)for(let o=0;o<a.dims[1];o++)s[E]=r[y[o]+M[l]+D[i]+F[t]+T[e]],E++;return s}readNRRD(e,t){this.hdr=new f.NIFTI1;let i=this.hdr;i.pixDims=[1,1,1,1,1,0,0,0];let r=e.byteLength,s=null,a=new Uint8Array(e);for(let t=1;t<r;t++)if(10===a[t-1]&&10===a[t]){let r=e.slice(0,t-1);s=new TextDecoder().decode(r),i.vox_offset=t+1;break}if(null===s)throw Error("could not extract txt");let l=s.split("\n");!l[0].startsWith("NRRD")&&alert("Invalid NRRD image");let o=l.length,d=!1,c=!1,A=!1,g=v.al(NaN,0,0,0,1,0,0,0,1),u=n.al(0,0,0),p=v.Ue();for(let e=1;e<o;e++){let t=l[e];if("#"===t[0])continue;let r=(t=t.toLowerCase()).split(":");if(r.length<2)continue;let s=r[0].trim(),a=r[1].trim();switch(a=(a=(a=a.replaceAll(")"," ")).replaceAll("("," ")).trim(),s){case"data file":A=!0;break;case"encoding":a.includes("raw")?d=!1:a.includes("gz")?d=!0:alert("Unsupported NRRD encoding");break;case"type":switch(a){case"uchar":case"unsigned char":case"uint8":case"uint8_t":i.numBitsPerVoxel=8,i.datatypeCode=2;break;case"signed char":case"int8":case"int8_t":i.numBitsPerVoxel=8,i.datatypeCode=256;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":i.numBitsPerVoxel=16,i.datatypeCode=4;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":i.numBitsPerVoxel=16,i.datatypeCode=512;break;case"int":case"signed int":case"int32":case"int32_t":i.numBitsPerVoxel=32,i.datatypeCode=8;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":i.numBitsPerVoxel=32,i.datatypeCode=768;break;case"float":i.numBitsPerVoxel=32,i.datatypeCode=16;break;case"double":i.numBitsPerVoxel=64,i.datatypeCode=64;break;default:throw Error("Unsupported NRRD data type: "+a)}break;case"spacings":{let e=a.split(/[ ,]+/);for(let t=0;t<e.length;t++)i.pixDims[t+1]=parseFloat(e[t])}break;case"sizes":{let e=a.split(/[ ,]+/);i.dims[0]=e.length;for(let t=0;t<e.length;t++)i.dims[t+1]=parseInt(e[t])}break;case"endian":a.includes("little")?i.littleEndian=!0:a.includes("big")&&(i.littleEndian=!1);break;case"space directions":{let e=a.split(/[ ,]+/);if(9!==e.length)break;for(let t=0;t<9;t++)g[t]=parseFloat(e[t])}break;case"space origin":{let e=a.split(/[ ,]+/);if(3!==e.length)break;u[0]=parseFloat(e[0]),u[1]=parseFloat(e[1]),u[2]=parseFloat(e[2])}break;case"space units":a.includes("microns")&&(c=!0);break;case"space":a.includes("right-anterior-superior")||a.includes("ras")?p=v.al(1,0,0,0,1,0,0,0,1):a.includes("left-anterior-superior")||a.includes("las")?p=v.al(-1,0,0,0,1,0,0,0,1):a.includes("left-posterior-superior")||a.includes("lps")?p=v.al(-1,0,0,0,-1,0,0,0,1):I.warn("Unsupported NRRD space value:",a);break;default:I.warn("Unknown:",s)}}if(!isNaN(g[0])){this.hdr.sform_code=2,c&&(h.cf(g,g,.001),u[0]*=.001,u[1]*=.001,u[2]*=.001),p[0]<0&&(u[0]=-u[0]),p[4]<0&&(u[1]=-u[1]),p[8]<0&&(u[2]=-u[2]),v.Jp(g,p,g);let e=h.al(g[0],g[3],g[6],u[0],g[1],g[4],g[7],u[1],g[2],g[5],g[8],u[2],0,0,0,1),t=this.vox2mm([0,0,0],e),r=this.vox2mm([1,0,0],e);n.$X(r,r,t);let s=this.vox2mm([0,1,0],e);n.$X(s,s,t);let a=this.vox2mm([0,0,1],e);n.$X(a,a,t),i.pixDims[1]=n.kE(r),i.pixDims[2]=n.kE(s),i.pixDims[3]=n.kE(a),i.affine=[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[0,0,0,1]]}return A&&t?t.slice(0):(A&&I.warn("Missing data: NRRD header describes detached data file but only one URL provided"),d)?(0,m.iF)(new Uint8Array(e.slice(i.vox_offset))).buffer:e.slice(i.vox_offset)}calculateRAS(){if(!this.hdr)throw Error("hdr not set");let e=this.hdr.affine,t=this.hdr,i=v.al(Math.abs(e[0][0]),Math.abs(e[0][1]),Math.abs(e[0][2]),Math.abs(e[1][0]),Math.abs(e[1][1]),Math.abs(e[1][2]),Math.abs(e[2][0]),Math.abs(e[2][1]),Math.abs(e[2][2])),r=[1,1,1];i[3]>i[0]&&(r[0]=2),i[6]>i[0]&&i[6]>i[3]&&(r[0]=3),r[1]=1,1===r[0]?i[4]>i[7]?r[1]=2:r[1]=3:2===r[0]?i[1]>i[7]?r[1]=1:r[1]=3:i[1]>i[4]?r[1]=1:r[1]=2,r[2]=6-r[1]-r[0];let s=[1,2,3];s[r[0]-1]=1,s[r[1]-1]=2,s[r[2]-1]=3;let a=h.al(e[0][0],e[0][1],e[0][2],e[0][3],e[1][0],e[1][1],e[1][2],e[1][3],e[2][0],e[2][1],e[2][2],e[2][3],0,0,0,1);this.mm000=this.vox2mm([-.5,-.5,-.5],a),this.mm100=this.vox2mm([t.dims[1]-.5,-.5,-.5],a),this.mm010=this.vox2mm([-.5,t.dims[2]-.5,-.5],a),this.mm001=this.vox2mm([-.5,-.5,t.dims[3]-.5],a);let l=h.Ue();h.JG(l,a);for(let e=0;e<3;e++)for(let t=0;t<3;t++)l[4*e+t]=a[4*e+s[t]-1];let o=[0,0,0];l[0]<0&&(o[0]=1),l[5]<0&&(o[1]=1),l[10]<0&&(o[2]=1),this.dimsRAS=[t.dims[0],t.dims[s[0]],t.dims[s[1]],t.dims[s[2]]],this.pixDimsRAS=[t.pixDims[0],t.pixDims[s[0]],t.pixDims[s[1]],t.pixDims[s[2]]],this.permRAS=s.slice();for(let e=0;e<3;e++)1===o[e]&&(this.permRAS[e]=-this.permRAS[e]);if(this.arrayEquals(s,[1,2,3])&&this.arrayEquals(o,[0,0,0])){this.toRAS=h.Ue(),this.matRAS=h.d9(a),this.calculateOblique(),this.img2RASstep=[1,this.dimsRAS[1],this.dimsRAS[1]*this.dimsRAS[2]],this.img2RASstart=[0,0,0];return}h.yR(a),a[0]=1-2*o[0],a[5]=1-2*o[1],a[10]=1-2*o[2],a[3]=(t.dims[s[0]]-1)*o[0],a[7]=(t.dims[s[1]]-1)*o[1],a[11]=(t.dims[s[2]]-1)*o[2];let n=h.Ue();h.U_(n,a),h.Jp(n,n,l),this.matRAS=h.d9(n),(a=h.al(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1))[s[0]-1+0]=-(2*o[0])+1,a[s[1]-1+4]=-(2*o[1])+1,a[s[2]-1+8]=-(2*o[2])+1,a[3]=o[0],a[7]=o[1],a[11]=o[2],this.toRAS=h.d9(a),a[3]=0,a[7]=0,a[11]=0,a[12]=0,(-1===this.permRAS[0]||-1===this.permRAS[1]||-1===this.permRAS[2])&&(a[12]=t.dims[1]-1),a[13]=0,(-2===this.permRAS[0]||-2===this.permRAS[1]||-2===this.permRAS[2])&&(a[13]=t.dims[2]-1),a[14]=0,(-3===this.permRAS[0]||-3===this.permRAS[1]||-3===this.permRAS[2])&&(a[14]=t.dims[3]-1),this.toRASvox=h.d9(a),I.debug(this.hdr.dims),I.debug(this.dimsRAS);let d=this.hdr,c=[Math.abs((s=this.permRAS)[0]),Math.abs(s[1]),Math.abs(s[2])],m=[d.dims[c[0]],d.dims[c[1]],d.dims[c[2]]],A=[1,d.dims[1],d.dims[1]*d.dims[2]],g=[A[c[0]-1],A[c[1]-1],A[c[2]-1]],u=[0,0,0];for(let e=0;e<3;e++)s[e]<0&&(u[e]=g[e]*(m[e]-1),g[e]=-g[e]);this.img2RASstep=g,this.img2RASstart=u,this.calculateOblique()}hdr2RAS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.permRAS)throw Error("permRAS undefined");if(!this.hdr)throw Error("hdr undefined");let t=t1({...this.hdr,vox_offset:352},!1),i=f.readHeader(t.buffer,!0);1===e?(i.dims[0]=3,i.dims[4]=1):e>1&&(i.dims[0]=4,i.dims[4]=e);let r=this.permRAS.slice();if(1===r[0]&&2===r[1]&&3===r[2])return i;i.qform_code=0;for(let e=1;e<4;e++)i.dims[e]=this.dimsRAS[e];for(let e=0;e<this.pixDimsRAS.length;e++)i.pixDims[e]=this.pixDimsRAS[e];let s=0;for(let e=0;e<4;e++)for(let t=0;t<4;t++)i.affine[e][t]=this.matRAS[s],s++;return i}img2RAS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.permRAS)throw Error("permRAS undefined");if(!this.img)throw Error("img undefined");if(!this.hdr)throw Error("hdr undefined");let t=this.permRAS.slice();if(1===t[0]&&2===t[1]&&3===t[2])return this.img;let i=this.hdr,r=i.dims[1]*i.dims[2]*i.dims[3],s=e*r;(s+r>this.img.length||s<0)&&(s=0,I.warn(`img2RAS nVolume (${e}) out of bounds (${e}+1)\xd7${r} > ${this.img.length}`));let a=this.img.slice(0,r),l=[Math.abs(t[0]),Math.abs(t[1]),Math.abs(t[2])],o=[i.dims[l[0]],i.dims[l[1]],i.dims[l[2]]],n=[1,i.dims[1],i.dims[1]*i.dims[2]],h=[n[l[0]-1],n[l[1]-1],n[l[2]-1]],d=[0,0,0];for(let e=0;e<3;e++)t[e]<0&&(d[e]=h[e]*(o[e]-1),h[e]=-h[e]);let c=0;for(let e=0;e<o[2];e++){let t=d[2]+e*h[2];for(let e=0;e<o[1];e++){let i=d[1]+e*h[1];for(let e=0;e<o[0];e++){let r=d[0]+e*h[0];a[c]=this.img[r+i+t+s],c++}}}return a}vox2mm(e,t){let i=h.d9(t);h.p4(i,i);let r=o.al(e[0],e[1],e[2],1);return o.fF(r,r,i),n.al(r[0],r[1],r[2])}mm2vox(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.matRAS)throw Error("matRAS undefined");let i=h.d9(this.matRAS),r=h.d9(i);h.p4(r,i),h.U_(r,r);let s=o.al(e[0],e[1],e[2],1);o.fF(s,s,r);let a=n.al(s[0],s[1],s[2]);return t?a:[Math.round(a[0]),Math.round(a[1]),Math.round(a[2])]}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,i)=>e===t[i])}setColormap(e){this._colormap=e,this.calMinMax(),this.onColormapChange&&this.onColormapChange(this)}setColormapLabel(e){this.colormapLabel=tG.makeLabelLut(e)}async setColormapLabelFromUrl(e){this.colormapLabel=await tG.makeLabelLutFromUrl(e)}get colormap(){return this._colormap}get colorMap(){return this._colormap}set colormap(e){this.setColormap(e)}set colorMap(e){this.setColormap(e)}get opacity(){return this._opacity}set opacity(e){this._opacity=e,this.onOpacityChange&&this.onOpacityChange(this)}calMinMax(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(!this.hdr)throw Error("hdr undefined");if(!this.img)throw Error("img undefined");let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=0,s=0,a=this.img.length,l=0,o=this.hdr.dims[1]*this.hdr.dims[2]*this.hdr.dims[3],n=Math.floor(a/o);e>=n&&(e=this.frame4D),e>=0&&e<n&&(a=(l=e*o)+o);let h=this.img.constructor!==Float64Array&&this.img.constructor!==Float32Array&&this.ignoreZeroVoxels;if(h)for(let e=l;e<a;e++)t=Math.min(this.img[e],t),i=Math.max(this.img[e],i),0===this.img[e]&&r++;else for(let e=l;e<a;e++){if(isNaN(this.img[e])){s++;continue}if(0!==this.img[e]||(r++,!this.ignoreZeroVoxels))t=Math.min(this.img[e],t),i=Math.max(this.img[e],i)}this.ignoreZeroVoxels&&t===i&&r>0&&(t=0);let d=this.intensityRaw2Scaled(t),c=this.intensityRaw2Scaled(i),m=tG.colormapFromKey(this._colormap),A=0,g=0;if(void 0!==m.min&&(A=m.min),void 0!==m.max&&(g=m.max),A===g&&this.trustCalMinMax&&isFinite(this.hdr.cal_min)&&isFinite(this.hdr.cal_max)&&this.hdr.cal_max>this.hdr.cal_min)return this.cal_min=this.hdr.cal_min,this.cal_max=this.hdr.cal_max,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=d,this.global_max=c,[this.hdr.cal_min,this.hdr.cal_max,this.hdr.cal_min,this.hdr.cal_max];if(A!==g)return this.cal_min=A,this.cal_max=g,this.robust_min=this.cal_min,this.robust_max=this.cal_max,[A,g,A,g];let u=100*r/(a-l),f=!1;u>60&&!this.ignoreZeroVoxels&&(I.warn(`${Math.round(u)}% of voxels are zero: ignoring zeros for cal_max`),f=!0,this.ignoreZeroVoxels=!0),!this.ignoreZeroVoxels&&(r=0);let p=Math.round((a-l-(r+=s))*this.percentileFrac);if(p<1||t===i)return I.debug("no variability in image intensity?"),this.cal_min=d,this.cal_max=c,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=d,this.global_max=c,[d,c,d,c];let v=1e3/(i-t),x=Array(1001);for(let e=0;e<1001;e++)x[e]=0;if(h)for(let e=l;e<a;e++)x[Math.round((this.img[e]-t)*v)]++;else if(this.ignoreZeroVoxels)for(let e=l;e<a;e++){if(!(0===this.img[e]||isNaN(this.img[e])))x[Math.round((this.img[e]-t)*v)]++}else for(let e=l;e<a;e++){if(!isNaN(this.img[e]))x[Math.round((this.img[e]-t)*v)]++}let w=0,C=0;for(;w<p;)w+=x[C],C++;C--,w=0;let b=1001;for(;w<p;)w+=x[--b];if(C===b){let e=-1;for(;0!==e;)C>0&&x[--C]>0&&(e=0),0!==e&&b<1e3&&x[++b]>0&&(e=0),0===C&&1e3===b&&(e=0)}let y=this.intensityRaw2Scaled(C/v+t),M=this.intensityRaw2Scaled(b/v+t);return this.hdr.cal_min<this.hdr.cal_max&&this.hdr.cal_min>=d&&this.hdr.cal_max<=c&&(y=this.hdr.cal_min,M=this.hdr.cal_max),f&&(y=Math.min(y,0)),this.cal_min=y,this.cal_max=M,this.robust_min=this.cal_min,this.robust_max=this.cal_max,this.global_min=d,this.global_max=c,[y,M,d,c]}intensityRaw2Scaled(e){if(!this.hdr)throw Error("hdr undefined");return 0===this.hdr.scl_slope&&(this.hdr.scl_slope=1),e*this.hdr.scl_slope+this.hdr.scl_inter}intensityScaled2Raw(e){if(!this.hdr)throw Error("hdr undefined");return 0===this.hdr.scl_slope&&(this.hdr.scl_slope=1),(e-this.hdr.scl_inter)/this.hdr.scl_slope}saveToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.hdr)throw Error("hdr undefined");if(!this.img)throw Error("img undefined");let i=null!==t,r=t1(this.hdr,i),s=new Uint8Array(4),a=new Uint8Array(this.img.buffer);i&&(a=new Uint8Array(t.buffer));let l=new Uint8Array(r.length+s.length+a.length);l.set(r),l.set(s,r.length),l.set(a,r.length+s.length);let o=null;return o=e.endsWith(".gz")?(0,m.rZ)(l,{filename:e,mtime:Date.now(),level:6}):l}saveToDisk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.saveToUint8Array(e,t);if(""===e)return I.debug("saveToDisk: empty file name, returning data as Uint8Array rather than triggering download"),i;let r=new Blob([i.buffer],{type:"application/octet-stream"}),s=URL.createObjectURL(r),a=document.createElement("a");return a.setAttribute("href",s),a.setAttribute("download",e),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),i}static async fetchDicomData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(""===e)throw Error("url must not be empty");let i=/^(?:[a-z+]+:)?\/\//i.test(e)?e:new URL(e,window.location.href);!/(?:.([^.]+))?$/.exec(i.pathname)&&(i=new URL("niivue-manifest.txt",e));let r=await fetch(i,{headers:t});if(!r.ok)throw Error(r.statusText);let s=(await r.text()).split("\n"),a=/(.*\/).*/.exec(i)[0],l=[];for(let e of s){let i=new URL(e,a);if(!(r=await fetch(i,{headers:t})).ok)throw Error(r.statusText);let s=await r.arrayBuffer();l.push(s)}return l}static async fetchPartial(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return await fetch(e,{headers:{range:`bytes=0-'${t}`,stream:"true",...i}})}catch(t){return I.error(t),I.error("fetchPartial failed, trying again without range header"),await fetch(e,{headers:i})}}static async loadFromUrl(){let t,{url:i="",urlImgData:r="",headers:s={},name:a="",colormap:l="gray",opacity:o=1,cal_min:n=NaN,cal_max:h=NaN,trustCalMinMax:d=!0,percentileFrac:c=.02,ignoreZeroVoxels:A=!1,useQFormNotSForm:g=!1,colormapNegative:u="",frame4D:p=0,isManifest:v=!1,limitFrames4D:x=NaN,imageType:w=tJ.UNKNOWN,colorbarVisible:C=!0,buffer:b=new ArrayBuffer(0)}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(""===i)throw Error("url must not be empty");let y=null,I=null;if(i instanceof Uint8Array&&(i=i.buffer),b.byteLength>0&&(i=b),i instanceof ArrayBuffer){if(I=i,""!==a)i=a;else{i="array.nii";let e=new Uint8Array(I);31===e[0]&&139===e[1]&&(i="array.nii.gz")}}if(!isNaN(x)){let e=await this.fetchPartial(i,512,s),t=new Uint8Array(I=await e.arrayBuffer()),r=!1;31===t[0]&&139===t[1]&&(r=!0,new m.Q1(e=>{t=e}).push(t),I=t.buffer);let a=92===t[0]&&1===t[1];if(!a&&(a=92===t[1]&&1===t[0]),a){let t=f.readHeader(I);if(null===t)throw Error("could not read nifti header");let a=t.numBitsPerVoxel/8,l=1;for(let e=1;e<4;e++)t.dims[e]>1&&(l*=t.dims[e]);let o=1;for(let e=4;e<7;e++)t.dims[e]>1&&(o*=t.dims[e]);let n=Math.max(Math.min(x,o),1),h=t.vox_offset+n*l*a;if(I.byteLength<h&&(e=await this.fetchPartial(i,h,s),I=await e.arrayBuffer(),r)){let e=new Uint8Array(I);new m.Q1(t=>{e=t}).push(e),I=e.buffer}I=I.byteLength<h?null:I.slice(0,h)}else I=null}if(I);else if(v)I=await e.fetchDicomData(i,s),w=tJ.DCM_MANIFEST;else{let e=await fetch(i,{headers:s});if(!e.ok)throw Error(e.statusText);I=await e.arrayBuffer()}let M=/(?:\.([^.]+))?$/,D="";if("HEAD"===(D=""===a?M.exec(i)[1]:M.exec(a)[1]).toUpperCase()&&""===r&&(r=i.substring(0,i.lastIndexOf("HEAD"))+"BRIK"),""===a){try{t=new URL(i).pathname.split("/")}catch(e){t=i.split("/")}(a=t.slice(-1)[0]).indexOf("?")>-1&&(a=a.slice(0,a.indexOf("?")))}let F=null;if(r.length>0){let e=await fetch(r,{headers:s});404===e.status&&-1!==r.lastIndexOf("BRIK")&&(e=await fetch(r+".gz",{headers:s})),F=await e.arrayBuffer()}if(!I)throw Error("Unable to load buffer properly from volume");return(y=new e(I,a,l,o,F,n,h,d,c,A,g,u,p,w)).url=i,y.colorbarVisible=C,y}static readFileAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;return new Promise((i,r)=>{let s=new FileReader;s.onload=()=>{-1!==e.name.lastIndexOf("gz")&&isNaN(t)?i(f.decompress(s.result)):i(s.result)},s.onerror=r,isNaN(t)?s.readAsArrayBuffer(e):s.readAsArrayBuffer(e.slice(0,t))})}static async loadFromFile(t){let{file:i,name:r="",colormap:s="gray",opacity:a=1,urlImgData:l=null,cal_min:o=NaN,cal_max:n=NaN,trustCalMinMax:h=!0,percentileFrac:d=.02,ignoreZeroVoxels:c=!1,useQFormNotSForm:A=!1,colormapNegative:g="",frame4D:u=0,limitFrames4D:p=NaN,imageType:v=tJ.UNKNOWN}=t,x=null,w=[];try{if(Array.isArray(i))for(let e=0;e<i.length;e++)w.push(await this.readFileAsync(i[e]));else{if(isNaN(p))w=await this.readFileAsync(i,p);else{w=await this.readFileAsync(i,512);let e=new Uint8Array(w),t=!1;31===e[0]&&139===e[1]&&(t=!0,new m.Q1(t=>{e=t}).push(e),w=e.buffer);let r=92===e[0]&&1===e[1];if(!r&&(r=92===e[1]&&1===e[0]),r){let e=f.readHeader(w);if(!e)throw Error("could not read nifti header");let r=e.numBitsPerVoxel/8,s=1;for(let t=1;t<4;t++)e.dims[t]>1&&(s*=e.dims[t]);let a=1;for(let t=4;t<7;t++)e.dims[t]>1&&(a*=e.dims[t]);let l=Math.max(Math.min(p,a),1),o=e.vox_offset+l*s*r;if(w.byteLength<o&&(w=await this.readFileAsync(i,o),t)){let e=new Uint8Array(w);new m.Q1(t=>{e=t}).push(e),w=e.buffer}if(w.byteLength<o)throw Error("failed to load image data (e.g. incompressible data)");w=w.slice(0,o)}else w=await this.readFileAsync(i)}r=i.name}let t=null;l&&(t=await this.readFileAsync(l)),(x=new e(w,r,s,a,t,o,n,h,d,c,A,g,u,v)).fileObject=i}catch(e){I.error(e),I.error(e)}if(null===x)throw Error("could not build NVImage");return x}static createNiftiArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[256,256,256],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Uint8Array,a=t1(this.createNiftiHeader(e,t,i,r),!1);if(s.length<1)return a;let l=new Uint8Array(4),o=new Uint8Array(s.buffer),n=new Uint8Array(a.length+l.length+o.length);return n.set(a),n.set(l,a.length),n.set(o,a.length+l.length),n}static createNiftiHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[256,256,256],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=new f.NIFTI1;s.littleEndian=!0,s.dims=[3,1,1,1,0,0,0,0],s.dims[0]=Math.max(3,e.length);for(let t=0;t<e.length;t++)s.dims[t+1]=e[t];s.pixDims=[1,1,1,1,1,0,0,0];for(let i=0;i<e.length;i++)s.pixDims[i+1]=t[i];if(16===i.length){let e=0;for(let t=0;t<4;t++)for(let r=0;r<4;r++)s.affine[t][r]=i[e],e++}let a=8;return 256===r||2===r?a=8:512===r||4===r?a=16:16===r||768===r||8===r?a=32:64===r?a=64:I.warn("Unsupported NIfTI datatypeCode: "+r),s.datatypeCode=r,s.numBitsPerVoxel=a,s.scl_inter=0,s.scl_slope=0,s.sform_code=2,s.magic="n+1",s.vox_offset=352,s}getVolumeData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-1,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"same",r=new Uint8Array;if(0>Math.min(...e)||0>Math.min(...t))return[r,[0,0,0]];let s=this.dimsRAS.slice(1,4);for(let i=0;i<3;i++)if(e[i]=Math.min(e[i],s[i]-1),t[i]=Math.min(t[i],s[i]-1),t[i]<e[i]){let r=t[i];t[i]=e[i],e[i]=r}let a=[t[0]-e[0]+1,t[1]-e[1]+1,t[2]-e[2]+1],l=a[0]*a[1]*a[2],o=this.hdr.datatypeCode;if("uint8"===i?o=2:("float32"===i||"scaled"===i||"normalized"===i||"windowed"===i)&&(o=16),2===o)r=new Uint8Array(l);else if(4===o)r=new Int16Array(l);else if(512===o)r=new Uint16Array(l);else if(16===o)r=new Float32Array(l);else{if(64!==o)return I.error("getVolumeData unsupported datatype"),[r,[0,0,0]];r=new Float64Array(l)}let n=this.img2RASstep,h=this.img2RASstart,d=0;for(let i=e[2];i<=t[2];i++){let s=h[2]+i*n[2];for(let i=e[1];i<=t[1];i++){let a=s+h[1]+i*n[1];for(let i=e[0];i<=t[0];i++){let e=h[0]+i*n[0];r[d++]=this.img[e+a]}}}if("scaled"===i||"normalized"===i||"windowed"===i)for(let e=0;e<r.length;e++)r[e]=r[e]*this.hdr.scl_slope+this.hdr.scl_inter;if("normalized"===i||"windowed"===i){let e=this.cal_min,t=this.cal_max;"normalized"===i&&(e=this.global_min,t=this.global_max);let s=1/(t-e);for(let t=0;t<r.length;t++)r[t]=(r[t]-e)*s,r[t]=Math.max(Math.min(r[t],1),0)}return[r,a]}setVolumeData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-1,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Uint8Array;if(i.length<1||0>Math.min(...e)||0>Math.min(...t))return;let r=this.dimsRAS.slice(1,4);for(let i=0;i<3;i++)if(e[i]=Math.min(e[i],r[i]-1),t[i]=Math.min(t[i],r[i]-1),t[i]<e[i]){let r=t[i];t[i]=e[i],e[i]=r}let s=[t[0]-e[0]+1,t[1]-e[1]+1,t[2]-e[2]+1],a=s[0]*s[1]*s[2];if(i.length<a){I.error("setVolumeData image does not have enough voxels");return}let l=this.img2RASstep,o=this.img2RASstart,n=0;for(let r=e[2];r<=t[2];r++){let s=o[2]+r*l[2];for(let r=e[1];r<=t[1];r++){let a=s+o[1]+r*l[1];for(let r=e[0];r<=t[0];r++){let e=o[0]+r*l[0];this.img[e+a]=i[n++]}}}}static loadFromBase64(t){let{base64:i,name:r="",colormap:s="gray",opacity:a=1,cal_min:l=NaN,cal_max:o=NaN,trustCalMinMax:n=!0,percentileFrac:h=.02,ignoreZeroVoxels:d=!1,useQFormNotSForm:c=!1,colormapNegative:m="",frame4D:A=0,imageType:g=tJ.UNKNOWN,cal_minNeg:u=NaN,cal_maxNeg:f=NaN,colorbarVisible:p=!0,colormapLabel:v=null}=t,x=null;try{let t=function(e){let t=window.atob(e),i=t.length,r=new Uint8Array(i);for(let e=0;e<i;e++)r[e]=t.charCodeAt(e);return r.buffer}(i);x=new e(t,r,s,a,null,l,o,n,h,d,c,m,A,g,u,f,p,v)}catch(e){I.debug(e)}if(null===x)throw Error("could not load NVImage");return x}clone(){let t=new e;return t.id=(0,c.v4)(),t.hdr=Object.assign({},this.hdr),t.img=this.img.slice(),t.calculateRAS(),t.calMinMax(),t}zeroImage(){this.img.fill(0)}getImageMetadata(){if(!this.hdr)throw Error("hdr undefined");let e=this.id,t=this.hdr.datatypeCode,i=this.hdr.dims,r=i[1],s=i[2],a=i[3],l=Math.max(1,i[4]),o=this.hdr.pixDims,n=o[1],h=o[2],d=o[3],c=o[4];return{id:e,datatypeCode:t,nx:r,ny:s,nz:a,nt:l,dx:n,dy:h,dz:d,dt:c,bpv:Math.floor(this.hdr.numBitsPerVoxel/8)}}static zerosLike(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"same",i=e.clone();return i.zeroImage(),"uint8"===t&&(i.img=Uint8Array.from(i.img),i.hdr.datatypeCode=2,i.hdr.numBitsPerVoxel=8),"float32"===t&&(i.img=Float32Array.from(i.img),i.hdr.datatypeCode=16,i.hdr.numBitsPerVoxel=32),i}getValue(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this.hdr)throw Error("hdr undefined");if(!this.img)throw Error("img undefined");let a=this.hdr.dims[1],l=this.hdr.dims[2],n=this.hdr.dims[3],h=this.permRAS.slice();if(1!==h[0]||2!==h[1]||3!==h[2]){let r=o.al(e,t,i,1);o.fF(r,r,this.toRASvox),e=r[0],t=r[1],i=r[2]}let d=e+t*a+i*a*l;if(2304===this.hdr.datatypeCode)return d*=4,Math.round(.21*this.img[d]+.72*this.img[d+1]+.07*this.img[d+2]);if(128===this.hdr.datatypeCode)return d*=3,Math.round(.21*this.img[d]+.72*this.img[d+1]+.07*this.img[d+2]);let c=r*a*l*n,m=this.img[d+c];return s&&(m=this.imaginary[d+c]),this.hdr.scl_slope*m+this.hdr.scl_inter}toNiivueObject3D(e,t){let i=this.dimsRAS,r=this.matRAS,s=this.pixDimsRAS,a=i[1]-1+.5,l=i[2]-1+.5,o=i[3]-1+.5,h=this.vox2mm([-.5,-.5,-.5],r),d=this.vox2mm([-.5,l,-.5],r),c=this.vox2mm([-.5,-.5,o],r),m=this.vox2mm([-.5,l,o],r),A=this.vox2mm([a,-.5,-.5],r),g=this.vox2mm([a,l,-.5],r),u=this.vox2mm([a,-.5,o],r),f=this.vox2mm([a,l,o],r),p=[...c,0,0,1,...u,1,0,1,...f,1,1,1,...m,0,1,1,...h,0,0,0,...d,0,1,0,...g,1,1,0,...A,1,0,0],v=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,v);let x=[0,3,2,2,1,0,4,7,6,6,5,4,5,6,2,2,3,5,4,0,1,1,7,4,7,1,2,2,6,7,4,5,3,3,0,4];t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(x),t.STATIC_DRAW);let w=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,w),t.bufferData(t.ARRAY_BUFFER,new Float32Array(p),t.STATIC_DRAW);let C=t.createVertexArray();t.bindVertexArray(C),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,v),t.bindBuffer(t.ARRAY_BUFFER,w),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,24,0),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,t.FLOAT,!1,24,12),t.bindVertexArray(null);let b=new eP(e,w,t.TRIANGLES,x.length,v,C),y=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=Math.round(e.length/3),r=n.al(0,0,0),s=n.Ue(),a=n.Ue(),l=0,o=1;t&&(o=2);for(let t=0;t<o;t++){l=0;for(let t=0;t<i;t++){let i=n.al(e[3*t],e[3*t+1],e[3*t+2]);0===t&&(n.JG(s,i),n.JG(a,i)),n.VV(s,s,i),n.Fp(a,a,i),n.$X(i,i,r),l=Math.max(l,n.Zh(i))}if(t+1>=o)break;let h=!0;for(let e=0;e<3;++e)s[e]>r[e]&&(h=!1),a[e]<r[e]&&(h=!1);if(h)break;n.t7(r,s,a,.5),I.debug("origin moved inside volume: ",r)}let h=[s[0],s[1],s[2]],d=[a[0],a[1],a[2]];return{min:h,max:d,furthestVertexFromOrigin:l,origin:r}}([...c,...u,...f,...m,...h,...d,...g,...A]);return b.extentsMin=y.min.slice(),b.extentsMax=y.max.slice(),b.furthestVertexFromOrigin=y.furthestVertexFromOrigin,b.originNegate=n.d9(y.origin),n.tk(b.originNegate,b.originNegate),b.fieldOfViewDeObliqueMM=[i[1]*s[1],i[2]*s[2],i[3]*s[3]],b}applyOptionsUpdate(e){this.hdr.cal_min=e.cal_min,this.hdr.cal_max=e.cal_max,Object.assign(this,e)}getImageOptions(){return t_("","",this.name,this._colormap,this.opacity,this.hdr.cal_min,this.hdr.cal_max,this.trustCalMinMax,this.percentileFrac,this.ignoreZeroVoxels,this.useQFormNotSForm,this.colormapNegative,this.frame4D,this.imageType)}toUint8Array(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null!==e,i=t1({...this.hdr,vox_offset:352},t),r=e;if(t){let t=this.permRAS;if(1!==t[0]||2!==t[1]||3!==t[2]){let i=this.hdr.dims,s=[0,0,0];for(let e=0;e<3;e++)for(let i=0;i<3;i++){if(Math.abs(t[e])-1===i)s[i]=e*Math.sign(t[e])}let a=1,l=[1,1,1],o=[!1,!1,!1];for(let e=0;e<s.length;e++)for(let t=0;t<s.length;t++){if(Math.abs(s[t])===e)l[t]=a,(s[t]<0||Object.is(s[t],-0))&&(o[t]=!0),a*=i[t+1]}let n=tW.range(0,i[1]-1,1);o[0]&&(n=tW.range(i[1]-1,0,-1));for(let e=0;e<i[1];e++)n[e]*=l[0];let h=tW.range(0,i[2]-1,1);o[1]&&(h=tW.range(i[2]-1,0,-1));for(let e=0;e<i[2];e++)h[e]*=l[1];let d=tW.range(0,i[3]-1,1);o[2]&&(d=tW.range(i[3]-1,0,-1));for(let e=0;e<i[3];e++)d[e]*=l[2];let c=new Uint8Array(e),m=new Uint8Array(i[1]*i[2]*i[3]),A=0;for(let e=0;e<i[3];e++)for(let t=0;t<i[2];t++)for(let r=0;r<i[1];r++)m[A]=c[n[r]+h[t]+d[e]],A++;r=m,I.debug("drawing bytes"),I.debug(r)}}let s=t?r:new Uint8Array(this.img.buffer),a=new Uint8Array(4),l=new Uint8Array(i.length+a.length+s.length);return l.set(i),l.set(a,i.length),l.set(s,i.length+a.length),l}convertVox2Frac(e){return n.al((e[0]+.5)/this.dimsRAS[1],(e[1]+.5)/this.dimsRAS[2],(e[2]+.5)/this.dimsRAS[3])}convertFrac2Vox(e){return n.al(Math.round(e[0]*this.dims[1]-.5),Math.round(e[1]*this.dims[2]-.5),Math.round(e[2]*this.dims[3]-.5))}convertFrac2MM(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=o.al(e[0],e[1],e[2],1);return t?o.fF(i,i,this.frac2mm):o.fF(i,i,this.frac2mmOrtho),i}convertMM2Frac(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=o.al(e[0],e[1],e[2],1),r=this.dimsRAS,s=n.al(0,0,0);if(void 0===r)return s;if(!t){let e=h.d9(this.frac2mmOrtho);return h.U_(e,e),o.fF(i,i,e),s[0]=i[0],s[1]=i[1],s[2]=i[2],s}if(r[1]<1||r[2]<1||r[3]<1)return s;let a=h.d9(this.matRAS);return h.U_(a,a),h.p4(a,a),o.fF(i,i,a),s[0]=(i[0]+.5)/r[1],s[1]=(i[1]+.5)/r[2],s[2]=(i[2]+.5)/r[3],s}};var t5=((s=t5||{})[s.none=0]="none",s[s.contrast=1]="contrast",s[s.measurement=2]="measurement",s[s.pan=3]="pan",s[s.slicer3D=4]="slicer3D",s[s.callbackOnly=5]="callbackOnly",s[s.roiSelection=6]="roiSelection",s),t4={textHeight:.06,colorbarHeight:.05,crosshairWidth:1,crosshairWidthUnit:"voxels",crosshairGap:0,rulerWidth:4,show3Dcrosshair:!1,backColor:[0,0,0,1],crosshairColor:[1,0,0,1],fontColor:[.5,.5,.5,1],selectionBoxColor:[1,1,1,.5],clipPlaneColor:[.7,0,.7,.5],clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1],rulerColor:[1,0,0,.8],colorbarMargin:.05,trustCalMinMax:!0,clipPlaneHotKey:"KeyC",viewModeHotKey:"KeyV",doubleTouchTimeout:500,longTouchTimeout:1e3,keyDebounceTime:50,isNearestInterpolation:!1,isResizeCanvas:!0,atlasOutline:0,isRuler:!1,isColorbar:!1,isOrientCube:!1,tileMargin:0,multiplanarPadPixels:0,multiplanarForceRender:!1,multiplanarEqualSize:!1,multiplanarShowRender:2,isRadiologicalConvention:!1,meshThicknessOn2D:1/0,dragMode:1,yoke3Dto2DZoom:!1,isDepthPickMesh:!1,isCornerOrientationText:!1,heroImageFraction:0,heroSliceType:4,sagittalNoseLeft:!1,isSliceMM:!1,isV1SliceShader:!1,isHighResolutionCapable:!0,logLevel:"info",loadingText:"waiting for images...",isForceMouseClickToVoxelCenters:!1,dragAndDropEnabled:!0,drawingEnabled:!1,penValue:1,floodFillNeighbors:6,isFilledPen:!1,thumbnail:"",maxDrawUndoBitmaps:8,sliceType:3,meshXRay:0,isAntiAlias:null,limitFrames4D:NaN,isAdditiveBlend:!1,showLegend:!0,legendBackgroundColor:[.3,.3,.3,.5],legendTextColor:[1,1,1,1],multiplanarLayout:0,renderOverlayBlend:1,sliceMosaicString:"",centerMosaic:!1,penSize:1,clickToSegment:!1,clickToSegmentRadius:3,clickToSegmentBright:!0,clickToSegmentAutoIntensity:!1,clickToSegmentIntensityMax:NaN,clickToSegmentIntensityMin:NaN,clickToSegmentPercent:0,clickToSegmentMaxDistanceMM:Number.POSITIVE_INFINITY,clickToSegmentIs2D:!1,selectionBoxLineThickness:4,selectionBoxIsOutline:!1,scrollRequiresFocus:!1,showMeasureUnits:!0,measureTextJustify:"center",measureTextColor:[1,0,0,1],measureLineColor:[1,0,0,1],measureTextHeight:.03},t3={gamma:1,azimuth:110,elevation:10,crosshairPos:n.al(.5,.5,.5),clipPlane:[0,0,0,0],clipPlaneDepthAziElev:[2,0,0],volScaleMultiplier:1,pan2Dxyzmm:o.al(0,0,0,1),clipThick:2,clipVolumeLow:[0,0,0],clipVolumeHigh:[1,1,1]},t6=class e{constructor(){C(this,"data",{title:"Untitled document",imageOptionsArray:[],meshOptionsArray:[],opts:{...t4},previewImageDataURL:"",labels:[],encodedImageBlobs:[],encodedDrawingBlob:""}),C(this,"scene"),C(this,"volumes",[]),C(this,"meshDataObjects"),C(this,"meshes",[]),C(this,"drawBitmap",null),C(this,"imageOptionsMap",new Map),C(this,"meshOptionsMap",new Map),this.scene={onAzimuthElevationChange:()=>{},onZoom3DChange:()=>{},sceneData:{...t3,pan2Dxyzmm:o.al(0,0,0,1),crosshairPos:n.al(.5,.5,.5)},get renderAzimuth(){return this.sceneData.azimuth},set renderAzimuth(azimuth){this.sceneData.azimuth=azimuth,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get renderElevation(){return this.sceneData.elevation},set renderElevation(elevation){this.sceneData.elevation=elevation,this.onAzimuthElevationChange&&this.onAzimuthElevationChange(this.sceneData.azimuth,this.sceneData.elevation)},get volScaleMultiplier(){return this.sceneData.volScaleMultiplier},set volScaleMultiplier(scale){this.sceneData.volScaleMultiplier=scale,this.onZoom3DChange(scale)},get crosshairPos(){return this.sceneData.crosshairPos},set crosshairPos(crosshairPos){this.sceneData.crosshairPos=crosshairPos},get clipPlane(){return this.sceneData.clipPlane},set clipPlane(clipPlane){this.sceneData.clipPlane=clipPlane},get clipPlaneDepthAziElev(){return this.sceneData.clipPlaneDepthAziElev},set clipPlaneDepthAziElev(clipPlaneDepthAziElev){this.sceneData.clipPlaneDepthAziElev=clipPlaneDepthAziElev},get pan2Dxyzmm(){return this.sceneData.pan2Dxyzmm},set pan2Dxyzmm(pan2Dxyzmm){this.sceneData.pan2Dxyzmm=pan2Dxyzmm}}}get title(){return this.data.title}get previewImageDataURL(){return this.data.previewImageDataURL}set previewImageDataURL(e){this.data.previewImageDataURL=e}set title(e){this.data.title=e}get imageOptionsArray(){return this.data.imageOptionsArray}get encodedImageBlobs(){return this.data.encodedImageBlobs}get encodedDrawingBlob(){return this.data.encodedDrawingBlob}get opts(){return this.data.opts}set opts(e){this.data.opts={...e}}get labels(){return this.data.labels}set labels(e){this.data.labels=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}hasImage(e){return void 0!==this.volumes.find(t=>t.id===e.id)}hasImageFromUrl(e){return void 0!==this.data.imageOptionsArray.find(t=>t.url===e)}addImageOptions(e,t){if(!this.hasImage(e)&&!t.name){if(t.url){let e=/^(?:[a-z+]+:)?\/\//i.test(t.url)?new URL(t.url):new URL(t.url,window.location.href);t.name=e.pathname.split("/").pop(),t.name.toLowerCase().endsWith(".gz")&&(t.name=t.name.slice(0,-3)),!t.name.toLowerCase().endsWith(".nii")&&(t.name+=".nii")}else t.name="untitled.nii"}t.imageType=tJ.NII,this.data.imageOptionsArray.push(t),this.imageOptionsMap.set(e.id,this.data.imageOptionsArray.length-1)}removeImage(e){if(this.imageOptionsMap.has(e.id)){let t=this.imageOptionsMap.get(e.id);this.data.imageOptionsArray.length>t&&this.data.imageOptionsArray.splice(t,1),this.imageOptionsMap.delete(e.id)}this.volumes=this.volumes.filter(t=>t.id!==e.id)}getImageOptions(e){return this.imageOptionsMap.has(e.id)?this.data.imageOptionsArray[this.imageOptionsMap.get(e.id)]:null}json(){let e={encodedImageBlobs:[],previewImageDataURL:this.data.previewImageDataURL,imageOptionsMap:new Map},t=[];for(let t of(e.sceneData={...this.scene.sceneData},e.opts={...this.opts},this.opts.meshThicknessOn2D===1/0&&(e.opts.meshThicknessOn2D="infinity"),e.labels=[...this.data.labels],e.labels))delete t.onClick;if(e.customData=this.customData,this.volumes.length){let i=this.imageOptionsArray[0];if(!i&&(I.debug("no image options for base image"),i={name:"",colormap:"gray",opacity:1,pairedImgData:null,cal_min:NaN,cal_max:NaN,trustCalMinMax:!0,percentileFrac:.02,ignoreZeroVoxels:!1,useQFormNotSForm:!1,colormapNegative:"",colormapLabel:null,imageType:tJ.NII,frame4D:0,limitFrames4D:NaN,url:"",urlImageData:"",alphaThreshold:!1,cal_minNeg:NaN,cal_maxNeg:NaN,colorbarVisible:!0}),i.colormap=this.volumes[0].colormap,i.opacity=this.volumes[0].opacity,i.cal_max=this.volumes[0].cal_max||NaN,i.cal_min=this.volumes[0].cal_min||NaN,i){t.push(i);let r=tW.uint8tob64(this.volumes[0].toUint8Array());e.encodedImageBlobs.push(r),this.drawBitmap&&(e.encodedDrawingBlob=tW.uint8tob64(this.volumes[0].toUint8Array(this.drawBitmap))),e.imageOptionsMap.set(this.volumes[0].id,0)}else throw Error("image options for base layer not found");for(let i=1;i<this.volumes.length;i++){let r=this.volumes[i],s=this.getImageOptions(r);null===s?(I.warn("no options found for image, using default"),s={name:"",colormap:"gray",opacity:1,pairedImgData:null,cal_min:NaN,cal_max:NaN,trustCalMinMax:!0,percentileFrac:.02,ignoreZeroVoxels:!1,useQFormNotSForm:!1,colormapNegative:"",colormapLabel:null,imageType:tJ.NII,frame4D:0,limitFrames4D:NaN,url:"",urlImageData:"",alphaThreshold:!1,cal_minNeg:NaN,cal_maxNeg:NaN,colorbarVisible:!0}):!("imageType"in s)&&(s.imageType=tJ.NII),s.colormap=r.colormap,s.colormapLabel=r.colormapLabel,s.opacity=r.opacity,s.cal_max=r.cal_max||NaN,s.cal_min=r.cal_min||NaN,t.push(s);let a=tW.uint8tob64(r.toUint8Array());e.encodedImageBlobs.push(a),e.imageOptionsMap.set(r.id,i)}}e.imageOptionsArray=[...t];let i=[];for(let t of(e.connectomes=[],this.meshes)){if("connectome"===t.type){e.connectomes.push(JSON.stringify(t.json()));continue}let r={pts:t.pts,tris:t.tris,name:t.name,rgba255:Uint8Array.from(t.rgba255),opacity:t.opacity,connectome:t.connectome,dpg:t.dpg,dps:t.dps,dpv:t.dpv,meshShaderIndex:t.meshShaderIndex,layers:t.layers.map(e=>({values:e.values,nFrame4D:e.nFrame4D,frame4D:0,outlineBorder:e.outlineBorder,global_min:e.global_min,global_max:e.global_max,cal_min:e.cal_min,cal_max:e.cal_max,opacity:e.opacity,colormap:e.colormap,colormapNegative:e.colormapNegative,colormapLabel:e.colormapLabel,useNegativeCmap:e.useNegativeCmap})),hasConnectome:t.hasConnectome,edgeColormap:t.edgeColormap,edgeColormapNegative:t.edgeColormapNegative,edgeMax:t.edgeMax,edgeMin:t.edgeMin,edges:t.edges&&Array.isArray(t.edges)?[...t.edges]:[],extentsMax:t.extentsMax,extentsMin:t.extentsMin,furthestVertexFromOrigin:t.furthestVertexFromOrigin,nodeColormap:t.nodeColormap,nodeColormapNegative:t.nodeColormapNegative,nodeMaxColor:t.nodeMaxColor,nodeMinColor:t.nodeMinColor,nodeScale:t.nodeScale,legendLineThickness:t.legendLineThickness,offsetPt0:t.offsetPt0,nodes:t.nodes};t.offsetPt0&&t.offsetPt0.length>0&&(r.offsetPt0=t.offsetPt0,r.fiberGroupColormap=t.fiberGroupColormap,r.fiberColor=t.fiberColor,r.fiberDither=t.fiberDither,r.fiberRadius=t.fiberRadius,r.colormap=t.colormap),i.push(r)}return e.meshesString=JSON.stringify((0,g.q)(i)),e}async download(e,t){let i;let r=this.json(),s=JSON.stringify(r);i=t?await tW.compressStringToArrayBuffer(s):JSON.stringify(r),tW.download(i,e,t?"application/gzip":"application/json")}static deserializeMeshDataObjects(e){if(e.data.meshesString)for(let t of(e.meshDataObjects=(0,u.v)(JSON.parse(e.data.meshesString)),e.meshDataObjects))for(let e of t.layers)"colorMap"in e&&(e.colormap=e.colorMap,delete e.colorMap),"colorMapNegative"in e&&(e.colormapNegative=e.colorMapNegative,delete e.colorMapNegative)}static async loadFromUrl(t){let i;let r=await fetch(t),s=await r.arrayBuffer();return i=tW.isArrayBufferCompressed(s)?JSON.parse(await tW.decompressArrayBuffer(s)):JSON.parse(new TextDecoder().decode(s)),e.loadFromJSON(i)}static async loadFromFile(t){let i;let r=await tW.readFileAsync(t),s=new e;return i=tW.isArrayBufferCompressed(r)?await tW.decompressArrayBuffer(r):new TextDecoder().decode(r),s.data=JSON.parse(i),"infinity"===s.data.opts.meshThicknessOn2D&&(s.data.opts.meshThicknessOn2D=1/0),s.scene.sceneData={...t3,...s.data.sceneData},e.deserializeMeshDataObjects(s),s}static loadFromJSON(t){let i=new e;return i.data=t,"infinity"===i.data.opts.meshThicknessOn2D&&(i.data.opts.meshThicknessOn2D=1/0),i.scene.sceneData={...t3,...t.sceneData},e.deserializeMeshDataObjects(i),i}},t8=class{constructor(e,t,i,r,s){C(this,"text"),C(this,"style"),C(this,"points"),C(this,"anchor"),C(this,"onClick"),this.text=e,this.style=t,this.points=i,this.anchor=r||0,this.onClick=s}},t7={name:"untitled connectome",nodeColormap:"warm",nodeColormapNegative:"winter",nodeMinColor:0,nodeMaxColor:4,nodeScale:3,edgeColormap:"warm",edgeColormapNegative:"winter",edgeMin:2,edgeMax:6,edgeScale:1,legendLineThickness:0},t9=class e extends tz{constructor(e,t){super(new Float32Array([]),new Uint32Array([]),t.name,new Uint8Array([]),1,!0,e,t),C(this,"gl"),C(this,"nodesChanged"),this.gl=e,this.type="connectome",this.nodes&&this.updateLabels(),this.nodesChanged=new EventTarget}static convertLegacyConnectome(e){let t={nodes:[],edges:[],...t7};for(let i in e)i in t7&&(t[i]=e[i]);let i=e.nodes;for(let e=0;e<i.names.length;e++)t.nodes.push({name:i.names[e],x:i.X[e],y:i.Y[e],z:i.Z[e],colorValue:i.Color[e],sizeValue:i.Size[e]});for(let r=0;r<i.names.length-1;r++)for(let s=r+1;s<i.names.length;s++){let a=e.edges[r*i.names.length+s];t.edges.push({first:r,second:s,colorValue:a})}return t}static convertFreeSurferConnectome(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warm",i=!0;if("data_type"in e?"fs_pointset"!==e.data_type&&(i=!1):i=!1,!("points"in e)&&(i=!1),!i)throw Error("not a valid FreeSurfer json pointset");let r=e.points.map(e=>({name:Array.isArray(e.comments)&&e.comments.length>0&&"text"in e.comments[0]?e.comments[0].text:"",x:e.coordinates.x,y:e.coordinates.y,z:e.coordinates.z,colorValue:1,sizeValue:1,metadata:e.comments}));return{...t7,nodeColormap:t,edgeColormap:t,nodes:r,edges:[]}}updateLabels(){let e=this.nodes;if(e&&e.length>0){let t,i;let r=e.reduce((e,t)=>e.sizeValue>t.sizeValue?e:t).sizeValue;if(void 0!==this.nodeMinColor&&isFinite(this.nodeMinColor))t=this.nodeMinColor;else{t=e[0].colorValue;for(let i=1;i<e.length;i++)e[i].colorValue<t&&(t=e[i].colorValue)}if(void 0!==this.nodeMaxColor&&isFinite(this.nodeMaxColor))i=this.nodeMaxColor;else{i=e[0].colorValue;for(let t=1;t<e.length;t++)e[t].colorValue>i&&(i=e[t].colorValue)}let s=tG.colormap(this.nodeColormap,this.colormapInvert),a=tG.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this,o=this.legendLineThickness?this.legendLineThickness:0;for(let n=0;n<e.length;n++){let h=e[n].colorValue,d=!1;if(l&&h<0&&(d=!0,h=-h),t<i){if(h<t){I.warn("color value lower than min");continue}h=(h-t)/(i-t)}else h=1;let c=[s[h=4*Math.round(Math.max(Math.min(255,255*h)))],s[h+1],s[h+2],255];d&&(c=[a[h],a[h+1],a[h+2],255]),c=c.map(e=>e/255),I.debug("adding label for ",e[n]),e[n].label=new t8(e[n].name,{textColor:c,bulletScale:e[n].sizeValue/r,bulletColor:c,lineWidth:o,lineColor:c,textScale:1,textAlignment:"left",lineTerminator:"none"},[e[n].x,e[n].y,e[n].z]),I.debug("label for node:",e[n].label)}}}addConnectomeNode(e){if(I.debug("adding node",e),!this.nodes)throw Error("nodes not defined");this.nodes.push(e),this.updateLabels(),this.nodesChanged.dispatchEvent(new CustomEvent("nodeAdded",{detail:{node:e}}))}deleteConnectomeNode(e){let t=this.nodes.indexOf(e),i=this.edges;i&&(this.edges=i.filter(e=>e.first!==t&&e.second!==t)),this.nodes=this.nodes.filter(t=>t!==e),this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeDeleted",{detail:{node:e}}))}updateConnectomeNodeByIndex(e,t){this.nodes[e]=t,this.updateLabels(),this.updateConnectome(this.gl),this.nodesChanged.dispatchEvent(new CustomEvent("nodeChanged",{detail:{node:t}}))}updateConnectomeNodeByPoint(e,t){let i=this.nodes;if(!i)throw Error("Node to update does not exist");let r=i.find(t=>tW.arraysAreEqual([t.x,t.y,t.z],e));if(!r)throw Error(`Node with point ${e} to update does not exist`);let s=i.findIndex(e=>e===r);this.updateConnectomeNodeByIndex(s,t)}addConnectomeEdge(e,t,i){let r=this.edges,s=r.find(i=>(i.first===e||i.second===e)&&i.first+i.second===e+t);return s?s:(s={first:e,second:t,colorValue:i},r.push(s),this.updateConnectome(this.gl),s)}deleteConnectomeEdge(e,t){let i=this.edges,r=i.find(i=>(i.first===e||i.first===t)&&i.first+i.second===e+t);if(r)this.edges=i.filter(e=>e!==r);else throw Error(`edge between ${e} and ${t} not found`);return this.updateConnectome(this.gl),r}findClosestConnectomeNode(e,t){let i=this.nodes;if(!i||0===i.length)return null;let r=i.map((t,i)=>({node:t,distance:Math.sqrt(Math.pow(t.x-e[0],2)+Math.pow(t.y-e[1],2)+Math.pow(t.z-e[2],2)),index:i})).filter(e=>e.distance<t).sort((e,t)=>e.distance-t.distance);return r.length>0?r[0].node:null}updateConnectome(e){let t=[],i=[],r=[],s=tG.colormap(this.nodeColormap,this.colormapInvert),a=tG.colormap(this.nodeColormapNegative,this.colormapInvert),l="nodeColormapNegative"in this;void 0===this.nodeMinColor&&(this.nodeMinColor=NaN),void 0===this.nodeMaxColor&&(this.nodeMaxColor=NaN),void 0===this.edgeMin&&(this.edgeMin=NaN),void 0===this.edgeMax&&(this.edgeMax=NaN);let o=this.nodeMinColor,h=this.nodeMaxColor;if(!isFinite(o)||!isFinite(o)){let e=this.nodes;o=e[0].colorValue,h=e[0].colorValue;for(let t=0;t<e.length;t++)o=Math.min(o,e[t].colorValue),h=Math.max(h,e[t].colorValue)}let d=this.nodes,c=d.length;for(let e=0;e<c;e++){let c=d[e].sizeValue*this.nodeScale;if(c<=0)continue;let m=d[e].colorValue,A=!1;if(l&&m<0&&(A=!0,m=-m),o<h){if(m<o)continue;m=(m-o)/(h-o)}else m=1;let g=[s[m=4*Math.round(Math.max(Math.min(255,255*m)))],s[m+1],s[m+2],255];A&&(g=[a[m],a[m+1],a[m+2],255]);let u=n.al(d[e].x,d[e].y,d[e].z);eP.makeColoredSphere(i,t,r,c,u,g)}s=tG.colormap(this.edgeColormap,this.colormapInvert),a=tG.colormap(this.edgeColormapNegative,this.colormapInvert),l="edgeColormapNegative"in this;let m=this.edges;if(void 0!==m&&m.length>0){if(o=this.edgeMin,h=this.edgeMax,!isFinite(o)||!isFinite(o)){o=m[0].colorValue,h=m[0].colorValue;for(let e=0;e<m.length;e++)o=Math.min(o,m[e].colorValue),h=Math.max(h,m[e].colorValue)}for(let e of m){let c=e.colorValue,m=l&&c<0;m&&(c=-c);let A=c*this.edgeScale;if(A<=0)continue;if(o<h){if(c<o)continue;c=(c-o)/(h-o)}else c=1;let g=[s[c=4*Math.round(Math.max(Math.min(255,255*c)))],s[c+1],s[c+2],255];m&&(g=[a[c],a[c+1],a[c+2],255]);let u=n.al(d[e.first].x,d[e.first].y,d[e.first].z),f=n.al(d[e.second].x,d[e.second].y,d[e.second].z);eP.makeColoredCylinder(i,t,r,u,f,A,g)}}let A=new Float32Array(i),g=new Uint32Array(t),u=tK.getExtents(A);this.furthestVertexFromOrigin=u.mxDx,this.extentsMin=u.extentsMin,this.extentsMax=u.extentsMax;let f=this.generatePosNormClr(A,g,new Uint8Array(r));e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,Uint32Array.from(g),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,Float32Array.from(f),e.STATIC_DRAW),this.indexCount=t.length}updateMesh(e){this.updateConnectome(e),this.updateLabels()}json(){let e={};for(let t in this)(t in t7||"nodes"===t||"edges"===t)&&(e[t]=this[t]);return e}static async loadConnectomeFromUrl(t,i){let r=await fetch(i);return new e(t,await r.json())}};function ie(e,t){let i;let r=Math.floor(Math.log(e)/Math.log(10)),s=e/Math.pow(10,r);return(i=t?s<1.5?1:s<3?2:s<7?5:10:s<=1?1:s<=2?2:s<=5?5:10)*Math.pow(10,r)}function it(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=ie(t-e,!1),s=ie(r/(i-1),!0),a=Math.floor(e/s)*s,l=Math.ceil(t/s)*s;return[s,a,l,a===e&&l===t]}function ii(e,t){let i=it(e,t,3);return!i[3]&&(i=it(e,t,5)),!i[3]&&(i=it(e,t,4)),!i[3]&&(i=it(e,t,3)),!i[3]&&(i=it(e,t,5)),[i[0],i[1],i[2]]}function ir(e){return Math.PI/180*e}function is(e,t,i,r){let s=-e,a=-t;return isFinite(i)&&isFinite(r)&&(s=i,a=r),s>a&&([s,a]=[a,s]),[s,a]}function ia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,1,2],i=n.Ue();return i[0]=e[t[0]],i[1]=e[t[1]],i[2]=e[t[2]],i}function il(e){let t=o.al(1,0,0,0),i=o.Ue();return o.fF(i,t,e),i[0]}function io(e,t,i){return Math.min(Math.max(e,t),i)}function ih(e,t){let i=new Uint8Array(e.buffer),r=new Int8Array(i.buffer),s=0,a=new Uint8Array(t),l=0;for(;s<i.length;){let e=r[s];if(s++,e<0){let t=r[s];s++;for(let i=0;i<1-e;i++)a[l]=t,l++}else for(let t=0;t<e+1;t++)a[l]=r[s],s++,l++}return a}function id(e,t){return 0===e.scl_slope&&(e.scl_slope=1),t*e.scl_slope+e.scl_inter}var ic=["ASC","BYU","DFS","FSM","PIAL","ORIG","INFLATED","SMOOTHWM","SPHERE","WHITE","G","GEO","GII","ICO","MZ3","NV","OBJ","OFF","PLY","SRF","STL","TCK","TRACT","TRI","TRK","TT","TRX","VTK","X3D","JCON","JSON"],im={filename:"",isSaveDrawing:!1,volumeByIndex:0},iA=class{constructor(e=t4){for(let t in C(this,"loaders",{}),C(this,"canvas",null),C(this,"_gl",null),C(this,"isBusy",!1),C(this,"needsRefresh",!1),C(this,"colormapTexture",null),C(this,"colormapLists",[]),C(this,"volumeTexture",null),C(this,"gradientTexture",null),C(this,"gradientTextureAmount",0),C(this,"drawTexture",null),C(this,"drawUndoBitmaps",[]),C(this,"drawLut",tG.makeDrawLut("$itksnap")),C(this,"drawOpacity",.8),C(this,"clickToSegmentIsGrowing",!1),C(this,"clickToSegmentGrowingBitmap",null),C(this,"clickToSegmentXY",[0,0]),C(this,"renderDrawAmbientOcclusion",.4),C(this,"colorbarHeight",0),C(this,"drawPenLocation",[NaN,NaN,NaN]),C(this,"drawPenAxCorSag",-1),C(this,"drawFillOverwrites",!0),C(this,"drawPenFillPts",[]),C(this,"overlayTexture",null),C(this,"overlayTextureID",null),C(this,"sliceMMShader"),C(this,"sliceV1Shader"),C(this,"orientCubeShader"),C(this,"orientCubeShaderVAO",null),C(this,"rectShader"),C(this,"rectOutlineShader"),C(this,"renderShader"),C(this,"lineShader"),C(this,"line3DShader"),C(this,"passThroughShader"),C(this,"renderGradientShader"),C(this,"renderSliceShader"),C(this,"renderVolumeShader"),C(this,"pickingMeshShader"),C(this,"pickingImageShader"),C(this,"colorbarShader"),C(this,"fontShader",null),C(this,"fiberShader"),C(this,"fontTexture",null),C(this,"circleShader"),C(this,"matCapTexture",null),C(this,"bmpShader",null),C(this,"bmpTexture",null),C(this,"thumbnailVisible",!1),C(this,"bmpTextureWH",1),C(this,"growCutShader"),C(this,"orientShaderAtlasU",null),C(this,"orientShaderAtlasI",null),C(this,"orientShaderU",null),C(this,"orientShaderI",null),C(this,"orientShaderF",null),C(this,"orientShaderRGBU",null),C(this,"surfaceShader",null),C(this,"blurShader",null),C(this,"sobelShader",null),C(this,"genericVAO",null),C(this,"unusedVAO",null),C(this,"crosshairs3D",null),C(this,"DEFAULT_FONT_GLYPH_SHEET",tX),C(this,"DEFAULT_FONT_METRICS",tq),C(this,"fontMetrics"),C(this,"fontMets",null),C(this,"backgroundMasksOverlays",0),C(this,"overlayOutlineWidth",0),C(this,"overlayAlphaShader",1),C(this,"isAlphaClipDark",!1),C(this,"position"),C(this,"extentsMin"),C(this,"extentsMax"),C(this,"resizeObserver",null),C(this,"syncOpts",{"3d":!1,"2d":!1,zoomPan:!1,cal_min:!1,cal_max:!1,clipPlane:!1,gamma:!1,sliceType:!1,crosshair:!1}),C(this,"readyForSync",!1),C(this,"uiData",{mousedown:!1,touchdown:!1,mouseButtonLeftDown:!1,mouseButtonCenterDown:!1,mouseButtonRightDown:!1,mouseDepthPicker:!1,clickedTile:-1,pan2DxyzmmAtMouseDown:[0,0,0,1],prevX:0,prevY:0,currX:0,currY:0,currentTouchTime:0,lastTouchTime:0,touchTimer:null,doubleTouch:!1,isDragging:!1,dragStart:[0,0],dragEnd:[0,0],dragClipPlaneStartDepthAziElev:[0,0,0],lastTwoTouchDistance:0,multiTouchGesture:!1}),C(this,"back",null),C(this,"overlays",[]),C(this,"deferredVolumes",[]),C(this,"deferredMeshes",[]),C(this,"furthestVertexFromOrigin",100),C(this,"volScale",[]),C(this,"vox",[]),C(this,"mousePos",[0,0]),C(this,"screenSlices",[]),C(this,"cuboidVertexBuffer"),C(this,"otherNV",null),C(this,"volumeObject3D",null),C(this,"pivot3D",[0,0,0]),C(this,"furthestFromPivot",10),C(this,"currentClipPlaneIndex",0),C(this,"lastCalled",new Date().getTime()),C(this,"selectedObjectId",-1),C(this,"CLIP_PLANE_ID",1),C(this,"VOLUME_ID",254),C(this,"DISTANCE_FROM_CAMERA",-.54),C(this,"graph",{LTWH:[0,0,640,480],opacity:0,vols:[0],autoSizeMultiplanar:!1,normalizeValues:!1,isRangeCalMinMax:!1}),C(this,"meshShaders",[{Name:"Phong",Frag:ew},{Name:"Matte",Frag:eb},{Name:"Harmonic",Frag:eI},{Name:"Hemispheric",Frag:ey},{Name:"Crevice",Frag:ex},{Name:"Edge",Frag:ef},{Name:"Diffuse",Frag:ep},{Name:"Outline",Frag:eu},{Name:"Specular",Frag:ev},{Name:"Toon",Frag:eg},{Name:"Flat",Frag:eD},{Name:"Matcap",Frag:eC}]),C(this,"dragModes",{contrast:1,measurement:2,none:0,pan:3,slicer3D:4,callbackOnly:5}),C(this,"sliceTypeAxial",0),C(this,"sliceTypeCoronal",1),C(this,"sliceTypeSagittal",2),C(this,"sliceTypeMultiplanar",3),C(this,"sliceTypeRender",4),C(this,"onDragRelease",()=>{}),C(this,"onMouseUp",()=>{}),C(this,"onLocationChange",()=>{}),C(this,"onIntensityChange",()=>{}),C(this,"onClickToSegment",()=>{}),C(this,"onImageLoaded",()=>{}),C(this,"onMeshLoaded",()=>{}),C(this,"onFrameChange",()=>{}),C(this,"onError",()=>{}),C(this,"onColormapChange",()=>{}),C(this,"onInfo",()=>{}),C(this,"onWarn",()=>{}),C(this,"onDebug",()=>{}),C(this,"onVolumeAddedFromUrl",()=>{}),C(this,"onVolumeWithUrlRemoved",()=>{}),C(this,"onVolumeUpdated",()=>{}),C(this,"onMeshAddedFromUrl",()=>{}),C(this,"onMeshAdded",()=>{}),C(this,"onMeshWithUrlRemoved",()=>{}),C(this,"onZoom3DChange",()=>{}),C(this,"onAzimuthElevationChange",()=>{}),C(this,"onClipPlaneChange",()=>{}),C(this,"onCustomMeshShaderAdded",()=>{}),C(this,"onMeshShaderChanged",()=>{}),C(this,"onMeshPropertyChanged",()=>{}),C(this,"onDocumentLoaded",()=>{}),C(this,"document",new t6),C(this,"mediaUrlMap",new Map),C(this,"initialized",!1),C(this,"currentDrawUndoBitmap"),C(this,"loadingText"),e)"function"==typeof e[t]?this[t]=e[t]:this.opts[t]=void 0===t4[t]?t4[t]:e[t];this.opts.isHighResolutionCapable?this.uiData.dpr=window.devicePixelRatio||1:this.uiData.dpr=1,this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,this.opts.drawingEnabled&&this.createEmptyDrawing(),this.opts.thumbnail.length>0&&(this.thumbnailVisible=!0),this.loadingText=this.opts.loadingText,I.setLogLevel(this.opts.logLevel)}get scene(){return this.document.scene}get opts(){return this.document.opts}get sliceMosaicString(){return this.document.opts.sliceMosaicString||""}set sliceMosaicString(e){this.document.opts.sliceMosaicString=e}get volumes(){return this.document.volumes}set volumes(e){this.document.volumes=e}get meshes(){return this.document.meshes}set meshes(e){this.document.meshes=e}get drawBitmap(){return this.document.drawBitmap}set drawBitmap(e){this.document.drawBitmap=e}get volScaleMultiplier(){return this.scene.volScaleMultiplier}set volScaleMultiplier(e){this.setScale(e)}async saveScene(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"niivue.png",t=this.canvas;if(!t)throw Error("canvas not defined");this.drawScene(),t.toBlob(t=>{if(!!t)""===e&&(e=(e=`niivue-screenshot-${new Date().toString()}.png`).replace(/\s/g,"_")),!function(e,t){let i=document.createElement("a");document.body.appendChild(i),i.style.display="none";let r=window.URL.createObjectURL(e);i.href=r,i.download=t,i.click(),i.remove()}(t,e)})}async attachTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return await this.attachToCanvas(document.getElementById(e),t),I.debug("attached to element with id: ",e),this}async attachToCanvas(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.canvas=e,null===t&&(t=navigator.hardwareConcurrency>6,I.debug("AntiAlias ",t," Threads ",navigator.hardwareConcurrency)),this.gl=this.canvas.getContext("webgl2",{alpha:!0,antialias:t}),I.info("NIIVUE VERSION ",b),this.canvas.parentElement.style.backgroundColor="black",this.opts.isResizeCanvas&&(this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight,window.addEventListener("resize",()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver=new ResizeObserver(()=>{requestAnimationFrame(()=>{this.resizeListener()})}),this.resizeObserver.observe(this.canvas.parentElement)),this.registerInteractions(),await this.init(),this.drawScene(),this}syncWith(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{"2d":!0,"3d":!0};!(e instanceof Array)&&(e=[e]),this.otherNV=e,this.syncOpts={...t}}broadcastTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{"2d":!0,"3d":!0};!(e instanceof Array)&&(e=[e]),this.otherNV=e,this.syncOpts=t}doSync3d(e){e.scene.renderAzimuth=this.scene.renderAzimuth,e.scene.renderElevation=this.scene.renderElevation,e.scene.volScaleMultiplier=this.scene.volScaleMultiplier}doSync2d(e){let t=this.frac2mm(this.scene.crosshairPos);e.scene.crosshairPos=e.mm2frac(t),e.scene.pan2Dxyzmm=o.d9(this.scene.pan2Dxyzmm)}doSyncGamma(e){let t=this.scene.gamma;t!==e.scene.gamma&&e.setGamma(t)}doSyncZoomPan(e){e.scene.pan2Dxyzmm=o.d9(this.scene.pan2Dxyzmm)}doSyncCrosshair(e){let t=this.frac2mm(this.scene.crosshairPos);e.scene.crosshairPos=e.mm2frac(t)}doSyncCalMin(e){this.volumes[0].cal_min!==e.volumes[0].cal_min&&(e.volumes[0].cal_min=this.volumes[0].cal_min,e.updateGLVolume())}doSyncCalMax(e){this.volumes[0].cal_max!==e.volumes[0].cal_max&&(e.volumes[0].cal_max=this.volumes[0].cal_max,e.updateGLVolume())}doSyncSliceType(e){e.setSliceType(this.opts.sliceType)}doSyncClipPlane(e){e.setClipPlane(this.scene.clipPlaneDepthAziElev)}sync(){if(!!this.gl&&!!this.otherNV&&void 0!==this.otherNV&&!!this.gl.canvas.matches(":focus"))for(let e=0;e<this.otherNV.length;e++){if(this.otherNV[e]!==this)this.syncOpts.gamma&&this.doSyncGamma(this.otherNV[e]),this.syncOpts.crosshair&&this.doSyncCrosshair(this.otherNV[e]),this.syncOpts.zoomPan&&this.doSyncZoomPan(this.otherNV[e]),this.syncOpts.sliceType&&this.doSyncSliceType(this.otherNV[e]),this.syncOpts.cal_min&&this.doSyncCalMin(this.otherNV[e]),this.syncOpts.cal_max&&this.doSyncCalMax(this.otherNV[e]),this.syncOpts.clipPlane&&this.doSyncClipPlane(this.otherNV[e]),this.syncOpts["2d"]&&this.doSync2d(this.otherNV[e]),this.syncOpts["3d"]&&this.doSync3d(this.otherNV[e]),this.otherNV[e].drawScene(),this.otherNV[e].createOnLocationChange()}}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,i)=>e===t[i])}resizeListener(){if(!!this.canvas&&!!this.gl){if(!this.opts.isResizeCanvas){this.opts.isHighResolutionCapable&&(I.warn("isHighResolutionCapable requires isResizeCanvas"),this.opts.isHighResolutionCapable=!1),this.uiData.dpr=1,this.drawScene();return}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.display="block",this.opts.isHighResolutionCapable?(this.uiData.dpr=window.devicePixelRatio||1,I.debug("devicePixelRatio: "+this.uiData.dpr)):this.uiData.dpr=1,"width"in this.canvas.parentElement?(this.canvas.width=this.canvas.parentElement.width*this.uiData.dpr,this.canvas.height=this.canvas.parentElement.height*this.uiData.dpr):(this.canvas.width=this.canvas.offsetWidth*this.uiData.dpr,this.canvas.height=this.canvas.offsetHeight*this.uiData.dpr),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.drawScene()}}getRelativeMousePosition(e,t){if(!(t=t||e.target))return;let i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}getNoPaddingNoBorderCanvasRelativeMousePosition(e,t){return t=t||e.target,this.getRelativeMousePosition(e,t)}mouseContextMenuListener(e){e.preventDefault()}mouseDownListener(e){e.preventDefault(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,this.uiData.mousedown=!0,this.setDragStart(0,0),this.setDragEnd(0,0),I.debug("mouse down"),I.debug(e);let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;let[i,r]=[t.x*this.uiData.dpr,t.y*this.uiData.dpr];this.opts.clickToSegment&&(this.clickToSegmentXY=[i,r]);let s=this.getLabelAtPoint([i,r]);if(s){if(s.onClick){s.onClick(s);return}for(let e of this.meshes){if("connectome"===e.type)for(let t of e.nodes)t.label===s&&(this.scene.crosshairPos=this.mm2frac([t.x,t.y,t.z]),this.updateGLVolume(),this.drawScene())}}this.uiData.clickedTile=this.tileIndex(i,r),0===e.button&&e.shiftKey?(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(e)):0===e.button?(this.uiData.mouseButtonLeftDown=!0,this.mouseLeftButtonHandler(e)):2===e.button?(this.uiData.mouseButtonRightDown=!0,this.mouseRightButtonHandler(e)):1===e.button&&(this.uiData.mouseButtonCenterDown=!0,this.mouseCenterButtonHandler(e))}mouseLeftButtonHandler(e){let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);this.mouseDown(t.x,t.y),this.mouseClick(t.x,t.y)}mouseCenterButtonHandler(e){let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(this.mousePos=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],0!==this.opts.dragMode)this.setDragStart(t.x,t.y),!this.uiData.isDragging&&(this.uiData.pan2DxyzmmAtMouseDown=o.d9(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev}mouseRightButtonHandler(e){let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(this.mousePos=[t.x*this.uiData.dpr,t.y*this.uiData.dpr],0!==this.opts.dragMode)this.setDragStart(t.x,t.y),!this.uiData.isDragging&&(this.uiData.pan2DxyzmmAtMouseDown=o.d9(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.dragClipPlaneStartDepthAziElev=this.scene.clipPlaneDepthAziElev}calculateMinMaxVoxIdx(e){if(e.length>2)throw Error("array must not contain more than two values");return[Math.floor(Math.min(e[0],e[1])),Math.floor(Math.max(e[0],e[1]))]}calculateNewRange(){let{volIdx:e=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(4===this.opts.sliceType&&this.sliceMosaicString.length<1||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;let t=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]);if(t[0]<0)return;let i=this.frac2vox(t,e);if((t=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]))[0]<0)return;let r=this.frac2vox(t,e),s=-Number.MAX_VALUE,a=Number.MAX_VALUE,l=this.calculateMinMaxVoxIdx([i[0],r[0]]),o=this.calculateMinMaxVoxIdx([i[1],r[1]]),n=this.calculateMinMaxVoxIdx([i[2],r[2]]);i[0]-r[0]==0?l[1]=i[0]+1:i[1]-r[1]==0?o[1]=i[1]+1:i[2]-r[2]==0&&(n[1]=i[2]+1);let h=this.volumes[e].hdr,d=this.volumes[e].img;if(!h||!d)return;let c=h.dims[1],m=h.dims[2];for(let e=n[0];e<n[1];e++){let t=e*c*m;for(let e=o[0];e<o[1];e++){let i=e*c;for(let e=l[0];e<l[1];e++){let r=t+i+e;a>d[r]&&(a=d[r]),s<d[r]&&(s=d[r])}}}if(a>=s)return;let A=id(h,a),g=id(h,s);this.volumes[e].cal_min=A,this.volumes[e].cal_max=g,this.onIntensityChange(this.volumes[e])}generateMouseUpCallback(e,t){let i=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]),r=this.tileIndex(this.uiData.dragEnd[0],this.uiData.dragEnd[1]),s=-1;i===r&&(s=r);let a=-1;s>=0&&(a=this.screenSlices[s].axCorSag);let l=this.frac2mm(e),o=this.frac2mm(t),h=n.Ue();n.lu(h,n.al(l[0],l[1],l[2]),n.al(o[0],o[1],o[2]));let d=n.Zh(h),c=this.frac2vox(e),m=this.frac2vox(t);this.onDragRelease({fracStart:e,fracEnd:t,voxStart:c,voxEnd:m,mmStart:l,mmEnd:o,mmLength:d,tileIdx:s,axCorSag:a})}mouseUpListener(){var e;let t={mouseButtonRightDown:this.uiData.mouseButtonRightDown,mouseButtonCenterDown:this.uiData.mouseButtonCenterDown,isDragging:this.uiData.isDragging,mousePos:this.mousePos,fracPos:this.canvasPos2frac(this.mousePos)};this.uiData.mousedown=!1,this.uiData.mouseButtonRightDown=!1;let i=this.uiData.mouseButtonCenterDown;if(this.uiData.mouseButtonCenterDown=!1,this.uiData.mouseButtonLeftDown=!1,this.drawPenFillPts.length>0)this.drawPenFilled();else if(this.drawPenAxCorSag>=0&&this.opts.clickToSegment){let e=this.sumBitmap(this.drawBitmap);this.sumBitmap(this.clickToSegmentGrowingBitmap)>e&&this.updateBitmapFromClickToSegment()}if(this.drawAddUndoBitmap(),this.drawPenLocation=[NaN,NaN,NaN],this.drawPenAxCorSag=-1,e=this.onMouseUp,Object.prototype.toString.call(e).indexOf("Function")>-1)this.onMouseUp(t);if(this.uiData.isDragging){this.uiData.isDragging=!1,5===this.opts.dragMode&&this.drawScene();let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),t=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);if(this.generateMouseUpCallback(e,t),6===this.opts.dragMode||1!==this.opts.dragMode||i||this.uiData.dragStart[0]===this.uiData.dragEnd[0]&&this.uiData.dragStart[1]===this.uiData.dragEnd[1])return;this.calculateNewRange({volIdx:0}),this.refreshLayers(this.volumes[0],0)}this.drawScene()}checkMultitouch(e){if(this.uiData.touchdown&&!this.uiData.multiTouchGesture){let t=this.canvas.getBoundingClientRect();this.mouseDown(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top),this.mouseClick(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top)}}touchStartListener(e){e.preventDefault(),!this.uiData.touchTimer&&(this.uiData.touchTimer=setTimeout(()=>{this.resetBriCon(e)},this.opts.longTouchTimeout)),this.uiData.touchdown=!0,this.uiData.currentTouchTime=new Date().getTime();let t=this.uiData.currentTouchTime-this.uiData.lastTouchTime;if(t<this.opts.doubleTouchTimeout&&t>0){this.uiData.doubleTouch=!0,this.setDragStart(e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,e.targetTouches[0].clientY-e.target.getBoundingClientRect().top),this.resetBriCon(e),this.uiData.lastTouchTime=this.uiData.currentTouchTime;return}this.uiData.doubleTouch=!1,this.setDragStart(0,0),this.setDragEnd(0,0),this.uiData.lastTouchTime=this.uiData.currentTouchTime;this.uiData.touchdown&&e.touches.length<2?this.uiData.multiTouchGesture=!1:this.uiData.multiTouchGesture=!0,setTimeout(this.checkMultitouch.bind(this),1,e)}touchEndListener(e){if(e.preventDefault(),this.uiData.touchdown=!1,this.uiData.lastTwoTouchDistance=0,this.uiData.multiTouchGesture=!1,this.uiData.touchTimer&&(clearTimeout(this.uiData.touchTimer),this.uiData.touchTimer=null),this.uiData.isDragging){this.uiData.isDragging=!1,1===this.opts.dragMode&&(this.calculateNewRange(),this.refreshLayers(this.volumes[0],0));let e=this.canvasPos2frac([this.uiData.dragStart[0],this.uiData.dragStart[1]]),t=this.canvasPos2frac([this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);this.generateMouseUpCallback(e,t)}this.mouseUpListener()}mouseMoveListener(e){if(this.uiData.mousedown){let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;let i=t.x*this.uiData.dpr,r=t.y*this.uiData.dpr;if(this.tileIndex(i,r)===this.uiData.clickedTile)this.uiData.mouseButtonLeftDown?(this.mouseMove(t.x,t.y),this.mouseClick(t.x,t.y)):(this.uiData.mouseButtonRightDown||this.uiData.mouseButtonCenterDown)&&this.setDragEnd(t.x,t.y),this.drawScene(),this.uiData.prevX=this.uiData.currX,this.uiData.prevY=this.uiData.currY}else if(!this.uiData.mousedown&&this.opts.clickToSegment){let t=this.getNoPaddingNoBorderCanvasRelativeMousePosition(e,this.gl.canvas);if(!t)return;let i=t.x*this.uiData.dpr,r=t.y*this.uiData.dpr;this.mousePos=[i,r],this.drawScene()}}resetBriCon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.uiData.isDragging)return;let t=!1;4===this.opts.sliceType&&(t=!0);let i=0,r=0;if(null!==e&&("targetTouches"in e?(i=e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,r=e.targetTouches[0].clientY-e.target.getBoundingClientRect().top):(i=e.offsetX,r=e.offsetY),i*=this.uiData.dpr,r*=this.uiData.dpr,this.inRenderTile(i,r)>=0&&(t=!0)),t){this.uiData.mouseDepthPicker=!0,this.drawScene(),this.drawScene();return}if(4!==this.opts.dragMode&&!(this.volumes.length<1)&&!this.uiData.doubleTouch)this.volumes[0].cal_min=this.volumes[0].robust_min,this.volumes[0].cal_max=this.volumes[0].robust_max,this.onIntensityChange(this.volumes[0]),this.refreshLayers(this.volumes[0],0),this.drawScene()}setDragStart(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.uiData.dragStart[0]=e,this.uiData.dragStart[1]=t}setDragEnd(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.uiData.dragEnd[0]=e,this.uiData.dragEnd[1]=t}touchMoveListener(e){if(this.uiData.touchdown&&e.touches.length<2){let t=this.canvas.getBoundingClientRect();if(!this.uiData.isDragging&&(this.uiData.pan2DxyzmmAtMouseDown=o.d9(this.scene.pan2Dxyzmm)),this.uiData.isDragging=!0,this.uiData.doubleTouch&&this.uiData.isDragging){this.setDragEnd(e.targetTouches[0].clientX-e.target.getBoundingClientRect().left,e.targetTouches[0].clientY-e.target.getBoundingClientRect().top),this.drawScene();return}this.mouseClick(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top),this.mouseMove(e.touches[0].clientX-t.left,e.touches[0].clientY-t.top)}else this.handlePinchZoom(e)}handlePinchZoom(e){if(2===e.targetTouches.length&&2===e.changedTouches.length){let t=Math.hypot(e.touches[0].pageX-e.touches[1].pageX,e.touches[0].pageY-e.touches[1].pageY),i=this.canvas.getBoundingClientRect();this.mousePos=[e.touches[0].clientX-i.left,e.touches[0].clientY-i.top],t<this.uiData.lastTwoTouchDistance?this.sliceScroll2D(-.01,e.touches[0].clientX-i.left,e.touches[0].clientY-i.top):this.sliceScroll2D(.01,e.touches[0].clientX-i.left,e.touches[0].clientY-i.top),this.uiData.lastTwoTouchDistance=t}}keyUpListener(e){if(e.code===this.opts.clipPlaneHotKey){let e=new Date().getTime();if(e-this.lastCalled>this.opts.keyDebounceTime){switch(this.currentClipPlaneIndex=(this.currentClipPlaneIndex+1)%7,this.currentClipPlaneIndex){case 0:this.scene.clipPlaneDepthAziElev=[2,0,0];break;case 1:this.scene.clipPlaneDepthAziElev=[0,270,0];break;case 2:this.scene.clipPlaneDepthAziElev=[0,90,0];break;case 3:this.scene.clipPlaneDepthAziElev=[0,0,0];break;case 4:this.scene.clipPlaneDepthAziElev=[0,180,0];break;case 5:this.scene.clipPlaneDepthAziElev=[0,0,-90];break;case 6:this.scene.clipPlaneDepthAziElev=[0,0,90]}this.setClipPlane(this.scene.clipPlaneDepthAziElev)}this.lastCalled=e}else if(e.code===this.opts.viewModeHotKey){let e=new Date().getTime();e-this.lastCalled>this.opts.keyDebounceTime&&(this.setSliceType((this.opts.sliceType+1)%5),this.lastCalled=e)}}keyDownListener(e){"KeyH"===e.code&&4===this.opts.sliceType?this.setRenderAzimuthElevation(this.scene.renderAzimuth-1,this.scene.renderElevation):"KeyL"===e.code&&4===this.opts.sliceType?this.setRenderAzimuthElevation(this.scene.renderAzimuth+1,this.scene.renderElevation):"KeyJ"===e.code&&4===this.opts.sliceType?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation+1):"KeyK"===e.code&&4===this.opts.sliceType?this.setRenderAzimuthElevation(this.scene.renderAzimuth,this.scene.renderElevation-1):"KeyH"===e.code&&4!==this.opts.sliceType?this.moveCrosshairInVox(-1,0,0):"KeyL"===e.code&&4!==this.opts.sliceType?this.moveCrosshairInVox(1,0,0):"KeyU"===e.code&&4!==this.opts.sliceType&&e.ctrlKey?this.moveCrosshairInVox(0,0,1):"KeyD"===e.code&&4!==this.opts.sliceType&&e.ctrlKey?this.moveCrosshairInVox(0,0,-1):"KeyJ"===e.code&&4!==this.opts.sliceType?this.moveCrosshairInVox(0,-1,0):"KeyK"===e.code&&4!==this.opts.sliceType?this.moveCrosshairInVox(0,1,0):"KeyM"===e.code&&4!==this.opts.sliceType?(this.opts.dragMode++,this.opts.dragMode>=4&&(this.opts.dragMode=0),I.info("drag mode changed to ",t5[this.opts.dragMode])):"ArrowLeft"===e.code?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D-1):"ArrowRight"===e.code?this.setFrame4D(this.volumes[0].id,this.volumes[0].frame4D+1):"Slash"===e.code&&e.shiftKey&&alert(`NIIVUE VERSION: ${b}`)}wheelListener(e){if(e.preventDefault(),e.stopPropagation(),this.thumbnailVisible)return;let t=this.uiData.dragStart.reduce((e,t)=>e+t,0),i=this.uiData.dragEnd.reduce((e,t)=>e+t,0);if(6===this.opts.dragMode&&t>0&&i>0){let t=e.deltaY>0?1:-1;this.uiData.dragStart[0]<this.uiData.dragEnd[0]?(this.uiData.dragStart[0]-=t,this.uiData.dragEnd[0]+=t):(this.uiData.dragStart[0]+=t,this.uiData.dragEnd[0]-=t),this.uiData.dragStart[1]<this.uiData.dragEnd[1]?(this.uiData.dragStart[1]-=t,this.uiData.dragEnd[1]+=t):(this.uiData.dragStart[1]+=t,this.uiData.dragEnd[1]-=t),this.uiData.isDragging=!0,this.drawScene(),this.uiData.isDragging=!1;let i=this.tileIndex(this.uiData.dragStart[0],this.uiData.dragStart[1]);this.generateMouseUpCallback(this.screenXY2TextureFrac(this.uiData.dragStart[0],this.uiData.dragStart[1],i),this.screenXY2TextureFrac(this.uiData.dragEnd[0],this.uiData.dragEnd[1],i));return}let r=this.canvas.getBoundingClientRect();e.deltaY<0?this.sliceScroll2D(-.01,e.clientX-r.left,e.clientY-r.top):this.sliceScroll2D(.01,e.clientX-r.left,e.clientY-r.top)}registerInteractions(){if(!this.canvas)throw Error("canvas undefined");this.canvas.addEventListener("mousedown",this.mouseDownListener.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUpListener.bind(this)),this.canvas.addEventListener("mousemove",this.mouseMoveListener.bind(this)),this.canvas.addEventListener("touchstart",this.touchStartListener.bind(this)),this.canvas.addEventListener("touchend",this.touchEndListener.bind(this)),this.canvas.addEventListener("touchmove",this.touchMoveListener.bind(this)),this.canvas.addEventListener("wheel",this.wheelListener.bind(this)),this.canvas.addEventListener("contextmenu",this.mouseContextMenuListener.bind(this)),this.canvas.addEventListener("dblclick",this.resetBriCon.bind(this)),this.canvas.addEventListener("dragenter",this.dragEnterListener.bind(this),!1),this.canvas.addEventListener("dragover",this.dragOverListener.bind(this),!1),this.canvas.addEventListener("drop",this.dropListener.bind(this),!1),this.canvas.setAttribute("tabindex","0"),this.canvas.addEventListener("keyup",this.keyUpListener.bind(this),!1),this.canvas.addEventListener("keydown",this.keyDownListener.bind(this),!1)}dragEnterListener(e){e.stopPropagation(),e.preventDefault()}dragOverListener(e){e.stopPropagation(),e.preventDefault()}getFileExt(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];I.debug("fullname: ",e);let i=/(?:\.([^.]+))?$/,r=i.exec(e)[1];if("GZ"===(r=r.toUpperCase()))r=(r=i.exec(e.slice(0,-3))[1]).toUpperCase();else if("CBOR"===r){let t=r;r=(r=i.exec(e.slice(0,-5))[1]).toUpperCase(),r=`${r}.${t}`}return t?r:r.toLowerCase()}async addVolumeFromUrl(e){let t=await t2.loadFromUrl(e);return this.document.addImageOptions(t,e),t.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(t,e.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(e,t),this.addVolume(t),t}async addVolumesFromUrl(e){let t=e.map(async e=>{let t=this.getFileExt(e.name||e.url);if(this.loaders[t]){let i=e.url,r=this.loaders[t].toExt,s=e.name||e.url;if(s=s.split("/").pop(),"string"==typeof e.url){let t=e.url;try{let e=await fetch(t);if(!e.ok)throw Error(`Failed to load file: ${e.statusText}`);i=await e.arrayBuffer()}catch(e){throw Error(`Failed to load url ${t}: ${e}`)}}let a=await this.loaders[t].loader(i);e.url=a,e.name=`${s}.${r}`}let i={url:e.url,headers:e.headers,name:e.name,colormap:e.colormap?e.colormap:e.colorMap,colormapNegative:e.colormapNegative?e.colormapNegative:e.colorMapNegative,opacity:e.opacity,urlImgData:e.urlImgData,cal_min:e.cal_min,cal_max:e.cal_max,trustCalMinMax:this.opts.trustCalMinMax,isManifest:e.isManifest,frame4D:e.frame4D,limitFrames4D:e.limitFrames4D||this.opts.limitFrames4D,colorbarVisible:e.colorbarVisible},r=await t2.loadFromUrl(i);return this.document.addImageOptions(r,i),r.onColormapChange=this.onColormapChange,this.mediaUrlMap.set(r,i.url),this.onVolumeAddedFromUrl&&this.onVolumeAddedFromUrl(i,r),r}),i=await Promise.all(t);for(let e=0;e<i.length;e++)this.addVolume(i[e]);return i}getMediaByUrl(e){return[...this.mediaUrlMap.entries()].filter(t=>t[1]===e).map(e=>e[0]).pop()}removeVolumeByUrl(e){let t=this.getMediaByUrl(e);if(t)this.removeVolume(t);else throw Error("No volume with URL present")}readDirectory(e){let t=e.createReader(),i=[],r=async e=>{let t=[],i=async e=>new Promise((t,i)=>e.file(t,i));for(let r=0;r<e.length;r++)t.push(await i(e[r]));return t},s=()=>{t.readEntries(t=>{t.length?(i=i.concat(t),s()):r(i).then(t=>{t2.loadFromFile({file:t,name:e.name,urlImgData:null,imageType:tJ.DCM_FOLDER}).then(e=>{this.addVolume(e),this.setDrawingEnabled(!0)}).catch(e=>{throw e})}).catch(e=>{throw e})})};return s(),i}isMeshExt(e){let t=this.getFileExt(e);return I.debug("dropped ext"),I.debug(t),ic.includes(t)}async loadFromArrayBuffer(e,t){let i=this.getFileExt(t);if(ic.includes(i)){await this.addMeshFromUrl({url:t,buffer:e});return}let r=t_(t);r.buffer=e,r.name=t,await this.addVolumeFromUrl(r)}async loadFromFile(e){let t=this.getFileExt(e.name);if(ic.includes(t)){await tz.loadFromFile({file:e,gl:this.gl,name:e.name}).then(e=>{this.addMesh(e)});return}await t2.loadFromFile({file:e,name:e.name}).then(e=>{this.addVolume(e)})}useLoader(e,t,i){this.loaders={...this.loaders,[t.toUpperCase()]:{loader:e,toExt:i}}}dropListener(e){if(e.stopPropagation(),e.preventDefault(),!this.opts.dragAndDropEnabled)return;let t=e.dataTransfer;if(!t)return;let i=t.getData("text/uri-list");if(i){[].push(i);let e=t_(i),t=this.getFileExt(i);I.debug("dropped ext"),I.debug(t),ic.includes(t)?this.addMeshFromUrl({url:i}).catch(e=>{throw e}):"NVD"===t?this.loadDocumentFromUrl(i).catch(e=>{throw e}):this.addVolumeFromUrl(e).catch(e=>{throw e})}else{let i=t.items;if(i.length>0)for(let t of(!e.shiftKey&&!e.altKey&&(this.volumes=[],this.overlays=[],this.meshes=[]),this.closeDrawing(),Array.from(i))){let r=t.webkitGetAsEntry();if(I.debug(r),!r)throw Error("could not get entry from file");if(r.isFile){let t;let s=this.getFileExt(r.name);if("PNG"===s){r.file(e=>{this.loadBmpTexture(e).catch(e=>{throw e})});continue}if(-1!==r.name.lastIndexOf("HEAD"))for(let e of Array.from(i)){let i=e.webkitGetAsEntry();if(!i)throw Error("could not get paired entry");let s=r.name.substring(0,r.name.lastIndexOf("HEAD"));s===i.name.substring(0,i.name.lastIndexOf("BRIK"))&&(t=i)}if(-1!==r.name.lastIndexOf("BRIK"))continue;if(ic.includes(s)){r.file(e=>{tz.loadFromFile({file:e,gl:this.gl,name:e.name}).then(e=>{this.addMesh(e)}).catch(e=>{throw e})});continue}if("NVD"===s){r.file(e=>{t6.loadFromFile(e).then(e=>{this.loadDocument(e),I.debug("loaded document")}).catch(e=>{throw e})});break}r.file(i=>{t?t.file(e=>{t2.loadFromFile({file:i,urlImgData:e,limitFrames4D:this.opts.limitFrames4D}).then(e=>{this.addVolume(e)}).catch(e=>{throw e})}):t2.loadFromFile({file:i,urlImgData:t,limitFrames4D:this.opts.limitFrames4D}).then(t=>{e.altKey?(I.debug("alt key detected: assuming this is a drawing overlay"),this.drawClearAllUndoBitmaps(),this.loadDrawing(t)):this.addVolume(t)}).catch(e=>{throw e})})}else r.isDirectory&&this.readDirectory(r)}}this.drawScene()}setMultiplanarPadPixels(e){this.opts.multiplanarPadPixels=e,this.drawScene()}setMultiplanarLayout(e){"string"==typeof e&&(e=parseInt(e)),this.opts.multiplanarLayout=e,this.drawScene()}setCornerOrientationText(e){this.opts.isCornerOrientationText=e,this.updateGLVolume()}setHeroImage(e){this.opts.heroImageFraction=e,this.drawScene()}setRadiologicalConvention(e){this.opts.isRadiologicalConvention=e,this.updateGLVolume()}setDefaults(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let t in this.document.opts={...t4},this.scene.sceneData={...t3},e)"function"==typeof e[t]?this[t]=e[t]:this.opts[t]=void 0===t4[t]?t4[t]:e[t];if(this.scene.pan2Dxyzmm=[0,0,0,1],t&&this.volumes&&this.volumes.length>0)for(let e=0;e<this.volumes.length;e++)this.volumes[e].cal_min=this.volumes[e].robust_min,this.volumes[e].cal_max=this.volumes[e].robust_max;this.updateGLVolume()}setMeshThicknessOn2D(e){this.opts.meshThicknessOn2D=e,this.updateGLVolume()}setSliceMosaicString(e){this.sliceMosaicString=e,this.updateGLVolume()}setSliceMM(e){this.opts.isSliceMM=e,this.updateGLVolume()}setAdditiveBlend(e){this.opts.isAdditiveBlend=e,this.updateGLVolume()}getRadiologicalConvention(){return this.opts.isRadiologicalConvention}setHighResolutionCapable(e){this.opts.isHighResolutionCapable=e,e&&!this.opts.isResizeCanvas&&(I.warn("isHighResolutionCapable requires isResizeCanvas"),this.opts.isHighResolutionCapable=!1),!this.opts.isHighResolutionCapable&&(this.uiData.dpr=1),this.resizeListener(),this.drawScene()}addVolume(e){this.volumes.push(e);let t=1===this.volumes.length?0:this.volumes.length-1;this.setVolume(e,t),this.onImageLoaded(e),I.debug("loaded volume",e.name),I.debug(e)}addMesh(e){this.meshes.push(e);let t=1===this.meshes.length?0:this.meshes.length-1;this.setMesh(e,t),this.onMeshLoaded(e)}getVolumeIndexByID(e){let t=this.volumes.length;for(let i=0;i<t;i++)if(this.volumes[i].id===e)return i;return -1}drawAddUndoBitmap(){if(!this.drawBitmap||this.drawBitmap.length<1){I.debug("drawAddUndoBitmap error: No drawing open");return}this.currentDrawUndoBitmap++,this.currentDrawUndoBitmap>=this.opts.maxDrawUndoBitmaps&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap]=function(e){let t=e.length,i=0,r=new Uint8Array(t+Math.ceil(.01*t)),s=new Int8Array(r.buffer),a=0;for(;i<t;){let l=e[i];i++;let o=1;for(;o<129&&i<t&&e[i]===l;)i++,o++;if(o>1){s[a]=-o+1,r[++a]=l,a++;continue}for(;i<t&&!(o>127)&&(!(i+2<t)||l===e[i]||e[i+2]!==e[i]||e[i+1]!==e[i]);){;l=e[i],i++,o++}r[a]=o-1,a++;for(let t=0;t<o;t++)r[a]=e[i-o+t],a++}return I.info("PackBits "+t+" -> "+a+" bytes (x"+t/a+")"),r.slice(0,a)}(this.drawBitmap)}drawClearAllUndoBitmaps(){if(this.currentDrawUndoBitmap=this.opts.maxDrawUndoBitmaps,!!this.drawUndoBitmaps&&!(this.drawUndoBitmaps.length<1))for(let e=this.drawUndoBitmaps.length-1;e>=0;e--)this.drawUndoBitmaps[e]=new Uint8Array}drawUndo(){if(this.drawUndoBitmaps.length<1){I.debug("undo bitmaps not loaded");return}if(this.currentDrawUndoBitmap--,this.currentDrawUndoBitmap<0&&(this.currentDrawUndoBitmap=this.drawUndoBitmaps.length-1),this.currentDrawUndoBitmap>=this.drawUndoBitmaps.length&&(this.currentDrawUndoBitmap=0),this.drawUndoBitmaps[this.currentDrawUndoBitmap].length<2){I.debug("drawUndo is misbehaving");return}this.drawBitmap=ih(this.drawUndoBitmaps[this.currentDrawUndoBitmap],this.drawBitmap.length),this.refreshDrawing(!0)}loadDrawing(e){if(this.drawBitmap&&I.debug("Overwriting open drawing!"),!this.back)throw Error("back undefined");this.drawClearAllUndoBitmaps();let t=e.hdr.dims;if(t[1]!==this.back.hdr.dims[1]||t[2]!==this.back.hdr.dims[2]||t[3]!==this.back.hdr.dims[3])return I.debug("drawing dimensions do not match background image"),!1;e.img.constructor!==Uint8Array&&I.debug("Drawings should be UINT8");let i=e.permRAS,r=t[1]*t[2]*t[3];this.drawBitmap=new Uint8Array(r),this.drawTexture=this.r8Tex(this.drawTexture,33991,this.back.dims,!0);let s=[0,0,0];for(let e=0;e<3;e++)for(let t=0;t<3;t++){if(Math.abs(i[e])-1===t)s[t]=e*Math.sign(i[e])}let a=1,l=[1,1,1],o=[!1,!1,!1];for(let e=0;e<s.length;e++)for(let i=0;i<s.length;i++){if(Math.abs(s[i])===e)l[i]=a,(s[i]<0||Object.is(s[i],-0))&&(o[i]=!0),a*=t[i+1]}let n=tW.range(0,t[1]-1,1);o[0]&&(n=tW.range(t[1]-1,0,-1));for(let e=0;e<t[1];e++)n[e]*=l[0];let h=tW.range(0,t[2]-1,1);o[1]&&(h=tW.range(t[2]-1,0,-1));for(let e=0;e<t[2];e++)h[e]*=l[1];let d=tW.range(0,t[3]-1,1);o[2]&&(d=tW.range(t[3]-1,0,-1));for(let e=0;e<t[3];e++)d[e]*=l[2];let c=e.img,m=this.drawBitmap,A=0;for(let e=0;e<t[3];e++)for(let i=0;i<t[2];i++)for(let r=0;r<t[1];r++)m[n[r]+h[i]+d[e]]=c[A],A++;return this.drawAddUndoBitmap(),this.refreshDrawing(!1),this.drawScene(),!0}binarize(e){let t=e.hdr.dims,i=t[1]*t[2]*t[3],r=new Uint8Array(i);for(let t=0;t<i;t++)0!==e.img[t]&&(r[t]=1);e.img=r,e.hdr.datatypeCode=2,e.hdr.cal_min=0,e.hdr.cal_max=1}async loadDrawingFromUrl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.drawBitmap&&I.debug("Overwriting open drawing!"),this.drawClearAllUndoBitmaps();let i=!1;try{let r=await t2.loadFromUrl(t_(e));t&&await this.binarize(r),i=this.loadDrawing(r)}catch(t){I.error("loadDrawingFromUrl() failed to load "+e),this.drawClearAllUndoBitmaps()}return i}findOtsu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;if(this.volumes.length<1)return[];let t=this.volumes[0].img,i=t.length;if(i<1)return[];let r=255,s=Array(256).fill(0),a=this.volumes[0].cal_min,l=this.volumes[0].cal_max;if(l<=a)return[];let o=(l-a)/256;function n(e){return e*o+a}let h=255/Math.abs(l-a),d=this.volumes[0].hdr.scl_inter,c=this.volumes[0].hdr.scl_slope;for(let e=0;e<i;e++){let i=t[e]*c+d;i=Math.round(((i=Math.min(Math.max(i,a),l))-a)*h),s[i]++}let m=Array(256).fill(0).map(()=>Array(256).fill(0)),A=Array(256).fill(0).map(()=>Array(256).fill(0));for(let e=1;e<256;++e)m[e][e]=s[e],A[e][e]=e*s[e];for(let e=1;e<255;++e)m[1][e+1]=m[1][e]+s[e+1],A[1][e+1]=A[1][e]+(e+1)*s[e+1];for(let e=2;e<256;e++)for(let t=e+1;t<256;t++)m[e][t]=m[1][t]-m[1][e-1],A[e][t]=A[1][t]-A[1][e-1];for(let e=1;e<256;++e)for(let t=e+1;t<256;t++)0!==m[e][t]&&(m[e][t]=A[e][t]*A[e][t]/m[e][t]);let g=0,u=[1/0,1/0,1/0];if(e>3)for(let e=0;e<253;e++)for(let t=e+1;t<254;t++)for(let i=t+1;i<255;i++){let s=m[0][e]+m[e+1][t]+m[t+1][i]+m[i+1][r];s>g&&(u[0]=e,u[1]=t,u[2]=i,g=s)}else if(3===e)for(let e=0;e<254;e++)for(let t=e+1;t<255;t++){let i=m[0][e]+m[e+1][t]+m[t+1][r];i>g&&(u[0]=e,u[1]=t,g=i)}else for(let e=0;e<255;e++){let t=m[0][e]+m[e+1][r];t>g&&(u[0]=e,g=t)}return[u[0]*o+a,u[1]*o+a,u[2]*o+a]}drawOtsu(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;if(0===this.volumes.length)return;let t=this.volumes[0].img.length,i=this.findOtsu(e);if(i.length<3)return;!this.drawBitmap&&this.createEmptyDrawing();let r=this.drawBitmap,s=this.volumes[0].img;for(let e=0;e<t;e++){if(0!==r[e])continue;let t=s[e];t>i[0]&&(r[e]=1),t>i[1]&&(r[e]=2),t>i[2]&&(r[e]=3)}this.drawAddUndoBitmap(),this.refreshDrawing(!0)}removeHaze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.volumes[t].img,r=this.volumes[t].hdr,s=i.length,a=2;(5===e||1===e)&&(a=4),(4===e||2===e)&&(a=3);let l=this.findOtsu(a);if(l.length<3)return;let o=l[0];1===e&&(o=l[2]),2===e&&(o=l[1]);let n=r.scl_inter,h=r.scl_slope,d=this.volumes[t].global_min;for(let e=0;e<s;e++)i[e]*h+n<o&&(i[e]=d);this.refreshLayers(this.volumes[t],0),this.drawScene()}saveImage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:im,{filename:t,isSaveDrawing:i,volumeByIndex:r}={...im,...e};if(I.debug("saveImage",t,i,r),this.back?.dims===void 0)return I.debug("No voxelwise image open"),!1;if(i){if(!this.drawBitmap)return I.debug("No drawing open"),!1;let e=this.volumes[0].permRAS;if(1===e[0]&&2===e[1]&&3===e[2])return I.debug("saving drawing"),this.volumes[0].saveToDisk(t,this.drawBitmap);{I.debug("saving drawing");let i=this.volumes[0].hdr.dims,r=[0,0,0];for(let t=0;t<3;t++)for(let i=0;i<3;i++){if(Math.abs(e[t])-1===i)r[i]=t*Math.sign(e[t])}let s=1,a=[1,1,1],l=[!1,!1,!1];for(let e=0;e<r.length;e++)for(let t=0;t<r.length;t++){if(Math.abs(r[t])===e)a[t]=s,(r[t]<0||Object.is(r[t],-0))&&(l[t]=!0),s*=i[t+1]}let o=tW.range(0,i[1]-1,1);l[0]&&(o=tW.range(i[1]-1,0,-1));for(let e=0;e<i[1];e++)o[e]*=a[0];let n=tW.range(0,i[2]-1,1);l[1]&&(n=tW.range(i[2]-1,0,-1));for(let e=0;e<i[2];e++)n[e]*=a[1];let h=tW.range(0,i[3]-1,1);l[2]&&(h=tW.range(i[3]-1,0,-1));for(let e=0;e<i[3];e++)h[e]*=a[2];let d=new Uint8Array(this.drawBitmap),c=new Uint8Array(i[1]*i[2]*i[3]),m=0;for(let e=0;e<i[3];e++)for(let t=0;t<i[2];t++)for(let r=0;r<i[1];r++)c[m]=d[o[r]+n[t]+h[e]],m++;return I.debug("saving drawing"),this.volumes[0].saveToDisk(t,c)}}return I.debug("saving image"),this.volumes[r].saveToDisk(t)}getMeshIndexByID(e){if("number"==typeof e)return e>=this.meshes.length?-1:e;let t=this.meshes.length;for(let i=0;i<t;i++)if(this.meshes[i].id===e)return i;return -1}setMeshProperty(e,t,i){let r=this.getMeshIndexByID(e);if(r<0){I.warn("setMeshProperty() id not loaded",e);return}this.meshes[r].setProperty(t,i,this.gl),this.updateGLVolume(),this.onMeshPropertyChanged(r,t,i)}indexNearestXYZmm(e,t,i,r){let s=this.getMeshIndexByID(e);return s<0?(I.warn("indexNearestXYZmm() id not loaded",e),[NaN,NaN]):this.meshes[s].indexNearestXYZmm(t,i,r)}decimateHierarchicalMesh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=this.getMeshIndexByID(e);if(i<0){I.warn("reverseFaces() id not loaded",e);return}let r=this.meshes[i].decimateHierarchicalMesh(this.gl,t);return this.updateGLVolume(),r}reverseFaces(e){let t=this.getMeshIndexByID(e);if(t<0){I.warn("reverseFaces() id not loaded",e);return}this.meshes[t].reverseFaces(this.gl),this.updateGLVolume()}async setMeshLayerProperty(e,t,i,r){let s=this.getMeshIndexByID(e);if(s<0){I.warn("setMeshLayerProperty() id not loaded",e);return}await this.meshes[s].setLayerProperty(t,i,r,this.gl),this.updateGLVolume()}setPan2Dxyzmm(e){this.scene.pan2Dxyzmm=e,this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=e[3]),this.drawScene()}setRenderAzimuthElevation(e,t){this.scene.renderAzimuth=e,this.scene.renderElevation=t,this.onAzimuthElevationChange(e,t),this.drawScene()}getOverlayIndexByID(e){let t=this.overlays.length;for(let i=0;i<t;i++)if(this.overlays[i].id===e)return i;return -1}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>this.volumes.length)return;let i=this.getVolumeIndexByID(e.id);0===t?(this.volumes.splice(i,1),this.volumes.unshift(e),this.back=this.volumes[0],this.overlays=this.volumes.slice(1)):t<0?(this.volumes.splice(this.getVolumeIndexByID(e.id),1),this.back=this.volumes[0],this.volumes.length>1?this.overlays=this.volumes.slice(1):this.overlays=[]):(this.volumes.splice(i,1),this.volumes.splice(t,0,e),this.overlays=this.volumes.slice(1),this.back=this.volumes[0]),this.updateGLVolume()}setMesh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.meshes.forEach(e=>{I.debug("MESH: ",e.name)}),t>this.meshes.length)return;let i=this.getMeshIndexByID(e.id);0===t?(this.meshes.splice(i,1),this.meshes.unshift(e)):t<0?this.meshes.splice(this.getMeshIndexByID(e.id),1):(this.meshes.splice(i,1),this.meshes.splice(t,0,e)),this.updateGLVolume(),this.meshes.forEach(e=>{I.debug(e.name)})}removeVolume(e){if(this.setVolume(e,-1),this.mediaUrlMap.has(e)){let t=this.mediaUrlMap.get(e);this.onVolumeWithUrlRemoved(t),this.mediaUrlMap.delete(e)}this.drawScene()}removeVolumeByIndex(e){if(e>=this.volumes.length)throw Error("Index of volume out of bounds");this.removeVolume(this.volumes[e])}removeMesh(e){if(e.unloadMesh(this.gl),this.setMesh(e,-1),this.mediaUrlMap.has(e)){let t=this.mediaUrlMap.get(e);this.onMeshWithUrlRemoved(t),this.mediaUrlMap.delete(e)}}removeMeshByUrl(e){let t=this.getMediaByUrl(e);t&&(this.removeMesh(t),this.mediaUrlMap.delete(t),this.onMeshWithUrlRemoved(e))}moveVolumeToBottom(e){this.setVolume(e,0)}moveVolumeUp(e){let t=this.getVolumeIndexByID(e.id);this.setVolume(e,t+1)}moveVolumeDown(e){let t=this.getVolumeIndexByID(e.id);this.setVolume(e,t-1)}moveVolumeToTop(e){this.setVolume(e,this.volumes.length-1)}mouseDown(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr,this.mousePos=[e,t]}mouseMove(e,t){e*=this.uiData.dpr,t*=this.uiData.dpr;let i=(e-this.mousePos[0])/this.uiData.dpr,r=(t-this.mousePos[1])/this.uiData.dpr;if(this.mousePos=[e,t],!(0>this.inRenderTile(e,t)||1>Math.abs(i)&&1>Math.abs(r)))this.scene.renderAzimuth+=i,this.scene.renderElevation+=r,this.drawScene()}sph2cartDeg(e,t){let i=-(Math.PI/180*t),r=(e-90)%360*(Math.PI/180),s=[Math.cos(i)*Math.cos(r),Math.cos(i)*Math.sin(r),Math.sin(i)],a=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);return a<=0?s:(s[0]/=a,s[1]/=a,s[2]/=a,s)}setClipPlane(e){let t=this.sph2cartDeg(e[1]+180,e[2]);this.scene.clipPlane=[t[0],t[1],t[2],e[0]],this.scene.clipPlaneDepthAziElev=e,this.onClipPlaneChange(this.scene.clipPlane),this.drawScene()}setCrosshairColor(e){this.opts.crosshairColor=e,this.drawScene()}setCrosshairWidth(e){this.opts.crosshairWidth=e,this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN),this.drawScene()}setDrawColormap(e){this.drawLut=tG.makeDrawLut(e),this.updateGLVolume()}setDrawingEnabled(e){this.opts.drawingEnabled=e,this.opts.drawingEnabled&&!this.drawBitmap&&this.createEmptyDrawing(),this.drawScene()}setPenValue(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.opts.penValue=e,this.opts.isFilledPen=t,this.drawScene()}setDrawOpacity(e){this.drawOpacity=e,this.drawScene()}setSelectionBoxColor(e){this.opts.selectionBoxColor=e}sliceScroll2D(e,t,i){let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(this.opts.scrollRequiresFocus&&this.canvas!==document.activeElement){I.warn("Canvas element does not have focus. Scroll events will not be processed.");return}if(this.inGraphTile(t,i)){let t=this.volumes[0].frame4D;e>0&&t++,e<0&&t--,this.setFrame4D(this.volumes[0].id,t);return}if(0!==e&&3===this.opts.dragMode&&-1===this.inRenderTile(this.uiData.dpr*t,this.uiData.dpr*i)){let t=this.scene.pan2Dxyzmm[3]*(1+10*e);t=Math.round(10*t)/10;let i=this.scene.pan2Dxyzmm[3]-t;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=t),this.scene.pan2Dxyzmm[3]=t;let r=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=i*r[0],this.scene.pan2Dxyzmm[1]+=i*r[1],this.scene.pan2Dxyzmm[2]+=i*r[2],this.drawScene(),this.canvas.focus(),this.sync();return}this.mouseClick(t,i,e,r)}setSliceType(e){return this.opts.sliceType=e,this.drawScene(),this}setOpacity(e,t){if(this.volumes[e].opacity=t,0===e){this.drawScene();return}this.updateGLVolume()}setScale(e){this.scene.volScaleMultiplier=e,this.drawScene()}setClipPlaneColor(e){this.opts.clipPlaneColor=e,this.renderShader.use(this.gl),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.drawScene()}setClipPlaneThick(e){this.opts.clipThick=e,this.renderShader.use(this.gl),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.drawScene()}setClipVolume(e,t){this.opts.clipVolumeLow=[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.min(e[2],t[2])],this.opts.clipVolumeHigh=[Math.max(e[0],t[0]),Math.max(e[1],t[1]),Math.max(e[2],t[2])],this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.pickingImageShader.use(this.gl),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.drawScene()}async setVolumeRenderIllumination(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.renderShader=this.renderVolumeShader,e>0&&(this.renderShader=this.renderGradientShader),e<0&&(this.renderShader=this.renderSliceShader),this.initRenderShader(this.renderShader,e),this.renderShader.use(this.gl),this.setClipPlaneColor(this.opts.clipPlaneColor),this.gradientTextureAmount=e,this.refreshLayers(this.volumes[0],0),this.drawScene()}overlayRGBA(e){let t=e.hdr,i=new Uint8ClampedArray(4*(t.dims[1]*t.dims[2]*t.dims[3])),r=.2*Math.min(Math.min(t.dims[1],t.dims[2]),t.dims[3]),s=.5*t.dims[1],a=.5*t.dims[2],l=.5*t.dims[3],o=0;for(let e=0;e<t.dims[3];e++)for(let n=0;n<t.dims[2];n++)for(let h=0;h<t.dims[1];h++){let t=Math.abs(h-s),d=Math.abs(n-a),c=Math.abs(e-l),m=0;Math.sqrt(t*t+d*d+c*c)<r&&(m=255),i[o++]=0,i[o++]=m,i[o++]=0,i[o++]=.5*m}return i}vox2mm(e,t){return tW.vox2mm(e,t)}cloneVolume(e){return this.volumes[e].clone()}async loadDocumentFromUrl(e){let t=await t6.loadFromUrl(e);this.loadDocument(t)}loadDocument(e){this.volumes=[],this.meshes=[],this.document=e,this.document.labels=this.document.labels?this.document.labels:[];let t={...t4,...e.opts};this.scene.pan2Dxyzmm=e.scene.pan2Dxyzmm?e.scene.pan2Dxyzmm:[0,0,0,1],this.document.opts=t,this.setClipPlane(this.scene.clipPlaneDepthAziElev),I.debug("load document",e),this.mediaUrlMap.clear(),this.createEmptyDrawing();let i=e.encodedImageBlobs;for(let t=0;t<e.imageOptionsArray.length;t++){let r=e.imageOptionsArray[t],s=i[t];if(s){"colorMap"in r&&(r.colormap=r.colorMap);let e=t2.loadFromBase64({base64:s,...r});if(e){if(e.colormapLabel){let t=new Uint8ClampedArray(Object.keys(e.colormapLabel.lut).length);for(let i in e.colormapLabel.lut)t[i]=e.colormapLabel.lut[i];e.colormapLabel.lut=t}this.addVolume(e)}}}this.volumes.length>0&&(this.back=this.volumes[0]);let r=e.encodedDrawingBlob;if(r){let t=e.imageOptionsArray[0],i=t2.loadFromBase64({base64:r,...t});i&&this.loadDrawing(i)}for(let t of e.meshDataObjects??[]){let e={gl:this.gl,...t};t.offsetPt0&&(e.rgba255[3]=0,e.tris=new Uint32Array(t.offsetPt0)),I.debug(e);let i=new tz(e.pts,e.tris,e.name,e.rgba255,e.opacity,e.visible,this.gl,e.connectome,e.dpg,e.dps,e.dpv);t.offsetPt0&&(i.fiberGroupColormap=t.fiberGroupColormap,i.fiberColor=t.fiberColor,i.fiberDither=t.fiberDither,i.fiberRadius=t.fiberRadius,i.colormap=t.colormap),i.meshShaderIndex=e.meshShaderIndex,i.layers=e.layers,i.updateMesh(this.gl),I.debug(i),this.addMesh(i)}if(e.data.connectomes)for(let t of e.data.connectomes){let e=JSON.parse(t),i=this.loadConnectomeAsMesh(e);i.updateMesh(this.gl),this.addMesh(i)}return this.updateGLVolume(),this.drawScene(),this.onDocumentLoaded(e),this}async generateLoadDocumentJavaScript(e,t){let i=this.json(),r=await tW.compressToBase64String(JSON.stringify(i));return`
        ${t}

        async function saveNiivueAsHtml(pageName) {
          //get new docstring
          const docString = nv1.json();
          const html =
          document.getElementsByTagName("html")[0]
              .innerHTML.replace(base64, await NVUtilities.compressToBase64String(JSON.stringify(docString)));
          NVUtilities.download(html, pageName, "application/html");
        }

        var nv1 = new Niivue();
        nv1.attachTo("${e}");
        var base64 = "${r}";
        NVUtilities.decompressBase64String(base64).then((jsonText) => {
          var json = JSON.parse(jsonText); // string -> JSON
          var doc = NVDocument.loadFromJSON(json);
          nv1.loadDocument(doc);
          nv1.updateGLVolume();
        });

      `}async generateHTML(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gl1",t=arguments.length>1?arguments[1]:void 0,i=await this.generateLoadDocumentJavaScript(e,t);return`<!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="utf-8" />
            <meta http-equiv="X-UA-Compatible" content="IE=edge" />
            <meta name="viewport" content="width=device-width,initial-scale=1.0" />
            <title>Save as HTML</title>
            <style>
            html {
              height: auto;
              min-height: 100%;
              margin: 0;
            }
            body {
              display: flex;
              flex-direction: column;
              margin: 0;
              min-height: 100%;
              width: 100%;
              position: absolute;
              font-family: system-ui, Arial, Helvetica, sans-serif;
              background: #ffffff;
              color: black;
              user-select: none; /* Standard syntax */
            }
            header {
              margin: 10px;
            }
            main {
              flex: 1;
              background: #000000;
              position: relative;
            }
            footer {
              margin: 10px;
            }
            canvas {
              position: absolute;
              cursor: crosshair;
            }
            canvas:focus {
              outline: 0px;
            }
            div {
              display: table-row;
              background-color: blue;
            }
            </style>
          </head>
          <body>
            <noscript>niivue requires JavaScript.</noscript>
            <header>
            Save the current scene as HTML
            <button id="save">Save as HTML</button>
            </header>
            <main>
              <canvas id="gl1"></canvas>
            </main>
            <script type="module" async>
              ${i}
              function saveAsHtml() {
                saveNiivueAsHtml("page.html");
              }
              // assign our event handler
              var button = document.getElementById("save");
              button.onclick = saveAsHtml;
            </script>
          </body>
        </html>`}async saveHTML(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.html",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl1",i=arguments.length>2?arguments[2]:void 0,r=await this.generateHTML(t,i);return tW.download(r,e,"application/html")}json(){return this.document.opts=this.opts,this.document.scene=this.scene,this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.json()}async saveDocument(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.nvd",t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return this.document.title=e,I.debug("saveDocument",this.volumes[0]),this.drawScene(),this.document.previewImageDataURL=this.canvas.toDataURL(),this.document.volumes=this.volumes,this.document.meshes=this.meshes,this.document.download(e,t)}async loadImages(e){let t=[],i=[];for(let r of e)if("url"in r){let e=this.getFileExt(r.url);if(this.loaders[e]){let s=this.loaders[e].toExt.toUpperCase();ic.includes(s)?i.push(r):t.push(r);continue}ic.includes(e.toUpperCase())?i.push(r):t.push(r)}return t.length>0&&await this.loadVolumes(t),i.length>0&&await this.loadMeshes(i),this}async loadVolumes(e){return(this.loadingText="loading...",this.drawScene(),this.thumbnailVisible)?(this.deferredVolumes=e,this):(this.volumes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addVolumesFromUrl(e),this)}async addMeshFromUrl(e){let t=this.getFileExt(e.url);if("JCON"===t||"JSON"===t){let t=await fetch(e.url,{}),i=await t.json(),r=this.loadConnectomeAsMesh(i);return this.mediaUrlMap.set(r,e.url),this.onMeshAddedFromUrl(e,r),this.addMesh(r),r}let i=await tz.loadFromUrl({...e,gl:this.gl});return this.mediaUrlMap.set(i,e.url),this.onMeshAddedFromUrl(e,i),this.addMesh(i),i}async addMeshesFromUrl(e){let t=e.map(async e=>{let t=this.getFileExt(e.name||e.url);if(this.loaders[t]){let i=e.url,r=this.loaders[t].toExt,s=e.name||e.url;if(s=s.split("/").pop(),"string"==typeof e.url){let t=e.url;try{let e=await fetch(t);if(!e.ok)throw Error(`Failed to load file: ${e.statusText}`);i=await e.arrayBuffer()}catch(e){throw Error(`Failed to load url ${t}: ${e}`)}}let{positions:a,indices:l}=await this.loaders[t].loader(i);e.name=`${s}.${r}`;let o=tK.createMZ3(a,l,!1);e.buffer=o}if("JCON"===t||"JSON"===t){let t=await fetch(e.url,{}),i=await t.json(),r=this.loadConnectomeAsMesh(i);return this.mediaUrlMap.set(r,e.url),this.onMeshAddedFromUrl(e,r),r}let i=await tz.loadFromUrl({...e,gl:this.gl});return this.mediaUrlMap.set(i,e.url),this.onMeshAddedFromUrl(e,i),i}),i=await Promise.all(t);for(let e=0;e<i.length;e++)this.addMesh(i[e]);return i}async loadMeshes(e){return(this.loadingText="loading...",this.drawScene(),this.thumbnailVisible)?(this.deferredMeshes=e,this):(this.initialized,this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),await this.addMeshesFromUrl(e),this.updateGLVolume(),this.drawScene(),this)}async loadConnectomeFromUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=await fetch(e,{headers:t}),r=await i.json();return this.loadConnectome(r)}async loadFreeSurferConnectomeFromUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=await fetch(e,{headers:t}),r=await i.json();return this.loadFreeSurferConnectome(r)}async loadFreeSurferConnectome(e){let t=t9.convertFreeSurferConnectome(e);return this.loadConnectome(t)}handleNodeAdded(e){let t=e.detail.node,i=[1,1,1,1];this.addLabel(t.name,{textColor:i,bulletScale:1,bulletColor:i,lineWidth:0,lineColor:i,lineTerminator:"none",textScale:1},[t.x,t.y,t.z]),this.drawScene()}loadConnectomeAsMesh(e){let t=e;if("data_type"in e&&"fs_pointset"===e.data_type)t=t9.convertFreeSurferConnectome(e),I.warn("converted FreeSurfer connectome",t);else if("nodes"in e){let i=e.nodes;"names"in i&&"X"in i&&"Y"in i&&"Z"in i&&"Color"in i&&"Size"in i&&(t=t9.convertLegacyConnectome(e),I.warn("converted legacy connectome",t))}else throw Error("not a known connectome format");return new t9(this.gl,t)}loadConnectome(e){this.loadingText="loading...",this.drawScene(),this.meshes=[],this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT);let t=this.loadConnectomeAsMesh(e);return this.addMesh(t),this.drawScene(),this}createEmptyDrawing(){if(null===this.back||!this.back.dims||1>Math.min(Math.min(this.back.dims[1],this.back.dims[2]),this.back.dims[3]))return;let e=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];this.drawBitmap=new Uint8Array(e),this.clickToSegmentGrowingBitmap=new Uint8Array(e),this.drawClearAllUndoBitmaps(),this.drawAddUndoBitmap(),this.drawTexture=this.r8Tex(this.drawTexture,33991,this.back.dims,!0),this.refreshDrawing(!1)}r16Tex(e,t,i,r){e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i[1],i[2],i[3]);let s=i[1]*i[2]*i[3];return r.length!==s&&(r=new Int16Array(s)),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED_INTEGER,this.gl.SHORT,r),e}drawGrowCut(){if(!this.back||!this.back.dims)throw Error("back not defined");let e=this.back.hdr,t=this.gl,i=e.dims[1]*e.dims[2]*e.dims[3];if(!this.drawBitmap||this.drawBitmap.length!==i){I.debug("bitmap dims are wrong");return}let r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.disable(t.CULL_FACE),t.viewport(0,0,this.back.dims[1],this.back.dims[2]),t.disable(t.BLEND);let s=function(e){let t=e.hdr.dims,i=e.permRAS,r=new Int16Array(t[1]*t[2]*t[3]),s=[0,0,0];for(let e=0;e<3;e++)for(let t=0;t<3;t++){if(Math.abs(i[e])-1===t)s[t]=e*Math.sign(i[e])}let a=1,l=[1,1,1],o=[!1,!1,!1];for(let e=0;e<s.length;e++)for(let i=0;i<s.length;i++){if(Math.abs(s[i])===e)l[i]=a,(s[i]<0||Object.is(s[i],-0))&&(o[i]=!0),a*=t[i+1]}let n=tW.range(0,t[1]-1,1);o[0]&&(n=tW.range(t[1]-1,0,-1));for(let e=0;e<t[1];e++)n[e]*=l[0];let h=tW.range(0,t[2]-1,1);o[1]&&(h=tW.range(t[2]-1,0,-1));for(let e=0;e<t[2];e++)h[e]*=l[1];let d=tW.range(0,t[3]-1,1);o[2]&&(d=tW.range(t[3]-1,0,-1));for(let e=0;e<t[3];e++)d[e]*=l[2];let c=0;for(let i=0;i<t[3];i++)for(let s=0;s<t[2];s++)for(let a=0;a<t[1];a++)r[n[a]+h[s]+d[i]]=e.img[c],c++;return r}(this.back),a=this.r16Tex(null,33995,this.back.dims,s);for(let e=1;e<i;e++)s[e]=this.drawBitmap[e];let l=this.r16Tex(null,33998,this.back.dims,s),o=this.r16Tex(null,33999,this.back.dims,s);for(let e=1;e<i;e++)s[e]>0&&(s[e]=1e4);let n=this.r16Tex(null,33996,this.back.dims,s),h=this.r16Tex(null,33997,this.back.dims,s);t.bindVertexArray(this.genericVAO);let d=this.growCutShader;d.use(t);t.uniform1i(d.uniforms.finalPass,0),t.uniform1i(d.uniforms.backTex,11);for(let e=0;e<128;e++){t.uniform1i(d.uniforms.labelTex,14),t.uniform1i(d.uniforms.strengthTex,12);for(let e=0;e<this.back.dims[3];e++){let i=1/this.back.dims[3]*(e+.5);t.uniform1f(d.uniforms.coordZ,i),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,o,0,e),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,h,0,e),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&I.error("Incomplete framebuffer"),t.drawArrays(t.TRIANGLE_STRIP,0,4)}127===e&&t.uniform1i(d.uniforms.finalPass,1),t.uniform1i(d.uniforms.labelTex,15),t.uniform1i(d.uniforms.strengthTex,13);for(let e=0;e<this.back.dims[3];e++){let i=1/this.back.dims[3]*(e+.5);t.uniform1f(d.uniforms.coordZ,i),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,l,0,e),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT1,n,0,e),t.drawBuffers([t.COLOR_ATTACHMENT0,t.COLOR_ATTACHMENT1]),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&I.error("Incomplete framebuffer"),t.drawArrays(t.TRIANGLE_STRIP,0,4)}}t.drawBuffers([t.COLOR_ATTACHMENT0]);let c=t.COLOR_ATTACHMENT1;t.readBuffer(c);let m=t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT),A=t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE);(m!==t.RED_INTEGER||A!==t.SHORT)&&I.debug("readPixels will fail."),s=new Int16Array;let g=new Int16Array(this.back.dims[1]*this.back.dims[2]);for(let e=0;e<this.back.dims[3];e++)t.framebufferTextureLayer(t.FRAMEBUFFER,c,l,0,e),t.readPixels(0,0,this.back.dims[1],this.back.dims[2],m,A,g),s=Int16Array.from([...s,...g]);let u=s[0];for(let e=0;e<s.length;e++)u=Math.max(u,s[e]);for(let e=1;e<i;e++)this.drawBitmap[e]=s[e];t.deleteTexture(a),t.deleteTexture(n),t.deleteTexture(h),t.deleteTexture(l),t.deleteTexture(o),t.bindVertexArray(this.unusedVAO),t.viewport(0,0,t.canvas.width,t.canvas.height),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(r),this.drawAddUndoBitmap(),this.refreshDrawing(!0)}drawPt(e,t,i,r){if(!this.back?.dims)throw Error("back.dims not set");let s=this.back.dims[1],a=this.back.dims[2],l=this.back.dims[3];e=Math.min(Math.max(e,0),s-1),t=Math.min(Math.max(t,0),a-1),i=Math.min(Math.max(i,0),l-1),this.drawBitmap[e+t*s+i*s*a]=r;let o=0===this.drawPenAxCorSag,n=1===this.drawPenAxCorSag,h=2===this.drawPenAxCorSag;if(this.opts.penSize>1){let l=Math.floor(this.opts.penSize/2);for(let d=-l;d<=l;d++)for(let c=-l;c<=l;c++)o?this.drawBitmap[e+d+(t+c)*s+i*s*a]=r:n?this.drawBitmap[e+d+t*s+(i+c)*s*a]=r:h&&(this.drawBitmap[e+(t+c)*s+(i+d)*s*a]=r)}}drawPenLine(e,t,i){let r=Math.abs(e[0]-t[0]),s=Math.abs(e[1]-t[1]),a=Math.abs(e[2]-t[2]),l=-1,o=-1,n=-1;t[0]>e[0]&&(l=1),t[1]>e[1]&&(o=1),t[2]>e[2]&&(n=1);let h=e[0],d=e[1],c=e[2],m=t[0],A=t[1],g=t[2];if(r>=s&&r>=a){let e=2*s-r,t=2*a-r;for(;h!==m;)h+=l,e>=0&&(d+=o,e-=2*r),t>=0&&(c+=n,t-=2*r),e+=2*s,t+=2*a,this.drawPt(h,d,c,i)}else if(s>=r&&s>=a){let e=2*r-s,t=2*a-s;for(;d!==A;)d+=o,e>=0&&(h+=l,e-=2*s),t>=0&&(c+=n,t-=2*s),e+=2*r,t+=2*a,this.drawPt(h,d,c,i)}else{let e=2*s-a,t=2*r-a;for(;c!==g;)c+=n,e>=0&&(d+=o,e-=2*a),t>=0&&(h+=l,t-=2*a),e+=2*s,t+=2*r,this.drawPt(h,d,c,i)}}drawingBinaryDilationWithSeed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;try{var i;let r=this.drawBitmap,s=this.back.dims[1],a=this.back.dims[2],l=this.back.dims[3],o=s,n=s*a,h=n*l;let d=(i=e)[0]+i[1]*o+i[2]*n;if(d<0||d>=h)throw Error("Seed index is out of bounds.");let c=r[d];if(0===c)throw Error("Seed voxel is not part of a filled cluster.");let m=r.slice();for(let e=0;e<h;e++)m[e]=m[e]===c?1:0;this.drawFloodFillCore(m,d,t);let A=r.slice(),g=[];g.push(-n,n,-s,s,-1,1),t>6&&g.push(-s-1,-s+1,s-1,s+1,-n-s,-n+s,-n-1,-n+1,n-s,n+s,n-1,n+1),t>18&&g.push(-n-s-1,-n-s+1,-n+s-1,-n+s+1,n-s-1,n-s+1,n+s-1,n+s+1);for(let e=0;e<h;e++)if(2===m[e]){let t=e%s,i=Math.floor(e%n/s),a=Math.floor(e/n);for(let l of g){let o=e+l;if(o<0||o>=h)continue;let d=o%s,m=Math.floor(o%n/s),g=Math.floor(o/n);if(!(Math.abs(d-t)>1||Math.abs(m-i)>1||Math.abs(g-a)>1))0===r[o]&&(A[o]=c)}}this.drawBitmap=A,this.drawAddUndoBitmap(),this.refreshDrawing(!0)}catch(e){I.error("Error in drawingBinaryDilationWithSeed:",e)}}drawFloodFillCore(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;if(!this.back?.dims)throw Error("back.dims undefined");let r=[this.back.dims[1],this.back.dims[2],this.back.dims[3]],s=r[0],a=s*r[1],l=[];for(l.push(t),e[t]=2;l.length>0;){let t=function(t){var i;let o=n.slice();if(o[0]+=t[0],o[1]+=t[1],o[2]+=t[2],o[0]<0||o[1]<0||o[2]<0||o[0]>=r[0]||o[1]>=r[1]||o[2]>=r[2])return;let h=(i=o)[0]+i[1]*s+i[2]*a;if(1===e[h])e[h]=2,l.push(h)},o=l[0];l.shift();let n=function(e){let t=Math.floor(e/a),i=Math.floor((e-t*a)/s);return[Math.floor(e%s),i,t]}(o);if(t([0,0,-1]),t([0,0,1]),t([0,-1,0]),t([0,1,0]),t([-1,0,0]),t([1,0,0]),i<=6)continue;if(t([-1,-1,0]),t([1,1,0]),t([-1,1,0]),t([1,1,0]),t([0,-1,-1]),t([0,1,-1]),t([-1,0,-1]),t([1,0,-1]),t([0,-1,1]),t([0,1,1]),t([-1,0,1]),t([1,0,1]),!(i<=18))t([-1,-1,-1]),t([1,-1,-1]),t([-1,1,-1]),t([1,1,-1]),t([-1,-1,1]),t([1,-1,1]),t([-1,1,1]),t([1,1,1])}}drawFloodFill(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:NaN,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:6,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Number.POSITIVE_INFINITY,n=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(!this.drawBitmap)throw Error("drawBitmap undefined");if(!this.back?.dims)throw Error("back.dims undefined");i=Math.abs(i);let h=[this.back.dims[1],this.back.dims[2],this.back.dims[3]];if(e[0]<0||e[1]<0||e[2]<0||e[0]>=h[0]||e[1]>=h[1]||e[2]>=h[2])return;let d=h[0],c=d*h[1],m=c*h[2],A=this.drawBitmap.slice(),g=this.drawBitmap;if(this.clickToSegmentIsGrowing&&(A=this.clickToSegmentGrowingBitmap.slice(),g=this.clickToSegmentGrowingBitmap),A.length!==c*h[2])return;let u=-1;n&&0===this.drawPenAxCorSag?u=2:n&&1===this.drawPenAxCorSag?u=1:n&&2===this.drawPenAxCorSag&&(u=0);let f=e=>this.vox2mm(e,this.back.matRAS),p=f(e),v=o**2;function x(t){let i=function(e){let t=Math.floor(e/c),i=Math.floor((e-t*c)/d);return[Math.floor(e%d),i,t]}(t);if(u>=0&&i[u]!==e[u])return!1;let r=f(i);return(r[0]-p[0])**2+(r[1]-p[1])**2+(r[2]-p[2])**2<=v}let w=(t=e)[0]+t[1]*d+t[2]*c,C=A[w];if(C===i){0!==r?I.debug("drawFloodFill selected voxel is not part of a drawing"):I.debug("drawFloodFill selected voxel is already desired color");return}for(let e=1;e<m;e++)if(A[e]=0,g[e]===C){if(!x(e))continue;A[e]=1}if(this.drawFloodFillCore(A,w,l),0!==r){let e=this.volumes[0].img2RAS(),t=e[w],o=t;if(isFinite(a)&&isFinite(s))t=a,o=s;else{for(let i=1;i<m;i++)2===A[i]&&(t=Math.max(t,e[i]),o=Math.min(o,e[i]));r===Number.POSITIVE_INFINITY&&(t=r),r===Number.NEGATIVE_INFINITY&&(o=r)}I.debug("Intensity range of selected cluster :",o,t);for(let i=1;i<m;i++)if(A[i]=0,e[i]>=o&&e[i]<=t){if(!x(i))continue;A[i]=1}this.drawFloodFillCore(A,w,l),i=C}for(let e=1;e<m;e++)2===A[e]&&(g[e]=i);this.clickToSegmentIsGrowing?this.clickToSegmentGrowingBitmap=g:(this.drawBitmap=g.slice(),!this.opts.clickToSegment&&this.drawAddUndoBitmap()),this.refreshDrawing(!0,this.clickToSegmentIsGrowing)}drawPenFilled(){let e=this.drawPenFillPts.length;if(e<2){this.drawPenFillPts=[];return}let t=this.drawPenAxCorSag,i=0,r=1;if(1===t&&(r=2),2===t&&(i=1,r=2),!this.back?.dims)throw Error("back.dims undefined");let s=[this.back.dims[i+1],this.back.dims[r+1]],a=new Uint8Array(s[0]*s[1]),l=1;function o(e,t){let i=Math.abs(e[0]-t[0]),r=Math.abs(e[1]-t[1]);a[e[0]+e[1]*s[0]]=l,a[t[0]+t[1]*s[0]]=l;let o=-1,n=-1;t[0]>e[0]&&(o=1),t[1]>e[1]&&(n=1);let h=e[0],d=e[1],c=t[0],m=t[1];if(i>=r){let e=2*r-i;for(;h!==c;)h+=o,e>=0&&(d+=n,e-=2*i),e+=2*r,a[h+d*s[0]]=l}else{let e=2*i-r;for(;d!==m;)d+=n,e>=0&&(h+=o,e-=2*r),e+=2*i,a[h+d*s[0]]=l}}let n=[this.drawPenFillPts[0][i],this.drawPenFillPts[0][r]],h=n;for(let t=1;t<e;t++){let e=[this.drawPenFillPts[t][i],this.drawPenFillPts[t][r]];o(h,e),h=e}o(n,h);let d=[];function c(e){if(e[0]<0||e[1]<0||e[0]>=s[0]||e[1]>=s[1])return;let t=e[0]+e[1]*s[0];if(0===a[t])d.push(e),a[t]=2}for(let e=0;e<s[0];e++)c([e,0]);for(let e=0;e<s[0];e++)c([e,s[1]-1]);for(let e=0;e<s[1];e++)c([0,e]);for(let e=0;e<s[1];e++)c([s[0]-1,e]);for(;d.length>0;){let e=d.shift();c([e[0]-1,e[1]]),c([e[0]+1,e[1]]),c([e[0],e[1]-1]),c([e[0],e[1]+1])}l=this.opts.penValue;let m=this.drawPenFillPts[0][3-(i+r)];if(!this.drawBitmap)throw Error("drawBitmap undefined");if(0===t){let e=m*s[0]*s[1];for(let t=0;t<s[0]*s[1];t++)2!==a[t]&&(this.drawBitmap[t+e]=l)}else{let e=1,i=this.back.dims[1]*this.back.dims[2],r=m*this.back.dims[1];2===t&&(e=this.back.dims[1],r=m);let o=0;for(let t=0;t<s[1];t++)for(let n=0;n<s[0];n++)2!==a[o]&&(this.drawBitmap[n*e+t*i+r]=l),o++}if(!this.drawFillOverwrites&&this.drawUndoBitmaps[this.currentDrawUndoBitmap].length>0){let e=this.drawBitmap.length,t=ih(this.drawUndoBitmaps[this.currentDrawUndoBitmap],e);for(let i=0;i<e;i++){if(0!==t[i])this.drawBitmap[i]=t[i]}}this.drawPenFillPts=[],this.drawAddUndoBitmap(),this.refreshDrawing(!1)}closeDrawing(){this.drawClearAllUndoBitmaps(),this.rgbaTex(this.drawTexture,33991,[2,2,2,2],!0),this.drawBitmap=null,this.clickToSegmentGrowingBitmap=null,this.drawScene()}refreshDrawing(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.back?.dims)throw Error("back.dims undefined");if(!this.drawBitmap)throw Error("drawBitmap undefined");let i=this.back.dims.slice(),r=this.back.dims[1]*this.back.dims[2]*this.back.dims[3];8===this.drawBitmap.length?(i[1]=2,i[2]=2,i[3]=2):r!==this.drawBitmap.length&&I.warn("Drawing bitmap must match the background image"),this.gl.activeTexture(33991),this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED,this.gl.UNSIGNED_BYTE,t?this.clickToSegmentGrowingBitmap:this.drawBitmap),e&&this.drawScene()}r8Tex(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8,i[1],i[2],i[3]),r){let e=new Uint8Array(i[1]*i[2]*i[3]);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RED,this.gl.UNSIGNED_BYTE,e)}return e}rgbaTex(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e&&this.gl.deleteTexture(e),e=this.gl.createTexture(),this.gl.activeTexture(t),this.gl.bindTexture(this.gl.TEXTURE_3D,e),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8,i[1],i[2],i[3]),r){let e=new Uint8Array(i[1]*i[2]*i[3]*4);this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i[1],i[2],i[3],this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)}return e}requestCORSIfNotSameOrigin(e,t){new URL(t,window.location.href).origin!==window.location.origin&&(e.crossOrigin="")}async loadPngAsTexture(e,t){return new Promise((i,r)=>{let s=new Image;s.onload=()=>{let e;if(!!this.bmpShader)4===t?(null!==this.bmpTexture&&this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=this.gl.createTexture(),e=this.bmpTexture,this.bmpTextureWH=s.width/s.height,this.gl.activeTexture(33988),this.bmpShader.use(this.gl),this.gl.uniform1i(this.bmpShader.uniforms.bmpTexture,4)):5===t?(this.gl.activeTexture(33989),null!==this.matCapTexture&&this.gl.deleteTexture(this.matCapTexture),this.matCapTexture=this.gl.createTexture(),e=this.matCapTexture):(this.fontShader.use(this.gl),this.gl.activeTexture(33987),this.gl.uniform1i(this.fontShader.uniforms.fontTexture,3),null!==this.fontTexture&&this.gl.deleteTexture(this.fontTexture),this.fontTexture=this.gl.createTexture(),e=this.fontTexture),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),i(e),4!==t&&this.drawScene()},s.onerror=r,this.requestCORSIfNotSameOrigin(s,e),s.src=e})}async loadFontTexture(e){return this.loadPngAsTexture(e,3)}async loadBmpTexture(e){return this.loadPngAsTexture(e,4)}async loadMatCapTexture(e){return this.loadPngAsTexture(e,5)}initFontMets(){if(!this.fontMetrics)throw Error("fontMetrics undefined");this.fontMets={distanceRange:this.fontMetrics.atlas.distanceRange,size:this.fontMetrics.atlas.size,mets:{}};for(let e=0;e<256;e++)this.fontMets.mets[e]={xadv:0,uv_lbwh:[0,0,0,0],lbwh:[0,0,0,0]};let e=this.fontMetrics.atlas.width,t=this.fontMetrics.atlas.height;for(let i=0;i<this.fontMetrics.glyphs.length;i++){let r=this.fontMetrics.glyphs[i],s=r.unicode;if(this.fontMets.mets[s].xadv=r.advance,void 0===r.planeBounds)continue;let a=r.atlasBounds.left/e,l=(t-r.atlasBounds.top)/t,o=(r.atlasBounds.right-r.atlasBounds.left)/e,n=(r.atlasBounds.top-r.atlasBounds.bottom)/t;this.fontMets.mets[s].uv_lbwh=[a,l,o,n],a=r.planeBounds.left,l=r.planeBounds.bottom,o=r.planeBounds.right-r.planeBounds.left,n=r.planeBounds.top-r.planeBounds.bottom,this.fontMets.mets[s].lbwh=[a,l,o,n]}}async loadFont(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tX,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tq;await this.loadFontTexture(e);let i=await fetch(t);if(!i.ok)throw Error(i.statusText);let r=await i.text();this.fontMetrics=JSON.parse(r),this.initFontMets(),this.fontShader.use(this.gl),this.drawScene()}async loadDefaultMatCap(){return this.loadMatCapTexture("data:image/jpeg;base64,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ZwAAAAAAAAALY3JvcFJlY3RUb3Bsb25nAAAAAAA4QklNA+0AAAAAABAASAAAAAEAAQBIAAAAAQABOEJJTQQmAAAAAAAOAAAAAAAAAAAAAD+AAAA4QklNBA0AAAAAAAQAAAAeOEJJTQQZAAAAAAAEAAAAHjhCSU0D8wAAAAAACQAAAAAAAAAAAQA4QklNJxAAAAAAAAoAAQAAAAAAAAABOEJJTQP1AAAAAABIAC9mZgABAGxmZgAGAAAAAAABAC9mZgABAKGZmgAGAAAAAAABADIAAAABAFoAAAAGAAAAAAABADUAAAABAC0AAAAGAAAAAAABOEJJTQP4AAAAAABwAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAADhCSU0EAAAAAAAAAgAAOEJJTQQCAAAAAAACAAA4QklNBDAAAAAAAAEBADhCSU0ELQAAAAAABgABAAAAMjhCSU0ECAAAAAAAEAAAAAEAAAJAAAACQAAAAAA4QklNBB4AAAAAAAQAAAAAOEJJTQQaAAAAAAM9AAAABgAAAAAAAAAAAAACAAAAAgAAAAAEAG0AYwA2ADEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAABudWxsAAAAAgAAAAZib3VuZHNPYmpjAAAAAQAAAAAAAFJjdDEAAAAEAAAAAFRvcCBsb25nAAAAAAAAAABMZWZ0bG9uZwAAAAAAAAAAQnRvbWxvbmcAAAIAAAAAAFJnaHRsb25nAAACAAAAAAZzbGljZXNWbExzAAAAAU9iamMAAAABAAAAAAAFc2xpY2UAAAASAAAAB3NsaWNlSURsb25nAAAAAAAAAAdncm91cElEbG9uZwAAAAAAAAAGb3JpZ2luZW51bQAAAAxFU2xpY2VPcmlnaW4AAAANYXV0b0dlbmVyYXRlZAAAAABUeXBlZW51bQAAAApFU2xpY2VUeXBlAAAAAEltZyAAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAA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bnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDctMTJUMjA6MDc6NDcrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA3LTEzVDE3OjU0OjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0OGNjMGI3YS1iYTJkLWZmNDAtYmNkNC1jNGQzMzIyZjBiNzQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDphYzFjM2NhNS1hYTg4LWI5NGMtOGE4MS05YmU4MjA3ZGZiODciPiA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8cmRmOkJhZz4gPHJkZjpsaT5hZG9iZTpkb2NpZDpwaG90b3Nob3A6YThjMGNhZTYtODNjYy1hYzQ4LWI2YzAtN2FiODNlOWJkMGM3PC9yZGY6bGk+IDwvcmRmOkJhZz4gPC9waG90b3Nob3A6RG9jdW1lbnRBbmNlc3RvcnM+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YWMxYzNjYTUtYWE4OC1iOTRjLThhODEtOWJlODIwN2RmYjg3IiBzdEV2dDp3aGVuPSIyMDE4LTA3LTEyVDIwOjA3OjQ3KzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYmI3MzZlZC0zOTRhLTM2NDgtYThiOC02Mzk1MmY0NDcxMjIiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTY6MTM6NTgrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RFdnQ6d2hlbj0iMjAxOC0wNy0xM1QxNzo1NDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvanBlZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iZGVyaXZlZCIgc3RFdnQ6cGFyYW1ldGVycz0iY29udmVydGVkIGZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9qcGVnIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MmVhYjVmZS02NDZkLWVhNDMtODQyNC0xNWQzZTgwOWExNDQiIHN0RXZ0OndoZW49IjIwMTgtMDctMTNUMTc6NTQ6MjcrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ2YjNkYTI3LWI4YjEtYmU0Yi1hYTQ4LTExZGM5NmZkNTIyZiIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjg3NjM1NDk5LWZiMTItYWU0MC04NWEzLThkMWFiN2NkZGVhOSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmFjMWMzY2E1LWFhODgtYjk0Yy04YTgxLTliZTgyMDdkZmI4NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSJ3Ij8+/+IMWElDQ19QUk9GSUxFAAEBAAAMSExpbm8CEAAAbW50clJHQiBYWVogB84AAgAJAAYAMQAAYWNzcE1TRlQAAAAASUVDIHNSR0IAAAAAAAAAAAAAAAEAAPbWAAEAAAAA0y1IUCAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARY3BydAAAAVAAAAAzZGVzYwAAAYQAAABsd3RwdAAAAfAAAAAUYmtwdAAAAgQAAAAUclhZWgAAAhgAAAAUZ1hZWgAAAiwAAAAUYlhZWgAAAkAAAAAUZG1uZAAAAlQAAABwZG1kZAAAAsQAAACIdnVlZAAAA0wAAACGdmlldwAAA9QAAAAkbHVtaQAAA/gAAAAUbWVhcwAABAwAAAAkdGVjaAAABDAAAAAMclRSQwAABDwAAAgMZ1RSQwAABDwAAAgMYlRSQwAABDwAAAgMdGV4dAAAAABDb3B5cmlnaHQgKGMpIDE5OTggSGV3bGV0dC1Q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")}async loadDefaultFont(){await this.loadFontTexture(this.DEFAULT_FONT_GLYPH_SHEET),this.fontMetrics=this.DEFAULT_FONT_METRICS,this.initFontMets()}async initText(){this.fontShader=new D(this.gl,j,Z),this.fontShader.use(this.gl),await this.loadDefaultFont(),await this.loadDefaultMatCap(),this.drawLoadingText(this.loadingText)}meshShaderNameToNumber(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Phong",t=e.toLowerCase();for(let e=0;e<this.meshShaders.length;e++)if(this.meshShaders[e].Name.toLowerCase()===t)return e}setMeshShader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=0;if(void 0===(i="number"==typeof t?t:this.meshShaderNameToNumber(t)))throw Error("shaderIndex undefined");i=Math.max(i=Math.min(i,this.meshShaders.length-1),0);let r=this.getMeshIndexByID(e);if(r>=this.meshes.length){I.debug("Unable to change shader until mesh is loaded (maybe you need async)");return}this.meshes[r].meshShaderIndex=i,this.updateGLVolume(),this.onMeshShaderChanged(r,i)}createCustomMeshShader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Custom";if(!e)throw Error("Need fragment shader");let i=this.meshShaderNameToNumber(t);i>=0&&(this.gl.deleteProgram(this.meshShaders[i].shader.program),this.meshShaders.splice(i,1));let r=new D(this.gl,em,e);return r.use(this.gl),{Name:t,Frag:e,shader:r}}setCustomMeshShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Custom",i=this.createCustomMeshShader(e,t);return this.meshShaders.push(i),this.onCustomMeshShaderAdded(e,t),this.meshShaders.length-1}meshShaderNames(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=[];for(let e=0;e<this.meshShaders.length;e++)t.push(this.meshShaders[e].Name);return!0===e?t.sort():t}initRenderShader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.use(this.gl),this.gl.uniform1i(e.uniforms.volume,0),this.gl.uniform1i(e.uniforms.colormap,1),this.gl.uniform1i(e.uniforms.overlay,2),this.gl.uniform1i(e.uniforms.drawing,7),this.gl.uniform1fv(e.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.gl.uniform1f(e.uniforms.gradientAmount,t)}async init(){let e=this.gl.getExtension("WEBGL_debug_renderer_info");if(e){let t=this.gl.getParameter(e.UNMASKED_VENDOR_WEBGL),i=this.gl.getParameter(e.UNMASKED_RENDERER_WEBGL);I.info("renderer vendor: ",t),I.info("renderer: ",i)}else I.info("debug_renderer_info unavailable");let t=this.gl.getParameter(this.gl.RENDERER);I.info("firefox renderer: ",t),this.gl.clearDepth(0),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.FRONT),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.volumeTexture=this.rgbaTex(this.volumeTexture,33984,[2,2,2,2],!0),this.overlayTexture=this.rgbaTex(this.overlayTexture,33986,[2,2,2,2],!0),this.drawTexture=this.r8Tex(this.drawTexture,33991,[2,2,2,2],!0);let i=this.gl;this.cuboidVertexBuffer=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array([1,1,0,1,0,0,0,1,0,0,0,0]),i.STATIC_DRAW),this.genericVAO=i.createVertexArray(),i.bindVertexArray(this.genericVAO),i.bindBuffer(i.ARRAY_BUFFER,this.cuboidVertexBuffer),i.enableVertexAttribArray(0),i.vertexAttribPointer(0,3,i.FLOAT,!1,0,0),i.bindVertexArray(this.unusedVAO),this.pickingMeshShader=new D(i,em,eA),this.pickingMeshShader.use(i),this.pickingImageShader=new D(i,F,eF),this.pickingImageShader.use(i),i.uniform1i(this.pickingImageShader.uniforms.volume,0),i.uniform1i(this.pickingImageShader.uniforms.colormap,1),i.uniform1i(this.pickingImageShader.uniforms.overlay,2),i.uniform1i(this.pickingImageShader.uniforms.drawing,7),this.sliceMMShader=new D(i,N,L),this.sliceMMShader.use(i),i.uniform1i(this.sliceMMShader.uniforms.volume,0),i.uniform1i(this.sliceMMShader.uniforms.colormap,1),i.uniform1i(this.sliceMMShader.uniforms.overlay,2),i.uniform1i(this.sliceMMShader.uniforms.drawing,7),i.uniform1f(this.sliceMMShader.uniforms.drawOpacity,this.drawOpacity),this.sliceV1Shader=new D(i,N,Y),this.sliceV1Shader.use(i),i.uniform1i(this.sliceV1Shader.uniforms.volume,0),i.uniform1i(this.sliceV1Shader.uniforms.colormap,1),i.uniform1i(this.sliceV1Shader.uniforms.overlay,2),i.uniform1i(this.sliceV1Shader.uniforms.drawing,7),i.uniform1f(this.sliceV1Shader.uniforms.drawOpacity,this.drawOpacity),this.orientCubeShader=new D(i,eT,eE),this.orientCubeShaderVAO=i.createVertexArray(),i.bindVertexArray(this.orientCubeShaderVAO);let r=i.createBuffer();i.enableVertexAttribArray(0),i.enableVertexAttribArray(1),i.bindBuffer(i.ARRAY_BUFFER,r),i.bufferData(i.ARRAY_BUFFER,eN,i.STATIC_DRAW),i.vertexAttribPointer(0,3,i.FLOAT,!1,24,0),i.enableVertexAttribArray(1),i.vertexAttribPointer(1,3,i.FLOAT,!1,24,12),i.bindVertexArray(this.unusedVAO),this.rectShader=new D(i,H,O),this.rectShader.use(i),this.rectOutlineShader=new D(i,H,G),this.rectOutlineShader.use(i),this.lineShader=new D(i,Q,O),this.lineShader.use(i),this.line3DShader=new D(i,z,O),this.line3DShader.use(i),this.circleShader=new D(i,J,_),this.circleShader.use(i),this.renderVolumeShader=new D(i,F,U),this.initRenderShader(this.renderVolumeShader),this.renderSliceShader=new D(i,F,B),this.initRenderShader(this.renderSliceShader),this.renderGradientShader=new D(i,F,R),this.initRenderShader(this.renderGradientShader,.3),i.uniform1i(this.renderGradientShader.uniforms.matCap,5),i.uniform1i(this.renderGradientShader.uniforms.gradient,6),this.renderShader=this.renderVolumeShader,this.colorbarShader=new D(i,K,W),this.colorbarShader.use(i),i.uniform1i(this.colorbarShader.uniforms.colormap,1),this.blurShader=new D(i,eB,eU),this.sobelShader=new D(i,eB,eR),this.growCutShader=new D(i,el,eo),this.passThroughShader=new D(i,eS,eV),this.orientShaderAtlasU=new D(i,$,ee.concat(er)),this.orientShaderAtlasI=new D(i,$,et.concat(er)),this.orientShaderU=new D(i,$,ee.concat(es)),this.orientShaderI=new D(i,$,et.concat(es)),this.orientShaderF=new D(i,$,ei.concat(es)),this.orientShaderRGBU=new D(i,$,ee.concat(ea)),this.surfaceShader=new D(i,en,eh),this.surfaceShader.use(i),this.fiberShader=new D(i,ed,ec),this.pickingImageShader.use(i);for(let e=0;e<this.meshShaders.length;e++){let t=this.meshShaders[e];"Flat"===t.Name?t.shader=new D(i,eM,eD):t.shader=new D(i,em,t.Frag),t.shader.use(i),t.shader.isMatcap="Matcap"===t.Name,t.shader.isMatcap&&i.uniform1i(t.shader.uniforms.matCap,5)}return this.bmpShader=new D(i,X,q),await this.initText(),this.opts.thumbnail.length>0&&(await this.loadBmpTexture(this.opts.thumbnail),this.thumbnailVisible=!0),this.updateGLVolume(),this.initialized=!0,this.resizeListener(),this.drawScene(),this}gradientGL(e){let t=this.gl,i=[0,0,0,0,1,0,1,0,0,1,1,0],r=t.createVertexArray();t.bindVertexArray(r);let s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,0,0);let a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.disable(t.CULL_FACE),t.viewport(0,0,e.dims[1],e.dims[2]),t.disable(t.BLEND);let l=this.rgbaTex(null,33992,e.dims),o=this.blurShader;o.use(t),t.activeTexture(33984),t.bindTexture(t.TEXTURE_3D,this.volumeTexture);t.uniform1i(o.uniforms.intensityVol,0),t.uniform1f(o.uniforms.dX,.7/e.dims[1]),t.uniform1f(o.uniforms.dY,.7/e.dims[2]),t.uniform1f(o.uniforms.dZ,.7/e.dims[3]),t.bindVertexArray(r);for(let r=0;r<e.dims[3]-1;r++){let s=1/e.dims[3]*(r+.5);t.uniform1f(o.uniforms.coordZ,s),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,l,0,r),t.clear(t.DEPTH_BUFFER_BIT),t.drawArrays(t.TRIANGLE_STRIP,0,i.length/3)}let n=this.sobelShader;n.use(t),t.activeTexture(33992),t.bindTexture(t.TEXTURE_3D,l),t.uniform1i(n.uniforms.intensityVol,8);t.uniform1f(n.uniforms.dX,.7/e.dims[1]),t.uniform1f(n.uniforms.dY,.7/e.dims[2]),t.uniform1f(n.uniforms.dZ,.7/e.dims[3]),t.uniform1f(n.uniforms.coordZ,.5),t.bindVertexArray(r),t.activeTexture(33984),null!==this.gradientTexture&&t.deleteTexture(this.gradientTexture),this.gradientTexture=this.rgbaTex(this.gradientTexture,33990,e.dims);for(let r=0;r<e.dims[3]-1;r++){let s=1/e.dims[3]*(r+.5);t.uniform1f(n.uniforms.coordZ,s),t.framebufferTextureLayer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,this.gradientTexture,0,r),t.clear(t.DEPTH_BUFFER_BIT),t.drawArrays(t.TRIANGLE_STRIP,0,i.length/3)}t.deleteFramebuffer(a),t.deleteTexture(l),t.deleteBuffer(s),t.bindFramebuffer(t.FRAMEBUFFER,null)}updateGLVolume(){let e=0,t=this.volumes.length;this.refreshColormaps();for(let i=0;i<t;i++){if(!!this.volumes[i].toRAS)this.refreshLayers(this.volumes[i],e),e++}if(this.furthestVertexFromOrigin=0,t>0&&(this.furthestVertexFromOrigin=this.volumeObject3D.furthestVertexFromOrigin),this.meshes)for(let e=0;e<this.meshes.length;e++)this.furthestVertexFromOrigin=Math.max(this.furthestVertexFromOrigin,this.meshes[e].furthestVertexFromOrigin);this.onVolumeUpdated&&this.onVolumeUpdated(),this.drawScene()}getDescriptives(e){let{layer:t=0,masks:i=[],drawingIsMask:r=!1,roiIsMask:s=!1,startVox:a=[0,0,0],endVox:l=[0,0,0]}=e,o=null,n=this.volumes[t].hdr,h=this.volumes[t].pixDimsRAS,d=n.scl_slope;isNaN(d)&&(d=1);let c=n.scl_inter;isNaN(c)&&(c=1);let m=this.volumes[t].img,A=m.length,g=new Float32Array(A);for(let e=0;e<A;e++)g[e]=m[e]*d+c;let u=new Uint8Array(A);for(let e=0;e<A;e++)u[e]=1;if(i.length>0)for(let e=0;e<i.length;e++){let t=this.volumes[i[e]].img;if(t.length!==A){I.debug("Mask resolution does not match image. Skipping masking layer "+i[e]);continue}for(let e=0;e<A;e++)(0===t[e]||isNaN(t[e]))&&(u[e]=0)}else if(i.length<1&&r)for(let e=0;e<A;e++)(0===this.drawBitmap[e]||isNaN(this.drawBitmap[e]))&&(u[e]=0);else if(i.length<1&&s){u.fill(0),console.log("startVox",a),console.log("endVox",l);let e=-1;if(a[0]===l[0])e=0;else if(a[1]===l[1])e=1;else if(a[2]===l[2])e=2;else{console.error("Error: No constant dimension found.");return}let t=[0,1,2].filter(t=>t!==e),i=[];i[e]=a[e],i[t[0]]=(a[t[0]]+l[t[0]])/2,i[t[1]]=(a[t[1]]+l[t[1]])/2;let r=Math.abs(l[t[0]]-a[t[0]])/2,s=Math.abs(l[t[1]]-a[t[1]])/2,d=n.dims[1],c=n.dims[2],m=Math.max(0,Math.floor(i[t[0]]-r)),A=Math.min(n.dims[t[0]+1]-1,Math.ceil(i[t[0]]+r)),g=Math.max(0,Math.floor(i[t[1]]-s)),f=Math.min(n.dims[t[1]+1]-1,Math.ceil(i[t[1]]+s)),p=i[e];if(p<0||p>=n.dims[e+1]){console.error("Error: Constant dimension value is out of bounds.");return}for(let a=m;a<=A;a++)for(let l=g;l<=f;l++){let o=[];o[e]=p,o[t[0]]=a,o[t[1]]=l;let n=(o[t[0]]-i[t[0]])/r,h=(o[t[1]]-i[t[1]])/s;if(n*n+h*h<=1){let e=o[0],t=o[1];u[o[2]*d*c+t*d+e]=1}}let v=h[t[0]+1]*h[t[1]+1];o=u.reduce((e,t)=>e+(1===t?1:0),0)*v;let x=r*h[t[0]+1];o=Math.PI*x*(s*h[t[1]+1])}let f=0,p=0,v=0,x=Number.NEGATIVE_INFINITY,w=Number.POSITIVE_INFINITY,C=0,b=0,y=0;for(let e=0;e<A;e++){if(u[e]<1)continue;let t=g[e],i=p+(t-p)/++f;if(v+=(t-p)*(t-i),p=i,0!==t)i=b+(t-b)/++C,y+=(t-b)*(t-i),b=i,w=Math.min(t,x),x=Math.max(t,x)}let M=Math.sqrt(v/(f-1)),D=Math.sqrt(y/(C-1)),F=w,T=x;return f!==C&&(w=Math.min(0,x),x=Math.max(0,x)),{mean:p,stdev:M,nvox:f,volumeMM3:f*n.pixDims[1]*n.pixDims[2]*n.pixDims[3],volumeML:f*n.pixDims[1]*n.pixDims[2]*n.pixDims[3]*.001,min:w,max:x,meanNot0:b,stdevNot0:D,nvoxNot0:C,minNot0:F,maxNot0:T,cal_min:this.volumes[t].cal_min,cal_max:this.volumes[t].cal_max,robust_min:this.volumes[t].robust_min,robust_max:this.volumes[t].robust_max,area:o}}refreshLayers(e,t){if(this.refreshColormaps(),this.volumes.length<1)return;let i=e.hdr,r=e.img;e.frame4D>0&&e.frame4D<e.nFrame4D&&(r=e.img.slice(e.frame4D*e.nVox3D,(e.frame4D+1)*e.nVox3D));let s=e.opacity;if(t>1&&0===s)return;let a=null;if(!this.back)throw Error("back undefined");this.gl.bindVertexArray(this.unusedVAO),this.crosshairs3D&&(this.crosshairs3D.mm[0]=NaN);let l=h.d9(e.toRAS);if(0===t){this.volumeObject3D=e.toNiivueObject3D(this.VOLUME_ID,this.gl),h.U_(l,l),this.back.matRAS=e.matRAS,this.back.dims=e.dimsRAS,this.back.pixDims=e.pixDimsRAS,a=this.rgbaTex(this.volumeTexture,33984,e.dimsRAS);let{volScale:t,vox:i}=this.sliceScale(!0);if(this.volScale=t,this.vox=i,this.volumeObject3D.scale=t,!this.renderShader)throw Error("renderShader undefined");this.renderShader.use(this.gl),this.gl.uniform3fv(this.renderShader.uniforms.texVox,i),this.gl.uniform3fv(this.renderShader.uniforms.volScale,t);let r=this.pickingImageShader;r.use(this.gl),this.gl.uniform1i(r.uniforms.volume,0),this.gl.uniform1i(r.uniforms.colormap,1),this.gl.uniform1i(r.uniforms.overlay,2),this.gl.uniform3fv(r.uniforms.volScale,t),I.debug(this.volumeObject3D)}else{this.back?.dims===void 0&&I.error("Fatal error: Unable to render overlay: background dimensions not defined!");let i=this.mm2frac(e.mm000,0,!0),r=this.mm2frac(e.mm100,0,!0),s=this.mm2frac(e.mm010,0,!0),o=this.mm2frac(e.mm001,0,!0);r=n.$X(r,r,i),s=n.$X(s,s,i),o=n.$X(o,o,i),l=h.al(r[0],s[0],o[0],i[0],r[1],s[1],o[1],i[1],r[2],s[2],o[2],i[2],0,0,0,1),h.U_(l,l),1===t?(a=this.rgbaTex(this.overlayTexture,33986,this.back.dims),this.overlayTexture=a,this.overlayTextureID=a):a=this.overlayTextureID}let o=this.gl.createFramebuffer();this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,o),this.gl.disable(this.gl.CULL_FACE),this.gl.viewport(0,0,this.back.dims[1],this.back.dims[2]),this.gl.disable(this.gl.BLEND);let d=this.gl.createTexture();this.gl.activeTexture(33993),this.gl.bindTexture(this.gl.TEXTURE_3D,d),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1);let c=this.orientShaderU;if(!i)throw Error("hdr undefined");if(!r)throw Error("img undefined");if(2===i.datatypeCode)1002===i.intent_code&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_BYTE,r);else if(4===i.datatypeCode)c=this.orientShaderI,1002===i.intent_code&&(c=this.orientShaderAtlasI),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16I,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.SHORT,r);else if(16===i.datatypeCode)this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,r),c=this.orientShaderF;else if(64===i.datatypeCode){let e=new Float32Array;e=Float32Array.from(r),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R32F,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.FLOAT,e),c=this.orientShaderF}else 128===i.datatypeCode?((c=this.orientShaderRGBU).use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,0),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGB8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGB_INTEGER,this.gl.UNSIGNED_BYTE,r)):512===i.datatypeCode?(1002===i.intent_code&&(c=this.orientShaderAtlasU),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.R16UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED_INTEGER,this.gl.UNSIGNED_SHORT,r)):2304===i.datatypeCode&&((c=this.orientShaderRGBU).use(this.gl),this.gl.uniform1i(c.uniforms.hasAlpha,1),this.gl.texStorage3D(this.gl.TEXTURE_3D,1,this.gl.RGBA8UI,i.dims[1],i.dims[2],i.dims[3]),this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RGBA_INTEGER,this.gl.UNSIGNED_BYTE,r));void 0===e.global_min&&e.calMinMax();let m=null;this.gl.bindVertexArray(this.genericVAO);if(t>1){if(!this.back.dims)throw Error("back.dims undefined");m=this.rgbaTex(m,33994,this.back.dims),this.gl.bindTexture(this.gl.TEXTURE_3D,m);let e=this.passThroughShader;e.use(this.gl),this.gl.uniform1i(e.uniforms.in3D,2);for(let t=0;t<this.back.dims[3];t++){let i=1/this.back.dims[3]*(t+.5);this.gl.uniform1f(e.uniforms.coordZ,i),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,m,0,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}else m=this.rgbaTex(m,33994,[2,2,2,2]);c.use(this.gl),this.gl.activeTexture(33985);let A=null;if(null!==e.colormapLabel&&e.colormapLabel.lut.length>7){let t=e.colormapLabel.max-e.colormapLabel.min+1;A=this.createColormapTexture(A,1,t),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,t,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e.colormapLabel.lut),this.gl.uniform1f(c.uniforms.cal_min,e.colormapLabel.min-.5),this.gl.uniform1f(c.uniforms.cal_max,e.colormapLabel.max+.5),this.gl.bindTexture(this.gl.TEXTURE_2D,A)}else this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.uniform1f(c.uniforms.cal_min,e.cal_min),this.gl.uniform1f(c.uniforms.cal_max,e.cal_max);this.gl.uniform1i(c.uniforms.isAlphaThreshold,e.alphaThreshold),this.gl.uniform1i(c.uniforms.isAdditiveBlend,this.opts.isAdditiveBlend?1:0);let g=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(e.colormapNegative.length>0&&(g=Math.min(-e.cal_min,-e.cal_max),u=Math.max(-e.cal_min,-e.cal_max),isFinite(e.cal_minNeg)&&isFinite(e.cal_maxNeg)&&(g=Math.min(e.cal_minNeg,e.cal_maxNeg),u=Math.max(e.cal_minNeg,e.cal_maxNeg))),t>0&&this.overlayOutlineWidth>0){let t=e.cal_min,i=e.cal_max,r=0>=Math.min(t,i)&&Math.max(t,i)>=0;!r&&g<u&&(r=g<=0&&u>=0),r&&I.error("issue1139: do not use overlayOutlineWidth when thresholds cross or touch zero")}if(!c)throw Error("orientShader undefined");this.gl.uniform1f(c.uniforms.layer??null,t),this.gl.uniform1f(c.uniforms.cal_minNeg??null,g),this.gl.uniform1f(c.uniforms.cal_maxNeg??null,u),this.gl.bindTexture(this.gl.TEXTURE_3D,d),this.gl.uniform1i(c.uniforms.intensityVol??null,9),this.gl.uniform1i(c.uniforms.blend3D??null,10),this.gl.uniform1i(c.uniforms.colormap??null,1),this.gl.uniform1f(c.uniforms.scl_inter??null,i.scl_inter),this.gl.uniform1f(c.uniforms.scl_slope??null,i.scl_slope),this.gl.uniform1f(c.uniforms.opacity??null,s),this.gl.uniform1i(c.uniforms.modulationVol??null,7);let f=null;if(null!==e.modulationImage&&e.modulationImage>=0&&e.modulationImage<this.volumes.length){I.debug("modulating",this.volumes);let t=this.volumes[e.modulationImage].hdr;if(t.dims[1]===i.dims[1]&&t.dims[2]===i.dims[2]&&t.dims[3]===i.dims[3]){e.modulateAlpha?(this.gl.uniform1i(c.uniforms.modulation,2),this.gl.uniform1f(c.uniforms.opacity,1)):this.gl.uniform1i(c.uniforms.modulation,1),f=this.r8Tex(f,this.gl.TEXTURE7,i.dims,!0),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_3D,f);let r=i.dims[1]*i.dims[2]*i.dims[3],s=new Uint8Array(r),a=this.volumes[e.modulationImage].cal_min,l=1/(this.volumes[e.modulationImage].cal_max-a),o=this.volumes[e.modulationImage].img.buffer,n=new Uint8Array(o);switch(t.datatypeCode){case 4:n=new Int16Array(o);break;case 16:n=new Float32Array(o);break;case 64:n=new Float64Array(o);break;case 128:n=new Uint8Array(o);break;case 512:n=new Uint16Array(o)}I.debug(this.volumes[e.modulationImage]);let h=this.volumes[e.modulationImage].colormapNegative.length>0,d=this.volumes[e.modulationImage].cal_min,m=this.volumes[e.modulationImage].cal_max;isFinite(this.volumes[e.modulationImage].cal_minNeg)&&isFinite(this.volumes[e.modulationImage].cal_maxNeg)&&(d=this.volumes[e.modulationImage].cal_minNeg,m=this.volumes[e.modulationImage].cal_minNeg),(d=Math.abs(d))>(m=Math.abs(m))&&([d,m]=[m,d]);let A=1/(m-d),g=Math.abs(e.modulateAlpha);g=Math.max(g,1);let u=this.volumes[e.modulationImage].frame4D*r;for(let e=0;e<r;e++){let i=n[e+u]*t.scl_slope+t.scl_inter,r=(i-a)*l;h&&i<0&&(r=(Math.abs(i)-d)*A),r=255*Math.pow(r=Math.min(Math.max(r,0),1),g),s[e]=r}this.gl.texSubImage3D(this.gl.TEXTURE_3D,0,0,0,0,i.dims[1],i.dims[2],i.dims[3],this.gl.RED,this.gl.UNSIGNED_BYTE,s)}else I.debug("Modulation image dimensions do not match target")}else this.gl.uniform1i(c.uniforms.modulation,0);if(this.gl.uniformMatrix4fv(c.uniforms.mtx,!1,l),!this.back.dims)throw Error("back.dims undefined");let p=0;1002===i.intent_code&&(p=this.opts.atlasOutline),this.gl.uniform4fv(c.uniforms.xyzaFrac,[1/this.back.dims[1],1/this.back.dims[2],1/this.back.dims[3],p]),I.debug("back dims: ",this.back.dims);for(let e=0;e<this.back.dims[3];e++){let t=1/this.back.dims[3]*(e+.5);this.gl.uniform1f(c.uniforms.coordZ,t),this.gl.framebufferTextureLayer(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,a,0,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}if(this.gl.bindVertexArray(this.unusedVAO),this.gl.deleteTexture(d),this.gl.deleteTexture(f),this.gl.deleteTexture(m),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.deleteFramebuffer(o),0===t&&(this.volumeTexture=a,this.gradientTextureAmount>0?this.gradientGL(i):(null!==this.gradientTexture&&this.gl.deleteTexture(this.gradientTexture),this.gradientTexture=null)),!this.renderShader)throw Error("renderShader undefined");this.renderShader.use(this.gl);let v=this.sliceScale(!0),x=v.vox,w=v.volScale;if(this.gl.uniform1f(this.renderShader.uniforms.overlays,this.overlays),this.gl.uniform4fv(this.renderShader.uniforms.clipPlaneColor,this.opts.clipPlaneColor),this.gl.uniform1f(this.renderShader.uniforms.clipThick,this.opts.clipThick),this.gl.uniform3fv(this.renderShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.renderShader.uniforms.clipHi,this.opts.clipVolumeHigh),this.gl.uniform1f(this.renderShader.uniforms.backOpacity,this.volumes[0].opacity),this.gl.uniform1f(this.renderShader.uniforms.renderOverlayBlend,this.opts.renderOverlayBlend),this.gl.uniform4fv(this.renderShader.uniforms.clipPlane,this.scene.clipPlane),this.gl.uniform3fv(this.renderShader.uniforms.texVox,x),this.gl.uniform3fv(this.renderShader.uniforms.volScale,w),!this.pickingImageShader)throw Error("pickingImageShader undefined");this.pickingImageShader.use(this.gl),this.gl.uniform1f(this.pickingImageShader.uniforms.overlays,this.overlays.length),this.gl.uniform3fv(this.pickingImageShader.uniforms.texVox,x),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipLo,this.opts.clipVolumeLow),this.gl.uniform3fv(this.pickingImageShader.uniforms.clipHi,this.opts.clipVolumeHigh);let C=this.sliceMMShader;if(this.opts.isV1SliceShader&&(C=this.sliceV1Shader),!C)throw Error("slice shader undefined");C.use(this.gl),this.gl.uniform1f(C.uniforms.overlays,this.overlays.length),this.gl.uniform1f(C.uniforms.drawOpacity,this.drawOpacity),null!==A&&(this.gl.deleteTexture(A),this.gl.activeTexture(33985),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture)),this.gl.uniform1i(C.uniforms.drawing,7),this.gl.activeTexture(33991),this.gl.bindTexture(this.gl.TEXTURE_3D,this.drawTexture),this.updateInterpolation(t)}colormaps(){return tG.colormaps()}addColormap(e,t){tG.addColormap(e,t)}setColormap(e,t){let i=this.getVolumeIndexByID(e);this.volumes[i].colormap=t,this.updateGLVolume()}idx(e,t,i,r){return i*r[0]*r[1]+t*r[0]+e}check_previous_slice(e,t,i,r,s,a,l,o){let n=new Uint32Array(27),h=0;if(!s)return 0;let d=e[this.idx(i,r,s,a)];if(l>=6){let l=this.idx(i,r,s-1,a);d===e[l]&&(n[h++]=t[l])}if(l>=18){if(i){let l=this.idx(i-1,r,s-1,a);d===e[l]&&(n[h++]=t[l])}if(r){let l=this.idx(i,r-1,s-1,a);d===e[l]&&(n[h++]=t[l])}if(i<a[0]-1){let l=this.idx(i+1,r,s-1,a);d===e[l]&&(n[h++]=t[l])}if(r<a[1]-1){let l=this.idx(i,r+1,s-1,a);d===e[l]&&(n[h++]=t[l])}}if(26===l){if(i&&r){let l=this.idx(i-1,r-1,s-1,a);d===e[l]&&(n[h++]=t[l])}if(i<a[0]-1&&r){let l=this.idx(i+1,r-1,s-1,a);d===e[l]&&(n[h++]=t[l])}if(i&&r<a[1]-1){let l=this.idx(i-1,r+1,s-1,a);d===e[l]&&(n[h++]=t[l])}if(i<a[0]-1&&r<a[1]-1){let l=this.idx(i+1,r+1,s-1,a);d===e[l]&&(n[h++]=t[l])}}return h?(this.fill_tratab(o,n,h),n[0]):0}do_initial_labelling(e,t,i){let r=1,s=8192,a=new Uint32Array(8192).fill(0),l=new Uint32Array(t[0]*t[1]*t[2]).fill(0),o=new Uint32Array(27);for(let n=0;n<t[2];n++)for(let h=0;h<t[1];h++)for(let d=0;d<t[0];d++){let c=0,m=e[this.idx(d,h,n,t)];if(0!==m){if(o[0]=this.check_previous_slice(e,l,d,h,n,t,i,a),o[0]&&(c+=1),i>=6){if(d){let i=this.idx(d-1,h,n,t);m===e[i]&&(o[c++]=l[i])}if(h){let i=this.idx(d,h-1,n,t);m===e[i]&&(o[c++]=l[i])}}if(i>=18){if(h&&d){let i=this.idx(d-1,h-1,n,t);m===e[i]&&(o[c++]=l[i])}if(h&&d<t[0]-1){let i=this.idx(d+1,h-1,n,t);m===e[i]&&(o[c++]=l[i])}}if(c)l[this.idx(d,h,n,t)]=o[0],this.fill_tratab(a,o,c);else{if(l[this.idx(d,h,n,t)]=r,r>=s){let e=new Uint32Array(s+=8192);e.set(a),a=e}a[r-1]=r,r++}}}for(let e=0;e<r-1;e++){let t=e;for(;a[t]!==t+1;)t=a[t]-1;a[e]=t+1}return[r-1,a,l]}fill_tratab(e,t,i){let r=0,s=new Uint32Array(i+5).fill(0),a=0x7fffffff;for(let l=0;l<i;l++){let i=t[l];for(r=0;e[i-1]!==i;)if(i=e[i-1],++r>100){I.info("\nOoh no!!");break}s[l]=i,a=Math.min(a,i)}for(let t=0;t<i;t++)e[s[t]-1]=a}translate_labels(e,t,i,r){let s=t[0]*t[1]*t[2],a=0,l=new Uint32Array(s).fill(0);for(let e=0;e<r;e++)a=Math.max(a,i[e]);let o=new Uint32Array(a).fill(0),n=0;for(let t=0;t<s;t++)e[t]&&(!o[i[e[t]-1]-1]&&(n+=1,o[i[e[t]-1]-1]=n),l[t]=o[i[e[t]-1]-1]);return[n,l]}largest_original_cluster_labels(e,t,i){let r=e.length,s=new Uint32Array(t+1).fill(0),a=new Uint32Array(t+1).fill(0);for(let t=0;t<r;t++){let r=e[t],l=i[t];s[l]=r,a[l]++}let l=0;for(let e=0;e<t+1;e++){let i=s[e];l=Math.max(l,i);for(let r=0;r<t+1;r++){if(r!==e&&i===s[r])a[e]<a[r]?s[e]=0:a[e]===a[r]&&e<r&&(s[e]=0)}}let o=new Uint32Array(r).fill(0);for(let e=0;e<r;e++)o[e]=s[i[e]];return[l,o]}bwlabel(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:26,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Date.now(),l=t[0]*t[1]*t[2],o=new Uint32Array(l).fill(0);if(![6,18,26].includes(i))return I.info("bwlabel: conn must be 6, 18 or 26."),[0,o];if(t[0]<2||t[1]<2||t[2]<1)return I.info("bwlabel: img must be 2 or 3-dimensional"),[0,o];if(r)for(let t=0;t<l;t++)0!==e[t]&&(o[t]=1);else o.set(e);let[n,h,d]=this.do_initial_labelling(o,t,i);void 0===h&&(h=new Uint32Array);let[c,m]=this.translate_labels(d,t,h,n);if(I.info(i+" neighbor clustering into "+c+" regions in "+(Date.now()-a)+"ms"),s){let[e,t]=this.largest_original_cluster_labels(o,c,m);return[e,t]}return[c,m]}async createConnectedLabelImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:26,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.getVolumeIndexByID(e),a=Uint32Array.from(this.volumes[s].dims?.slice(1,4)??[]),l=Uint32Array.from(this.volumes[s].img?.slice()??[]),[o,n]=this.bwlabel(l,a,t,i,r),h=this.volumes[s].clone();h.opacity=.5,h.colormap="random";for(let e=0;e<h.img.length;e++)h.img[e]=n[e];return h.cal_min=0,h.cal_max=o,h}async scalecropUint8(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=e.length,l=new Uint8Array(a);for(let o=0;o<a;o++){let a=e[o];a=Math.min(a=Math.max(a=t+s*(a-r),t),i),l[o]=a}return l}async scalecropFloat32(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=e.length,l=new Float32Array(a);for(let o=0;o<a;o++){let a=e[o];a=Math.min(a=Math.max(a=t+s*(a-r),t),i),l[o]=a}return l}getScale(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.999,a=e.global_min,l=e.global_max;if(2===e.hdr.datatypeCode)return[a,1];if((!isFinite(r)||!isFinite(s))&&isFinite(e.cal_min)&&isFinite(e.cal_max)&&e.cal_max>e.cal_min){a=e.cal_min;let r=(i-t)/((l=e.cal_max)-a);return I.info(" Robust Rescale:  min: "+a+"  max: "+l+" scale: "+r),console.log("Robust Rescale:  min: "+a+"  max: "+l+" scale: "+r),[a,r]}let o=e.img,n=e.hdr.dims[1]*e.hdr.dims[2]*e.hdr.dims[3];if(1!==e.hdr.scl_slope||0!==e.hdr.scl_inter){let t=e.img,i=new Float32Array(e.img.length);for(let r=0;r<n;r++)i[r]=t[r]*e.hdr.scl_slope+e.hdr.scl_inter}if(a<0&&I.warn("WARNING: Input image has value(s) below 0.0 !"),I.info(" Input:    min: "+a+"  max: "+l),0===r&&1===s)return[a,1];let h=0;for(let e=0;e<n;e++)Math.abs(o[e])>=1e-15&&h++;let d=(l-a)/1e3,c=Array(1e3).fill(0);for(let e=0;e<n;e++){let t=Math.floor((o[e]-a)/d);t=Math.min(t,999),c[t]++}let m=Array(1e3).fill(0);m[0]=c[0];for(let e=1;e<1e3;e++)m[e]=m[e-1]+c[e];let A=Math.floor(r*n),g=0;for(;g<1e3&&!(m[g]>=A);){;g++}let u=a;for(a=g*d+u,A=n-Math.floor((1-s)*h),g=0;g<999&&!(m[g+1]>=A);){;g++}let f=1;return a!==(l=g*d+u)&&(f=(i-t)/(l-a)),I.info(" Rescale:  min: "+a+"  max: "+l+" scale: "+f),[a,f]}conformVox2Vox(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.flat(),l=h.al(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]),d=o.al(e[1]/2,e[2]/2,e[3]/2,1),c=o.Ue(),m=h.Ue();h.p4(m,l),o.fF(c,d,m);let A=n.al(c[0],c[1],c[2]),g=n.al(r,r,r),u=h.al(-1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);s&&(u=h.al(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),h.p4(u,u);let f=o.al(i,i,i,1),p=h.Ue();h.bA(p,u,g);let v=o.al(f[0],f[1],f[2],1);o.fF(v,v,p),o.bA(v,v,.5);let x=n.Ue();n.$X(x,A,n.al(v[0],v[1],v[2]));let w=h.Ue();h.p4(w,p),w[3]=x[0],w[7]=x[1],w[11]=x[2];let C=h.Ue();h.U_(C,w);let b=h.Ue();h.dC(b,l,C);let y=h.Ue();return h.U_(y,b),[w,b,y]}async createNiftiArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[256,256,256],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0,0,-128,0,1,0,-128,0,0,1,-128,0,0,0,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Uint8Array;return await t2.createNiftiArray(e,t,i,r,s)}async niftiArray2NVImage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;return await t2.loadFromUrl({url:e})}async loadFromUrl(e){return await t2.loadFromUrl({url:e})}async conform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.conformVox2Vox(e.hdr.dims,e.hdr.affine.flat(),256,1,t),l=a[0],o=a[2],n=new Float32Array(0x1000000),h=new Float32Array(e.img),d=e.hdr.dims[1]*e.hdr.dims[2]*e.hdr.dims[3];if(1!==e.hdr.scl_slope||0!==e.hdr.scl_inter)for(let t=0;t<d;t++)h[t]=h[t]*e.hdr.scl_slope+e.hdr.scl_inter;let c=e.hdr.dims[1],m=e.hdr.dims[2],A=e.hdr.dims[3],g=c*m,u=-1;function f(e,t,i){return e+t*c+i*g}let p=o[0],v=o[4],x=o[8];if(i)for(let e=0;e<256;e++)for(let t=0;t<256;t++){let i=t*o[1]+e*o[2]+o[3],r=t*o[5]+e*o[6]+o[7],s=t*o[9]+e*o[10]+o[11];for(let e=0;e<256;e++){let t,a=e*p+i,l=e*v+r,o=e*x+s,d=Math.floor(a),f=Math.floor(l),w=Math.floor(o);if(u++,d<0||f<0||w<0)continue;let C=Math.ceil(l),b=Math.ceil(o);if(Math.ceil(a)>=c||C>=m||b>=A)continue;let y=a-d,I=l-f,M=o-w,D=1-y,F=1-I,T=1-M,E=d+f*c+w*g;t=0+h[E]*D*F*T+h[E+g]*D*F*M+h[E+c]*D*I*T+h[E+c+g]*D*I*M+h[E+1]*y*F*T+h[E+1+g]*y*F*M+h[E+1+c]*y*I*T+h[E+1+c+g]*y*I*M,n[u]=t}}else for(let e=0;e<256;e++)for(let t=0;t<256;t++){let i=t*o[1]+e*o[2]+o[3],r=t*o[5]+e*o[6]+o[7],s=t*o[9]+e*o[10]+o[11];for(let e=0;e<256;e++){let t=Math.round(e*p+i),a=Math.round(e*v+r),l=Math.round(e*x+s);if(u++,!(t<0)&&!(a<0)&&!(l<0)&&!(t>=c)&&!(a>=m)&&!(l>=A))n[u]=h[t+a*c+l*g]}}let w=0;s&&(w=NaN);let C=new Uint8Array;if(r){let t=await this.getScale(e,0,1,w),i=await this.scalecropFloat32(n,0,1,t[0],t[1]);C=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(l),16,new Uint8Array(i.buffer))}else{let t=await this.getScale(e,0,255,w),i=await this.scalecropUint8(n,0,255,t[0],t[1]);C=await this.createNiftiArray([256,256,256],[1,1,1],Array.from(l),2,i)}return await this.niftiArray2NVImage(C)}setRenderDrawAmbientOcclusion(e){if(!this.renderShader)throw Error("renderShader undefined");this.renderDrawAmbientOcclusion=e,this.renderShader.use(this.gl),this.gl.uniform1fv(this.renderShader.uniforms.renderDrawAmbientOcclusion,[this.renderDrawAmbientOcclusion,1]),this.drawScene()}setColorMap(e,t){this.setColormap(e,t)}setColormapNegative(e,t){let i=this.getVolumeIndexByID(e);this.volumes[i].colormapNegative=t,this.updateGLVolume()}setModulationImage(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.getVolumeIndexByID(e),s=null;t.length>0&&(s=this.getVolumeIndexByID(t)),this.volumes[r].modulationImage=s,this.volumes[r].modulateAlpha=i,this.updateGLVolume()}setGamma(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.scene.gamma=e,tG.gamma=e,this.updateGLVolume()}async loadDeferred4DVolumes(e){let t;let i=this.getVolumeIndexByID(e),r=this.volumes[i];if(!(r.nTotalFrame4D<=r.nFrame4D))(t=r.fileObject?await t2.loadFromFile({file:r.fileObject}):await t2.loadFromUrl({url:r.url}))&&(r.img=t.img.slice(),r.nTotalFrame4D=t.nTotalFrame4D,r.nFrame4D=t.nFrame4D,this.updateGLVolume())}setFrame4D(e,t){let i=this.getVolumeIndexByID(e),r=this.volumes[i];if(t>r.nFrame4D-1&&(t=r.nFrame4D-1),t<0&&(t=0),t!==r.frame4D)r.frame4D=t,this.updateGLVolume(),this.onFrameChange(r,t),this.createOnLocationChange()}getFrame4D(e){let t=this.getVolumeIndexByID(e);return this.volumes[t].frame4D}colormapFromKey(e){return tG.colormapFromKey(e)}colormap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return tG.colormap(e,t)}createColormapTexture(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256;return(null!==e&&this.gl.deleteTexture(e),t<1||i<1)?null:(e=this.gl.createTexture(),this.gl.activeTexture(33985),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texStorage2D(this.gl.TEXTURE_2D,1,this.gl.RGBA8,i,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_R,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),e)}addColormapList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5)||void 0===arguments[5]||arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.length<1&&(a=!1),this.colormapLists.push({name:e,min:t,max:i,alphaThreshold:r,negative:s,visible:a,invert:l})}refreshColormaps(){if(this.colormapLists=[],this.volumes.length<1&&this.meshes.length<1)return;let e=this.volumes.length;if(e>0)for(let t=0;t<e;t++){let e=this.volumes[t],i=is(e.cal_min,e.cal_max,e.cal_minNeg,e.cal_maxNeg);this.addColormapList(e.colormapNegative,i[0],i[1],void 0!==e.alphaThreshold,!0,e.colorbarVisible,e.colormapInvert),this.addColormapList(e.colormap,e.cal_min,e.cal_max,void 0!==e.alphaThreshold,!1,e.colorbarVisible,e.colormapInvert)}let t=this.meshes.length;if(t>0)for(let e=0;e<t;e++){let t=this.meshes[e];if(!t.colorbarVisible)continue;let i=t.layers.length;if("edgeColormap"in t&&"edges"in t&&void 0!==t.edges){let e=is(t.edgeMin,t.edgeMax,NaN,NaN);this.addColormapList(t.edgeColormapNegative,e[0],e[1],!1,!0,!0,t.colormapInvert),this.addColormapList(t.edgeColormap,t.edgeMin,t.edgeMax,!1,!1,!0,t.colormapInvert)}if(!(i<1))for(let t=0;t<i;t++){let i=this.meshes[e].layers[t];if(!i.colorbarVisible||i.colormap.length<1)continue;let r=is(i.cal_min,i.cal_max,i.cal_minNeg,i.cal_maxNeg);this.addColormapList(i.colormapNegative,r[0],r[1],i.alphaThreshold,!0,!0,i.colormapInvert),this.addColormapList(i.colormap,i.cal_min,i.cal_max,i.alphaThreshold,!1,!0,i.colormapInvert)}}let i=this.colormapLists.length;if(i<1)return;this.colormapTexture=this.createColormapTexture(this.colormapTexture,i+1);let r=new Uint8ClampedArray;function s(e){let t=new Uint8ClampedArray(r.length+e.length);t.set(r),t.set(e,r.length),r=t}for(let e=0;e<i;e++)s(Array.from(this.colormap(this.colormapLists[e].name,this.colormapLists[e].invert)));return s(Array.from(this.drawLut.lut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,256,i+1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r),this}sliceScale(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.screenFieldOfViewMM(0);e&&(t=this.screenFieldOfViewVox(0));let i=Math.max(t[0],Math.max(t[1],t[2])),r=[t[0]/i,t[1]/i,t[2]/i];if(!this.back?.dims)throw Error("back.dims undefined");return{volScale:r,vox:[this.back.dims[1],this.back.dims[2],this.back.dims[3]],longestAxis:i,dimsMM:t}}tileIndex(e,t){for(let i=0;i<this.screenSlices.length;i++){let r=this.screenSlices[i].leftTopWidthHeight;if(e>r[0]&&t>r[1]&&e<r[0]+r[2]&&t<r[1]+r[3])return i}return -1}inRenderTile(e,t){let i=this.tileIndex(e,t);return i>=0&&4===this.screenSlices[i].axCorSag?i:-1}sliceScroll3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0!==e){if(this.volumes.length>0&&this.scene.clipPlaneDepthAziElev[0]<1.8){let t=this.scene.clipPlaneDepthAziElev.slice();return(e>0&&(t[0]=Math.min(1.5,t[0]+.025)),e<0&&(t[0]=Math.max(-1.5,t[0]-.025)),t[0]!==this.scene.clipPlaneDepthAziElev[0])?(this.scene.clipPlaneDepthAziElev=t,this.setClipPlane(this.scene.clipPlaneDepthAziElev)):void 0}e>0&&(this.scene.volScaleMultiplier=Math.min(2,1.1*this.scene.volScaleMultiplier)),e<0&&(this.scene.volScaleMultiplier=Math.max(.5,.9*this.scene.volScaleMultiplier)),this.drawScene()}}deleteThumbnail(){if(!!this.bmpTexture)this.gl.deleteTexture(this.bmpTexture),this.bmpTexture=null,this.thumbnailVisible=!1}inGraphTile(e,t){if(this.graph.opacity<=0||this.volumes.length<1||this.volumes[0].nFrame4D<1||!this.graph.plotLTWH||this.graph.plotLTWH[2]<1||this.graph.plotLTWH[3]<1)return!1;let i=[(e-this.graph.LTWH[0])/this.graph.LTWH[2],(t-this.graph.LTWH[1])/this.graph.LTWH[3]];return i[0]>0&&i[1]>0&&i[0]<=1&&i[1]<=1}updateBitmapFromClickToSegment(){if(null===this.clickToSegmentGrowingBitmap||null===this.drawBitmap||this.clickToSegmentGrowingBitmap.length!==this.drawBitmap.length)return;let e=this.drawBitmap.length;for(let t=0;t<e;t++)this.drawBitmap[t]=this.clickToSegmentGrowingBitmap[t]}sumBitmap(e){let t=0;for(let i=0;i<e.length;i++)t+=e[i];return t}mouseClick(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];if(e*=this.uiData.dpr,t*=this.uiData.dpr,this.canvas.focus(),this.thumbnailVisible){this.thumbnailVisible=!1,Promise.all([this.loadVolumes(this.deferredVolumes),this.loadMeshes(this.deferredMeshes)]).catch(e=>{throw e});return}if(this.inGraphTile(e,t)){if(!this.graph.plotLTWH)throw Error("plotLTWH undefined");let i=[(e-this.graph.plotLTWH[0])/this.graph.plotLTWH[2],(t-this.graph.plotLTWH[1])/this.graph.plotLTWH[3]];if(i[0]>0&&i[1]>0&&i[0]<=1&&i[1]<=1){let e=Math.round(i[0]*(this.volumes[0].nFrame4D-1));this.setFrame4D(this.volumes[0].id,e);return}i[0]>.5&&i[1]>1&&this.loadDeferred4DVolumes(this.volumes[0].id).catch(e=>{throw e});return}if(this.inRenderTile(e,t)>=0){this.sliceScroll3D(i),this.drawScene();return}if(!(this.screenSlices.length<1)&&!(this.gl.canvas.height<1)&&!(this.gl.canvas.width<1))for(let s=0;s<this.screenSlices.length;s++){let a=this.screenSlices[s].axCorSag;if(this.drawPenAxCorSag>=0&&this.drawPenAxCorSag!==a||a>2)continue;let l=this.screenXY2TextureFrac(e,t,s,!1);if(!(l[0]<0)){if(!r){this.scene.crosshairPos[2-a]=i,this.drawScene();return}if(0!==i){let e=1;i<0&&(e=-1);let t=[0,0,0];t[2-a]=e,this.moveCrosshairInVox(t[0],t[1],t[2]),this.drawScene(),this.createOnLocationChange(a);return}if(this.opts.isForceMouseClickToVoxelCenters?this.scene.crosshairPos=n.d9(this.vox2frac(this.frac2vox(l))):this.scene.crosshairPos=n.d9(l),this.opts.drawingEnabled){let i=this.frac2vox(this.scene.crosshairPos);if(this.opts.clickToSegment){l=this.screenXY2TextureFrac(this.clickToSegmentXY[0],this.clickToSegmentXY[1],s,!1),i=this.frac2vox(l);let r=0,o=this.opts.clickToSegmentPercent+r;if(this.uiData.mousedown){let i=(this.clickToSegmentXY[0]-e)/this.gl.canvas.width;r=Math.max(Math.abs(i),Math.abs((this.clickToSegmentXY[1]-t)/this.gl.canvas.height)),o=this.opts.clickToSegmentPercent+r}let n=this.back.getValue(i[0],i[1],i[2]);this.opts.clickToSegmentAutoIntensity&&(0!==o&&(0===n&&(n=.01),this.opts.clickToSegmentIntensityMax=n*(1+o),this.opts.clickToSegmentIntensityMin=n*(1-o)),n>(this.back.cal_min+this.back.cal_max)*.5?this.opts.clickToSegmentBright=!0:this.opts.clickToSegmentBright=!1);let h=this.opts.clickToSegmentBright?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.drawPenAxCorSag=a,0===this.drawPenAxCorSag){let e=Math.min(this.back.pixDimsRAS[0],this.back.pixDimsRAS[1]);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/e)}else if(1===this.drawPenAxCorSag){let e=Math.min(this.back.pixDimsRAS[0],this.back.pixDimsRAS[2]);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/e)}else if(2===this.drawPenAxCorSag){let e=Math.min(this.back.pixDimsRAS[1],this.back.pixDimsRAS[2]);this.opts.penSize=Math.ceil(this.opts.clickToSegmentRadius/e)}if(this.drawPt(i[0],i[1],i[2],this.opts.penValue),0!==r?(this.clickToSegmentIsGrowing=!0,this.clickToSegmentGrowingBitmap=this.drawBitmap.slice()):this.clickToSegmentIsGrowing=!1,this.drawFloodFill([i[0],i[1],i[2]],0,h,this.opts.clickToSegmentIntensityMin,this.opts.clickToSegmentIntensityMax,this.opts.floodFillNeighbors,this.opts.clickToSegmentMaxDistanceMM,this.opts.clickToSegmentIs2D),this.drawScene(),this.createOnLocationChange(a),this.clickToSegmentIsGrowing)return;let d=this.getDescriptives({layer:0,masks:[],drawingIsMask:!0});this.onClickToSegment({mL:d.volumeML,mm3:d.volumeMM3});return}if(!isFinite(this.opts.penValue)||this.opts.penValue<0||Object.is(this.opts.penValue,-0)){isFinite(this.opts.penValue)?this.drawFloodFill(i,Math.abs(this.opts.penValue),this.opts.penValue,NaN,NaN,this.opts.floodFillNeighbors):this.drawFloodFill(i,0,this.opts.penValue,NaN,NaN,this.opts.floodFillNeighbors);return}if(isNaN(this.drawPenLocation[0]))this.drawPenAxCorSag=a,this.drawPenFillPts=[],this.drawPt(...i,this.opts.penValue);else{if(i[0]===this.drawPenLocation[0]&&i[1]===this.drawPenLocation[1]&&i[2]===this.drawPenLocation[2])return;this.drawPenLine(i,this.drawPenLocation,this.opts.penValue)}this.drawPenLocation=i,this.opts.isFilledPen&&this.drawPenFillPts.push(i),this.refreshDrawing(!1)}this.drawScene(),this.createOnLocationChange(a);return}}}drawRuler(){let e=[],t=[];for(let i=0;i<this.screenSlices.length;i++){if(4!==this.screenSlices[i].axCorSag){if(this.screenSlices[i].fovMM.length>1){t=this.screenSlices[i].leftTopWidthHeight,e=this.screenSlices[i].fovMM;break}}}if(t.length<4)return;let i=100/e[0]*t[2],r=Math.max(Math.round(.1*i),2),s=Math.floor(t[0]+.5*t[2]-.5*i),a=Number(this.opts.rulerWidth),l=Math.floor(t[1]+t[3]-r)+.5*a,o=[s,l,s+i,l],n=[0,0,0,1];this.opts.rulerColor[0]+this.opts.rulerColor[1]+this.opts.rulerColor[2]<.8&&(n=[1,1,1,1]),this.drawRuler10cm(o,n,a+1),this.drawRuler10cm(o,this.opts.rulerColor,a)}drawRuler10cm(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!this.lineShader)throw Error("lineShader undefined");this.gl.bindVertexArray(this.genericVAO),this.lineShader.use(this.gl),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,t),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,i),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4);let r=-.1*(e[0]-e[2]),s=e[1]-Math.floor(.5*this.opts.rulerWidth),a=Math.floor(s-.35*r),l=Math.floor(s-.7*r);for(let t=0;t<11;t++){let o=e[0]+t*r,n=[o=Math.min(o=Math.max(o,e[0]+.5*i),e[2]-.5*i),s,o,a];t%5==0&&(n[3]=l),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,n),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}this.gl.bindVertexArray(this.unusedVAO)}screenXY2mm(e,t){let i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;for(let s=0;s<this.screenSlices.length;s++){let a=s;if(r>=0&&(a=r),this.screenSlices[a].axCorSag>2)continue;let l=this.screenSlices[a].leftTopWidthHeight;if(e<l[0]||t<l[1]||e>l[0]+l[2]||t>l[1]+l[3]||(i=this.screenXY2TextureFrac(e,t,a,!1))[0]<0)continue;let n=this.frac2mm(i);return o.al(n[0],n[1],n[2],a)}return o.al(NaN,NaN,NaN,NaN)}dragForPanZoom(e){let t=this.screenXY2mm(e[2],e[3]);if(isNaN(t[0]))return;let i=this.screenXY2mm(e[0],e[1],t[3]);if(isNaN(i[0])||isNaN(t[0])||isNaN(t[3]))return;let r=o.Ue(),s=this.uiData.pan2DxyzmmAtMouseDown[3];o.lu(r,t,i),this.scene.pan2Dxyzmm[0]=this.uiData.pan2DxyzmmAtMouseDown[0]+s*r[0],this.scene.pan2Dxyzmm[1]=this.uiData.pan2DxyzmmAtMouseDown[1]+s*r[1],this.scene.pan2Dxyzmm[2]=this.uiData.pan2DxyzmmAtMouseDown[2]+s*r[2],this.canvas.focus()}dragForCenterButton(e){this.dragForPanZoom(e)}dragForSlicer3D(e){let t=this.uiData.pan2DxyzmmAtMouseDown[3],i=e[3]-e[1];t+=.01*i,t=Math.min(t=Math.max(t,.1),10);let r=this.scene.pan2Dxyzmm[3]-t;this.opts.yoke3Dto2DZoom&&(this.scene.volScaleMultiplier=t),this.scene.pan2Dxyzmm[3]=t;let s=this.frac2mm(this.scene.crosshairPos);this.scene.pan2Dxyzmm[0]+=r*s[0],this.scene.pan2Dxyzmm[1]+=r*s[1],this.scene.pan2Dxyzmm[2]+=r*s[2]}drawMeasurementTool(e){let t=this.gl;if(t.bindVertexArray(this.genericVAO),t.depthFunc(t.ALWAYS),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),!this.lineShader)throw Error("lineShader undefined");this.lineShader.use(this.gl),t.uniform4fv(this.lineShader.uniforms.lineColor,this.opts.rulerColor),t.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[t.canvas.width,t.canvas.height]),t.uniform1f(this.lineShader.uniforms.thickness,this.opts.rulerWidth),t.uniform4fv(this.lineShader.uniforms.startXYendXY,e),t.drawArrays(t.TRIANGLE_STRIP,0,4);let i=this.opts.measureLineColor;i[3]=1,t.uniform4fv(this.lineShader.uniforms.lineColor,i);let r=this.opts.rulerWidth;t.uniform1f(this.lineShader.uniforms.thickness,2*r);let s=[e[0],e[1]-r,e[0],e[1]+r];t.uniform4fv(this.lineShader.uniforms.startXYendXY,s),t.drawArrays(t.TRIANGLE_STRIP,0,4),s=[e[2],e[3]-r,e[2],e[3]+r],t.uniform4fv(this.lineShader.uniforms.startXYendXY,s),t.drawArrays(t.TRIANGLE_STRIP,0,4);let a=this.canvasPos2frac([e[0],e[1]]),l=this.canvasPos2frac([e[2],e[3]]);if(a[0]>=0&&l[0]>=0){let t=this.frac2mm(a);a=n.al(t[0],t[1],t[2]);let i=this.frac2mm(l);l=n.al(i[0],i[1],i[2]);let r=n.Ue();n.lu(r,a,l);let s=n.Zh(r),o=2;s>9&&(o=1),s>99&&(o=0);let h=s.toFixed(o);this.opts.showMeasureUnits&&(h=`${h} mm`);let d=e,[c,m,A,g]=e,{origin:u,terminus:f}=function(e,t,i,r,s){let a=e-i,l=t-r;if(0===a&&0===l)return{origin:[i+30,r],terminus:[i+s,r]};let o=Math.sqrt(a*a+l*l),n=s*a/o,h=s*l/o;return{origin:[e+n,t+h],terminus:[i-n,r-h]}}(c,m,A,g,30);switch(this.opts.measureTextJustify){case"start":d=[...u,...u.map(e=>e+1)];break;case"end":d=d=[...f,...f.map(e=>e+1)];break;default:d=e}this.drawTextBetween(d,h,this.opts.measureTextHeight/this.opts.textHeight,this.opts.measureTextColor)}t.bindVertexArray(this.unusedVAO)}drawRect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,0,0,-1];if(t[3]<0&&(t=this.opts.crosshairColor),!this.rectShader)throw Error("rectShader undefined");this.opts.selectionBoxIsOutline?(this.drawCircle(e,t,.1),this.rectOutlineShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform1f(this.rectOutlineShader.uniforms.thickness,this.opts.selectionBoxLineThickness),this.gl.uniform4fv(this.rectOutlineShader.uniforms.lineColor,t),this.gl.uniform2fv(this.rectOutlineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectOutlineShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3])):(this.rectShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.rectShader.uniforms.lineColor,t),this.gl.uniform2fv(this.rectShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.rectShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3])),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawCircle(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.opts.fontColor,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!this.circleShader)throw Error("circleShader undefined");this.circleShader.use(this.gl),this.gl.enable(this.gl.BLEND),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,t),this.gl.uniform2fv(this.circleShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform4f(this.circleShader.uniforms.leftTopWidthHeight,e[0],e[1],e[2],e[3]),this.gl.uniform1f(this.circleShader.uniforms.fillPercent,i),this.gl.uniform4fv(this.circleShader.uniforms.circleColor,t),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawSelectionBox(e){if(6===this.opts.dragMode){this.drawCircle(e,this.opts.selectionBoxColor,.1);return}this.drawRect(e,this.opts.selectionBoxColor)}effectiveCanvasHeight(){return this.gl.canvas.height-this.colorbarHeight}effectiveCanvasWidth(){return this.gl.canvas.width-this.getLegendPanelWidth()}getAllLabels(){let e=this.meshes.filter(e=>"connectome"===e.type).flatMap(e=>e.nodes).map(e=>e.label).filter(e=>void 0!==e);return[...this.document.labels,...e]}getConnectomeLabels(){let e=this.meshes.filter(e=>"connectome"===e.type).flatMap(e=>e.nodes).map(e=>e.label).filter(e=>void 0!==e),t=this.document.labels.filter(e=>null==e.anchor||0===e.anchor),i=new Set(e);for(let e of t)i.add(e);return Array.from(i)}getBulletMarginWidth(){let e=0,t=this.getConnectomeLabels();if(0===t.length)return 0;let i=1===t.length?t[0].style.bulletScale:t.reduce((e,t)=>e.style.bulletScale>t.style.bulletScale?e:t).style.bulletScale,r=1===t.length?t[0]:t.reduce((e,t)=>{let i=this.opts.textHeight*this.gl.canvas.height*e.style.textScale,r=this.opts.textHeight*this.gl.canvas.height*t.style.textScale;return this.textHeight(i,e.text)>this.textHeight(r,t.text)?e:t}),s=this.opts.textHeight*this.gl.canvas.height*r.style.textScale;return e=this.textHeight(s,r.text)*i+s}getLegendPanelWidth(){let e=this.getConnectomeLabels();if(!this.opts.showLegend||0===e.length)return 0;let t=this.opts.textHeight*this.gl.canvas.height*1,i=0,r=e.reduce((e,t)=>{let i=this.opts.textHeight*this.gl.canvas.height*e.style.textScale,r=this.opts.textHeight*this.gl.canvas.height*t.style.textScale;return this.textWidth(i,e.text)>this.textWidth(r,t.text)?e:t}),s=this.opts.textHeight*this.gl.canvas.height*r.style.textScale,a=this.textWidth(s,r.text),l=this.getBulletMarginWidth();return(a&&(i=l+a+2*t),i>=this.gl.canvas.width)?0:i}getLegendPanelHeight(){let e=this.getConnectomeLabels(),t=0,i=this.opts.textHeight*this.gl.canvas.height*1;for(let i of e){let e=this.opts.textHeight*this.gl.canvas.height*i.style.textScale;t+=this.textHeight(e,i.text)}return t&&(t+=i/2*(e.length+1)),t}reserveColorbarPanel(){let e=Math.max(this.opts.textHeight,.01),t=3*(e*=Math.min(this.gl.canvas.height,this.gl.canvas.width)),i=[0,this.gl.canvas.height-t,this.gl.canvas.width,t];return this.colorbarHeight=i[3]+1,i}drawColorbarCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5?arguments[5]:void 0;if(t[2]<=0||t[3]<=0)return;let l=Math.max(this.opts.textHeight,.01),o=l*=Math.min(this.gl.canvas.height,this.gl.canvas.width),n=3*l,h=l;if(t[3]<n){if(t[3]<3)return;o=1,h=t[3]-2}this.gl.disable(this.gl.DEPTH_TEST),this.colorbarHeight=t[3]+1;let d=[t[0]+o,t[1],t[2]-2*o,h],c=[d[0]-1,d[1]-1,d[2]+2,d[3]+2];if(this.drawRect(c,this.opts.crosshairColor),!this.colorbarShader)throw Error("colorbarShader undefined");this.colorbarShader.use(this.gl),this.gl.activeTexture(33985),this.gl.bindTexture(this.gl.TEXTURE_2D,this.colormapTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);if(this.gl.uniform1f(this.colorbarShader.uniforms.layer,e),this.gl.uniform2fv(this.colorbarShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.disable(this.gl.CULL_FACE),i){let e=[d[0]+d[2],d[1],-d[2],d[3]];this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,e)}else this.gl.uniform4fv(this.colorbarShader.uniforms.leftTopWidthHeight,d);this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);let m=0;if(a&&s<0&&i?(m=s,s=0):a&&r>0&&(m=r,r=0),r===s||l<1)return;let A=Math.abs(s-r),[g,u]=ii(r,s);u<r&&(u+=g);let f=u,p=[0,d[1]+d[3]-.5*l,2,.75*l],v=p[1]+p[3];for(;f<=s;){p[0]=d[0]+(f-r)/A*d[2],this.drawRect(p);let e=(1*f).toFixed(6).replace(/\.?0*$/,"");this.drawTextBelow([p[0],v],e),f+=g}if(0!==m){let e=[d[0]+(m-r)/A*d[2],d[1]-.25*d[3],2,1.5*d[3]];this.drawRect(e)}}drawColorbar(){let e=this.colormapLists,t=e.length;if(t<1)return;let i=0;for(let r=0;r<t;r++)e[r].visible&&i++;if(i<1)return;let r=this.reserveColorbarPanel(),s=Math.max(this.opts.textHeight,.01),a=3*(s*=Math.min(this.gl.canvas.height,this.gl.canvas.width)),l=r[2]/i;(r[2]<=0||r[3]<=0)&&(l=this.gl.canvas.width/i,r=[0,this.gl.canvas.height-a,l,a]),r[2]=l;for(let i=0;i<t;i++){if(!!e[i].visible)this.drawColorbarCore(i,r,e[i].negative,e[i].min,e[i].max,e[i].alphaThreshold),r[0]+=l}}textWidth(e,t){if(!t)return 0;let i=0,r=new TextEncoder().encode(t);for(let s=0;s<t.length;s++)i+=e*this.fontMets.mets[r[s]].xadv;return i}textHeight(e,t){if(!t)return 0;let i=new Set(Array.from(t)),r=new TextEncoder().encode(Array.from(i).join(""));return e*Object.values(this.fontMets.mets).filter((e,t)=>r.includes(t)).reduce((e,t)=>e.lbwh[3]>t.lbwh[3]?e:t).lbwh[3]}drawChar(e,t,i){if(!this.fontShader)throw Error("fontShader undefined");let r=this.fontMets.mets[i],s=e[0]+t*r.lbwh[0],a=-(t*r.lbwh[1]),l=t*r.lbwh[2],o=t*r.lbwh[3],n=e[1]+(a-o)+t;return this.gl.uniform4f(this.fontShader.uniforms.leftTopWidthHeight,s,n,l,o),this.gl.uniform4fv(this.fontShader.uniforms.uvLeftTopWidthHeight,r.uv_lbwh),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),t*r.xadv}drawLoadingText(e){if(!this.canvas)throw Error("canvas undefined");this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.drawTextBelow([this.canvas.width/2,this.canvas.height/2],e,3)}drawText(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.opts.textHeight<=0)return;if(!this.fontShader)throw Error("fontShader undefined");this.fontShader.use(this.gl);let s=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*i;this.gl.enable(this.gl.BLEND),this.gl.uniform2f(this.fontShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height),null===r&&(r=this.opts.fontColor),this.gl.uniform4fv(this.fontShader.uniforms.fontColor,r);let a=s/this.fontMets.size*this.fontMets.distanceRange;a=Math.max(a,1),this.gl.uniform1f(this.fontShader.uniforms.screenPxRange,a);let l=new TextEncoder().encode(t);this.gl.bindVertexArray(this.genericVAO);for(let i=0;i<t.length;i++)e[0]+=this.drawChar(e,s,l[i]);this.gl.bindVertexArray(this.unusedVAO)}drawTextRight(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!(this.opts.textHeight<=0))e[1]-=.5*this.opts.textHeight*this.gl.canvas.height,this.drawText(e,t,i,r)}drawTextLeft(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.opts.textHeight<=0)return;let s=this.opts.textHeight*this.gl.canvas.height*i;e[0]-=this.textWidth(s,t),e[1]-=.5*s,this.drawText(e,t,i,r)}drawTextRightBelow(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!(this.opts.textHeight<=0))this.drawText(e,t,i,r)}drawTextBetween(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.opts.textHeight<=0)return;let s=[(e[0]+e[2])*.5,(e[1]+e[3])*.5],a=this.opts.textHeight*this.gl.canvas.height*i,l=this.textWidth(a,t);s[0]-=.5*l,s[1]-=.5*a;let o=[s[0]-1,s[1]-1,l+2,a+2],n=r;null===n&&(n=this.opts.crosshairColor),n=n&&n[0]+n[1]+n[2]>.8?[0,0,0,.5]:[1,1,1,.5],this.drawRect(o,n),this.drawText(s,t,i,r)}drawTextBelow(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.opts.textHeight<=0)return;if(!this.canvas)throw Error("canvas undefined");let s=this.opts.textHeight*this.gl.canvas.height*i,a=this.textWidth(s,t);a>this.canvas.width&&(i*=(this.canvas.width-2)/a,s=this.opts.textHeight*this.gl.canvas.height*i,a=this.textWidth(s,t)),e[0]-=.5*this.textWidth(s,t),e[0]=Math.max(e[0],1),e[0]=Math.min(e[0],this.canvas.width-a-1),this.drawText(e,t,i,r)}updateInterpolation(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.gl.LINEAR;!t&&this.opts.isNearestInterpolation&&(i=this.gl.NEAREST),0===e?this.gl.activeTexture(33984):this.gl.activeTexture(33986),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,i),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,i)}setAtlasOutline(e){this.opts.atlasOutline=e,this.updateGLVolume(),this.drawScene()}setInterpolation(e){this.opts.isNearestInterpolation=e;let t=this.volumes.length;if(!(t<1)){for(let e=0;e<t;e++)this.updateInterpolation(e);this.drawScene()}}calculateMvpMatrix2D(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7?arguments[7]:void 0;this.gl.viewport(e[0],this.gl.canvas.height-(e[1]+e[3]),e[2],e[3]);let d=t[0],c=i[0],m=[d,t[1]],A=[c-d,i[1]-t[1]];o&&(m=[i[0],t[1]],A=[t[0]-i[0],i[1]-t[1]],d=-i[0],c=-t[0]);let g=2*Math.max(Math.abs(t[2]),Math.abs(i[2])),u=h.Ue(),f=.01,p=8*g;if(r!==1/0){let e=o;0===l&&(0===a||180===a)&&(e=!e);let t=1.8*g-s;!e&&(t=1.8*g+s),f=t-r,p=t+r}h.M5(u,d,c,t[1],i[1],f,p);let v=h.Ue();v[0]=-1;let x=n.al(0,0,-(1.8*g));h.Iu(v,v,x),h.lM(v,v,ir(270-l)),h.jI(v,v,ir(a-180));let w=h.Ue();h.U_(w,v);let C=h.Ue();h.p4(C,w);let b=h.Ue();return h.Jp(b,u,v),{modelViewProjectionMatrix:b,modelMatrix:v,normalMatrix:C,leftTopMM:m,fovMM:A}}swizzleVec3MM(e,t){return 1===t?e=ia(e,[0,2,1]):2===t&&(e=ia(e,[1,2,0])),e}screenFieldOfViewVox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=n.d9(this.volumeObject3D.fieldOfViewDeObliqueMM);return this.swizzleVec3MM(t,e)}screenFieldOfViewMM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&!this.opts.isSliceMM)return this.screenFieldOfViewVox(e);let i=this.volumeObject3D.extentsMin,r=this.volumeObject3D.extentsMax,s=n.al(i[0],i[1],i[2]),a=n.al(r[0],r[1],r[2]);s=this.swizzleVec3MM(s,e),a=this.swizzleVec3MM(a,e);let l=n.Ue();return n.$X(l,a,s),l}screenFieldOfViewExtendedVox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.volumes[0].extentsMinOrtho,i=this.volumes[0].extentsMaxOrtho,r=n.al(t[0],t[1],t[2]),s=n.al(i[0],i[1],i[2]),a=h.Ue();r=this.swizzleVec3MM(r,e),s=this.swizzleVec3MM(s,e);let l=n.Ue();return n.$X(l,s,r),{mnMM:r,mxMM:s,rotation:a,fovMM:l}}screenFieldOfViewExtendedMM(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.volumeObject3D)throw Error("volumeObject3D undefined");let t=this.volumeObject3D.extentsMin,i=this.volumeObject3D.extentsMax,r=n.al(t[0],t[1],t[2]),s=n.al(i[0],i[1],i[2]),a=h.Ue();r=this.swizzleVec3MM(r,e),s=this.swizzleVec3MM(s,e);let l=n.Ue();return n.$X(l,s,r),{mnMM:r,mxMM:s,rotation:a,fovMM:l}}drawSliceOrientationText(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[NaN,NaN];this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let r="S";0===t&&(r="A");let s=this.opts.isRadiologicalConvention?"R":"L";if(2===t&&(s=this.opts.sagittalNoseLeft?"A":"P"),this.opts.isCornerOrientationText){this.drawTextRightBelow([e[0],e[1]],s+r);return}let a=!0,l=!0;if(!isNaN(i[0])){let t=this.opts.textHeight*this.gl.canvas.height+2;i[1]>t&&(this.drawTextBelow([e[0]+.5*e[2],e[1]+i[1]-t],r),a=!1);let o=this.textWidth(t,s)+2;i[0]>o&&(this.drawTextRight([e[0]+i[0]-o,e[1]+.5*e[3]],s),l=!1)}a&&this.drawTextBelow([e[0]+.5*e[2],e[1]],r),l&&this.drawTextRight([e[0],e[1]+.5*e[3]],s)}xyMM2xyzMM(e,t){let i=2;1===e&&(i=1),2===e&&(i=0);let r=[0,0,0],s=[1,1,0],a=[1,0,1];r[i]=t,s[i]=t,a[i]=t,r=this.frac2mm(r),s=this.frac2mm(s),a=this.frac2mm(a),r=this.swizzleVec3MM(n.al(r[0],r[1],r[2]),e),s=this.swizzleVec3MM(n.al(s[0],s[1],s[2]),e),a=this.swizzleVec3MM(n.al(a[0],a[1],a[2]),e);let l=(s[0]-r[0])*(a[1]-r[1])-(a[0]-r[0])*(s[1]-r[1]),o=(s[0]-r[0])*(a[2]-r[2])-(a[0]-r[0])*(s[2]-r[2]);o/=l;let h=(s[1]-r[1])*(a[2]-r[2])-(a[1]-r[1])*(s[2]-r[2]);h/=l;let d=[0,0,0,0,0];return d[0]=r[0],d[1]=r[1],d[2]=r[2],d[3]=h,d[4]=o,d}draw2DMain(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,r=this.volumes[0].frac2mm.slice(),s=this.screenFieldOfViewExtendedMM(t),a=h.Ue();!this.opts.isSliceMM&&(r=this.volumes[0].frac2mmOrtho.slice(),a=h.d9(this.volumes[0].mm2ortho),s=this.screenFieldOfViewExtendedVox(t));let l=this.opts.isRadiologicalConvention&&t<2;i===1/0||i===-1/0?(l=i!==1/0,1===t&&(l=!l)):this.opts.sagittalNoseLeft&&2===t&&(l=!l);let o=0,d=0;2===t?d=l?90:-90:1===t?d=l?180:0:(d=l?180:0,o=l?-90:90);let c=this.gl,m=!1;if(0===e[2]||0===e[3]){m=!0;let t=c.canvas.width/s.fovMM[0],i=c.canvas.height/s.fovMM[1],r=Math.min(t,i);s.fovMM[0]*=t/r,s.fovMM[1]*=i/r;let a=(s.mnMM[0]+s.mxMM[0])*.5;s.mnMM[0]=a-.5*s.fovMM[0],s.mxMM[0]=a+.5*s.fovMM[0],a=(s.mnMM[1]+s.mxMM[1])*.5,s.mnMM[1]=a-.5*s.fovMM[1],s.mxMM[1]=a+.5*s.fovMM[1],e=[0,0,c.canvas.width,c.canvas.height]}if(isNaN(i)){let e=this.scene.pan2Dxyzmm,i=this.swizzleVec3MM(n.al(e[0],e[1],e[2]),t),r=this.scene.pan2Dxyzmm[3];s.mnMM[0]-=i[0],s.mxMM[0]-=i[0],s.mnMM[1]-=i[1],s.mxMM[1]-=i[1],s.mnMM[0]/=r,s.mxMM[0]/=r,s.mnMM[1]/=r,s.mxMM[1]/=r}let A=2;1===t&&(A=1),2===t&&(A=0);let g=this.scene.crosshairPos[A],u=this.frac2mm(this.scene.crosshairPos);!isNaN(i)&&i!==1/0&&i!==-1/0&&((u=this.frac2mm([.5,.5,.5]))[A]=i,g=this.mm2frac(u)[A]);let f=u[A];c.clear(c.DEPTH_BUFFER_BIT);let p=this.calculateMvpMatrix2D(e,s.mnMM,s.mxMM,1/0,0,d,o,l);if(i===1/0||i===-1/0){let i=e.slice();this.draw3D(e,p.modelViewProjectionMatrix,p.modelMatrix,p.normalMatrix,d,o);let r=this.screenSlices[this.screenSlices.length-1];r.leftTopWidthHeight=i,r.axCorSag=t,r.sliceFrac=1/0,r.AxyzMxy=this.xyMM2xyzMM(t,g),r.leftTopMM=p.leftTopMM,r.fovMM=p.fovMM;return}c.enable(c.DEPTH_TEST),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.disable(c.BLEND),c.depthFunc(c.GREATER),c.disable(c.CULL_FACE);let v=this.sliceMMShader;if(this.opts.isV1SliceShader&&(v=this.sliceV1Shader),!v)throw Error("slice Shader undefined");if(v.use(this.gl),c.uniform1f(v.uniforms.overlayOutlineWidth,this.overlayOutlineWidth),c.uniform1f(v.uniforms.overlayAlphaShader,this.overlayAlphaShader),c.uniform1i(v.uniforms.isAlphaClipDark,this.isAlphaClipDark?1:0),c.uniform1i(v.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),c.uniform1f(v.uniforms.drawOpacity,this.drawOpacity),c.enable(c.BLEND),c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA),c.uniform1f(v.uniforms.opacity,this.volumes[0].opacity),c.uniform1i(v.uniforms.axCorSag,t),c.uniform1f(v.uniforms.slice,g),c.uniformMatrix4fv(v.uniforms.frac2mm,!1,r),c.uniformMatrix4fv(v.uniforms.mvpMtx,!1,p.modelViewProjectionMatrix.slice()),c.bindVertexArray(this.genericVAO),c.drawArrays(c.TRIANGLE_STRIP,0,4),c.bindVertexArray(this.unusedVAO),this.screenSlices.push({leftTopWidthHeight:e,axCorSag:t,sliceFrac:g,AxyzMxy:this.xyMM2xyzMM(t,g),leftTopMM:p.leftTopMM,screen2frac:[],fovMM:p.fovMM}),isNaN(i)&&this.drawCrosshairs3D(!0,1,p.modelViewProjectionMatrix,!0,this.opts.isSliceMM),this.opts.meshThicknessOn2D>0){this.opts.meshThicknessOn2D!==1/0&&(p=this.calculateMvpMatrix2D(e,s.mnMM,s.mxMM,this.opts.meshThicknessOn2D,f,d,o,l));let t=h.d9(p.modelViewProjectionMatrix);h.Jp(t,t,a),this.drawMesh3D(!0,1,t,p.modelMatrix,p.normalMatrix)}isNaN(i)&&this.drawCrosshairs3D(!1,.15,p.modelViewProjectionMatrix,!0,this.opts.isSliceMM),m&&this.drawSliceOrientationText(e,t),this.readyForSync=!0}draw2D(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[NaN,NaN],s=[NaN,NaN];if(r[0]===1/0){let i=this.sliceScale().volScale,s=this.scaleSlice(i[0],i[1],[0,0],[e[2],e[3]]);1===t&&(s=this.scaleSlice(i[0],i[2],[0,0],[e[2],e[3]])),2===t&&(s=this.scaleSlice(i[1],i[2],[0,0],[e[2],e[3]])),r[0]=s[2],r[1]=s[3]}if(isNaN(r[0]))this.draw2DMain(e,t,i);else{let a=e.slice();s[0]=Math.floor(.5*(a[2]-r[0])),s[1]=Math.floor(.5*(a[3]-r[1])),a[0]+=s[0],a[1]+=s[1],a[2]=r[0],a[3]=r[1],this.draw2DMain(a,t,i)}if(i!==1/0&&i!==-1/0&&4!==t)0!==e[2]&&0!==e[3]&&this.drawSliceOrientationText(e,t,s)}calculateMvpMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;(0===t[2]||0===t[3])&&(t=[0,0,this.gl.canvas.width,this.gl.canvas.height]);let s=t[2]/t[3],a=this.furthestFromPivot,l=this.pivot3D,o=h.Ue();a=.8*a/this.scene.volScaleMultiplier,s<1?h.M5(o,-a,a,-a/s,a/s,.01*a,8*a):h.M5(o,-a*s,a*s,-a,a,.01*a,8*a);let d=h.Ue();d[0]=-1;let c=n.al(0,0,-(1.8*a));h.Iu(d,d,c),this.position&&h.Iu(d,d,this.position),h.lM(d,d,ir(270-r)),h.jI(d,d,ir(i-180)),h.Iu(d,d,[-l[0],-l[1],-l[2]]);let m=h.Ue();h.U_(m,d);let A=h.Ue();h.p4(A,m);let g=h.Ue();return h.Jp(g,o,d),[g,d,A]}calculateModelMatrix(e,t){if(!this.back)throw Error("back undefined");let i=h.Ue();if(i[0]=-1,h.lM(i,i,ir(270-t)),h.jI(i,i,ir(e-180)),this.back.obliqueRAS){let e=h.d9(this.back.obliqueRAS);h.Jp(i,i,e)}return i}calculateRayDirection(e,t){let i=this.calculateModelMatrix(e,t),r=h.al(1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1),s=h.Ue();h.Jp(s,r,i);let a=h.Ue();h.U_(a,s);let l=o.al(0,0,-1,1);o.fF(l,l,a);let d=n.al(l[0],l[1],l[2]);return n.Fv(d,d),5e-5>Math.abs(d[0])&&(d[0]=5e-5),5e-5>Math.abs(d[1])&&(d[1]=5e-5),5e-5>Math.abs(d[2])&&(d[2]=5e-5),d}sceneExtentsMinMax(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=n.al(0,0,0),i=n.al(0,0,0);if(this.volumes.length>0){if(!this.volumeObject3D)throw Error("volumeObject3D undefined");t=n.al(this.volumeObject3D.extentsMin[0],this.volumeObject3D.extentsMin[1],this.volumeObject3D.extentsMin[2]),i=n.al(this.volumeObject3D.extentsMax[0],this.volumeObject3D.extentsMax[1],this.volumeObject3D.extentsMax[2]),!e&&(t=n.al(this.volumes[0].extentsMinOrtho[0],this.volumes[0].extentsMinOrtho[1],this.volumes[0].extentsMinOrtho[2]),i=n.al(this.volumes[0].extentsMaxOrtho[0],this.volumes[0].extentsMaxOrtho[1],this.volumes[0].extentsMaxOrtho[2]))}if(this.meshes.length>0){if(this.volumes.length<1){let e=this.meshes[0].extentsMin,r=this.meshes[0].extentsMax;t=n.al(e[0],e[1],e[2]),i=n.al(r[0],r[1],r[2])}for(let e=0;e<this.meshes.length;e++){let r=this.meshes[e].extentsMin,s=this.meshes[e].extentsMax,a=n.al(r[0],r[1],r[2]);n.VV(t,t,a);let l=n.al(s[0],s[1],s[2]);n.Fp(i,i,l)}}let r=n.Ue();return n.$X(r,i,t),[t,i,r]}setPivot3D(){let[e,t]=this.sceneExtentsMinMax(),i=n.Ue();n.IH(i,e,t),n.bA(i,i,.5),this.pivot3D=[i[0],i[1],i[2]],n.$X(i,t,e),this.extentsMin=e,this.extentsMax=t,this.furthestFromPivot=.5*n.kE(i)}getMaxVols(){if(this.volumes.length<1)return 0;let e=0;for(let t=0;t<this.volumes.length;t++)e=Math.max(e,this.volumes[t].nFrame4D);return e}detectPartialllyLoaded4D(){if(this.volumes.length<1)return!1;for(let e=0;e<this.volumes.length;e++)if(this.volumes[e].nFrame4D<this.volumes[e].hdr.dims[4])return!0;return!1}drawGraph(){if(2>this.getMaxVols())return;let e=this.graph,t=0;if(this.graph.autoSizeMultiplanar&&3===this.opts.sliceType)for(let i=0;i<this.screenSlices.length;i++){let r=this.screenSlices[i].axCorSag;if(0===r&&(t=this.screenSlices[i].leftTopWidthHeight[1]),2!==r)continue;let s=this.screenSlices[i].leftTopWidthHeight.slice();s[1]===t?(e.LTWH[0]=s[0]+s[2],e.LTWH[1]=s[1]):(e.LTWH[0]=s[0],e.LTWH[1]=s[1]+s[3]),e.LTWH[2]=s[2],e.LTWH[3]=s[2]}if(e.opacity<=0||e.LTWH[2]<=5||e.LTWH[3]<=5||Math.floor(e.LTWH[0]+e.LTWH[2])>this.gl.canvas.width||Math.floor(e.LTWH[1]+e.LTWH[3])>this.gl.canvas.height)return;e.backColor=[.15,.15,.15,e.opacity],e.lineColor=[1,1,1,1],this.opts.backColor[0]+this.opts.backColor[1]+this.opts.backColor[2]>1.5&&(e.backColor=[.95,.95,.95,e.opacity],e.lineColor=[0,0,0,1]),e.textColor=e.lineColor.slice(),e.lineThickness=4,e.lineAlpha=1,e.lines=[];let i=[];if(e.vols.length<1)null!=this.volumes[0]&&i.push(0);else for(let t=0;t<e.vols.length;t++){let r=e.vols[t];if(null!=this.volumes[r]&&!(this.volumes[r].nFrame4D<2))i.push(r)}if(i.length<1)return;let r=this.volumes[i[0]].nFrame4D;if(this.graph.selectedColumn=this.volumes[i[0]].frame4D,r<2){I.debug("Unable to generate a graph: Selected volume is 3D not 4D");return}for(let t=0;t<i.length;t++){e.lines[t]=[];let s=this.frac2vox(this.scene.crosshairPos),a=this.volumes[i[t]],l=a.nFrame4D;l=Math.min(l,r);for(let i=0;i<l;i++){let r=a.getValue(s[0],s[1],s[2],i);e.lines[t].push(r)}}e.lineRGB=[[1,0,0],[0,.7,0],[0,0,1],[1,1,0],[1,0,1],[0,1,1],[1,1,1],[0,0,0]];let s=e.lines[0][0],a=e.lines[0][0];for(let t=0;t<e.lines.length;t++)for(let i=0;i<e.lines[t].length;i++){let r=e.lines[t][i];s=Math.min(r,s),a=Math.max(r,a)}let l=this.volumes[i[0]].cal_min,o=this.volumes[i[0]].cal_max;if(e.isRangeCalMinMax&&l<o&&isFinite(l)&&isFinite(o)&&(s=l,a=o),e.normalizeValues&&a>s){let t=a-s;for(let i=0;i<e.lines.length;i++)for(let r=0;r<e.lines[i].length;r++){let a=e.lines[i][r];e.lines[i][r]=(a-s)/t}s=0,a=1}s>=a&&(a=s+1),this.drawRect(e.LTWH,e.backColor);let[n,h,d]=ii(s,a),c=Math.max(0,-1*Math.floor(Math.log(n)/Math.log(10)));s=Math.min(h,s),a=Math.max(d,a);let m=.07*(Math.min(e.LTWH[2],e.LTWH[3])/(this.fontMets.size*this.uiData.dpr)),A=this.opts.textHeight*this.gl.canvas.height*m;A<16&&(A=0);let g=0,u=h;if(A>0)for(;u<=a;){let e=u.toFixed(c);g=Math.max(this.textWidth(A,e),g),u+=n}let f=Math.abs(e.LTWH[2]),p=Math.abs(e.LTWH[3]),v=[e.LTWH[0]+.05*f+g,e.LTWH[1]+.05*p,e.LTWH[2]-g-.1*f,e.LTWH[3]-A-.1*p];this.graph.LTWH=e.LTWH,this.graph.plotLTWH=v,this.drawRect(v,this.opts.backColor);let x=a-s,w=v[3]/x,C=v[2]/(e.lines[0].length-1),b=v[1]+v[3];u=h+.5*n;let y=e.lineColor.slice();for(y[3]=.25*e.lineColor[3];u<=a;){let t=b-(u-s)*w;this.drawLine([v[0],t,v[0]+v[2],t],.5*e.lineThickness,y),u+=n}u=h;let M=.5*e.lineThickness;for(;u<=a;){let t=b-(u-s)*w;this.drawLine([v[0]-M,t,v[0]+v[2]+e.lineThickness,t],e.lineThickness,e.lineColor);let i=u.toFixed(c);A>0&&this.drawTextLeft([v[0]-6,t],i,m,e.textColor),u+=n}let D=1;for(;e.lines[0].length/D>20;)D*=5;for(let t=0;t<e.lines[0].length;t+=D){let i=t*C+v[0],r=e.lineThickness;if(t%2==1)r*=.5,this.drawLine([i,v[1],i,v[1]+v[3]],r,y);else{let s=t.toFixed(6).replace(/\.?0*$/,"");A>0&&this.drawTextBelow([i,2+v[1]+v[3]],s,m,e.textColor),this.drawLine([i,v[1],i,v[1]+v[3]],r,e.lineColor)}}for(let t=0;t<e.lines.length;t++){let i=[1,0,0,e.lineAlpha];t<e.lineRGB.length&&(i=[e.lineRGB[t][0],e.lineRGB[t][1],e.lineRGB[t][2],e.lineAlpha]);for(let r=1;r<e.lines[t].length;r++){let a=(r-1)*C,l=r*C,o=(e.lines[t][r-1]-s)*w,n=(e.lines[t][r]-s)*w,h=[v[0]+a,v[1]+v[3]-o,v[0]+l,v[1]+v[3]-n];this.drawLine(h,e.lineThickness,i)}}if(e.selectedColumn>=0&&e.selectedColumn<e.lines[0].length){let t=e.selectedColumn*C+v[0];this.drawLine([t,v[1],t,v[1]+v[3]],e.lineThickness,[e.lineRGB[3][0],e.lineRGB[3][1],e.lineRGB[3][2],1])}this.detectPartialllyLoaded4D()&&this.drawTextBelow([v[0]+v[2],v[1]+v[3]+.5*A],"...",m,e.textColor)}depthPicker(e,t){if(!this.uiData.mouseDepthPicker)return;this.uiData.mouseDepthPicker=!1;let i=this.gl,r=this.mousePos[0]*e[2]/e[2],s=i.canvas.height-this.mousePos[1]*e[3]/e[3]-1,a=new Uint8Array(4);if(i.readPixels(r,s,1,1,i.RGBA,i.UNSIGNED_BYTE,a),this.selectedObjectId=a[3],this.selectedObjectId===this.VOLUME_ID){this.scene.crosshairPos=new Float32Array(a.slice(0,3)).map(e=>e/255);return}let l=function(e){let t=[1/0x1000000,1/65536,1/256,1];return(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3])/255}(a);if(l>1)return;let n=(this.mousePos[0]-e[0])/e[2],d=function(e,t,i,r){let s=o.al(e,t,i,1),a=h.d9(r);h.U_(a,a),s[0]=2*s[0]-1,s[1]=2*s[1]-1,s[2]=2*s[2]-1;let l=o.Ue();return(o.fF(l,s,a),0===l[3])?l:(l[0]/=l[3],l[1]/=l[3],l[2]/=l[3],l)}(n,(i.canvas.height-this.mousePos[1]-e[1])/e[3],l,t),c=this.mm2frac(d,0,!0);if(!(c[0]<0)&&!(c[0]>1)&&!(c[1]<0)&&!(c[1]>1)&&!(c[2]<0)&&!(c[2]>1))this.scene.crosshairPos=this.mm2frac(d,0,!0)}drawImage3D(e,t,i){if(0===this.volumes.length)return;let r=this.gl,s=this.calculateRayDirection(t,i),a=this.volumeObject3D;if(a){r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),r.enable(r.CULL_FACE),r.cullFace(r.FRONT);let l=this.renderShader;if(this.uiData.mouseDepthPicker&&(l=this.pickingImageShader),l.use(this.gl),r.uniform1i(l.uniforms.backgroundMasksOverlays,this.backgroundMasksOverlays),this.gradientTextureAmount>0){r.activeTexture(33990),r.bindTexture(r.TEXTURE_3D,this.gradientTexture);let e=this.calculateModelMatrix(t,i),s=h.Ue();h.U_(s,e);let a=h.Ue();h.p4(a,s),r.uniformMatrix4fv(l.uniforms.normMtx,!1,a)}this.drawBitmap&&this.drawBitmap.length>8?r.uniform2f(l.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,this.drawOpacity):r.uniform2f(l.uniforms.renderDrawAmbientOcclusionXY,this.renderDrawAmbientOcclusion,0),r.uniformMatrix4fv(l.uniforms.mvpMtx,!1,e),r.uniformMatrix4fv(l.uniforms.matRAS,!1,this.back.matRAS),r.uniform3fv(l.uniforms.rayDir,s),this.gradientTextureAmount<0?r.uniform4fv(l.uniforms.clipPlane,[this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2],30]):r.uniform4fv(l.uniforms.clipPlane,this.scene.clipPlane),r.uniform1f(l.uniforms.drawOpacity,1),r.bindVertexArray(a.vao),r.drawElements(a.mode,a.indexCount,r.UNSIGNED_SHORT,0),r.bindVertexArray(this.unusedVAO)}}drawOrientationCube(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.opts.isOrientCube)return;let r=.05*Math.min(e[2],e[3]);if(r<5)return;let s=this.gl;s.enable(s.CULL_FACE),s.cullFace(s.BACK),this.orientCubeShader.use(this.gl),s.bindVertexArray(this.orientCubeShaderVAO);let a=h.Ue(),l=h.Ue();h.M5(l,0,s.canvas.width,0,s.canvas.height,-10*r,10*r);let o=0;0===e[1]&&(o=s.canvas.height-this.effectiveCanvasHeight()),h.Iu(a,a,[1.8*r+e[0],o+1.8*r+e[1],0]),h.bA(a,a,[r,r,r]),h.lM(a,a,ir(270-i)),h.jI(a,a,ir(-t));let n=h.Ue();h.Jp(n,l,a),s.uniformMatrix4fv(this.orientCubeShader.uniforms.u_matrix,!1,n),s.drawArrays(s.TRIANGLE_STRIP,0,168),s.bindVertexArray(this.unusedVAO),this.gl.disable(this.gl.CULL_FACE)}createOnLocationChange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,[t,i,r]=this.sceneExtentsMinMax(!0),s=Math.max(Math.max(r[0],r[1]),r[2]),a=Math.max(0,-Math.ceil(Math.log10(Math.abs(.001*s)))),l=this.frac2mm(this.scene.crosshairPos,0,!0);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return parseFloat(e.toFixed(t))}let n=o(l[0],a)+"\xd7"+o(l[1],a)+"\xd7"+o(l[2],a);if(this.volumes.length>0&&this.volumes[0].nFrame4D>0&&(n+="\xd7"+o(this.volumes[0].frame4D)),this.volumes.length>0){let e=" = ";for(let t=0;t<this.volumes.length;t++){let i=this.volumes[t].mm2vox(l),r=this.volumes[t].getValue(i[0],i[1],i[2],this.volumes[t].frame4D);if(a=3,null!==this.volumes[t].colormapLabel){let i=Math.round(r);i>=0&&i<this.volumes[t].colormapLabel.labels.length?e+=this.volumes[t].colormapLabel.labels[i]:e+="undefined("+o(r,a)+")"}else e+=o(r,a);this.volumes[t].imaginary&&((r=this.volumes[t].getValue(i[0],i[1],i[2],this.volumes[t].frame4D,!0))>=0&&(e+="+"),e+=o(r,a)),e+="   "}n+=e;let t=this.back.dimsRAS,i=t[1]*t[2]*t[3];if(this.drawBitmap&&this.drawBitmap.length===i){let e=this.frac2vox(this.scene.crosshairPos),i=e[0]+e[1]*t[1]+e[2]*t[1]*t[2];n+=" "+this.drawLut.labels[this.drawBitmap[i]]}}let h={mm:this.frac2mm(this.scene.crosshairPos,0,!0),axCorSag:e,vox:this.frac2vox(this.scene.crosshairPos),frac:this.scene.crosshairPos,xy:[this.mousePos[0],this.mousePos[1]],values:this.volumes.map(e=>{let t=this.frac2mm(this.scene.crosshairPos,0,!0),i=e.mm2vox(t),r=e.getValue(i[0],i[1],i[2],e.frame4D);return{name:e.name,value:r,id:e.id,mm:t,vox:i}}),string:n};this.onLocationChange(h)}addLabel(e,t,i,r,s){let a={textColor:this.opts.legendTextColor,textScale:1,textAlignment:"left",lineWidth:0,lineColor:this.opts.legendTextColor,lineTerminator:"none",bulletScale:0,bulletColor:this.opts.legendTextColor},l=new t8(e,{...t?{...a,...t}:{...a}},i,r,s);return this.document.labels.push(l),l}calculateScreenPoint(e,t,i){let r=o.Ue();return o.fF(r,[...e,1],t),0!==r[3]&&(r[0]=(r[0]/r[3]+1)*.5*i[2],r[1]=(1-r[1]/r[3])*.5*i[3],r[2]/=r[3],r[0]+=i[0],r[1]+=i[1]),r}getLabelAtPoint(e){let t=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,i=this.opts.textHeight*this.gl.canvas.height*1;for(let t of this.document.labels){if(null==t.anchor||0===t.anchor)continue;let r=this.opts.textHeight*this.gl.canvas.height*t.style.textScale,s=this.textHeight(r,t.text),a=this.textWidth(r,t.text);if((!(1&t.anchor)||!(e[0]>a))&&(!(2&t.anchor)||!(e[0]<(this.gl.canvas.width-a)/2)&&!(e[0]>(this.gl.canvas.width+a)/2))&&(!(4&t.anchor)||!(e[0]<this.gl.canvas.width-a))&&(!(8&t.anchor)||!(e[1]<i/2)&&!(e[1]>s+i/2))&&(!(16&t.anchor)||!(e[1]<(this.gl.canvas.height-s-i)/2)&&!(e[1]>(this.gl.canvas.height+s-i/2)/2))&&(!(32&t.anchor)||!(e[1]<this.gl.canvas.height-s-i)&&!(e[1]>this.gl.canvas.height-i/2)))return t}I.debug("screenPoint",e);let r=this.getLegendPanelHeight(),s=this.getLegendPanelWidth(),a=this.gl.canvas.width-s,l=(this.canvas.height-r)/2;if(I.debug("panelrect",a,l,a+s,l+r),e[0]<a||e[1]<l||e[0]>a+s||e[1]>l+r)return null;for(let i of this.getConnectomeLabels()){let r=this.opts.textHeight*this.gl.canvas.height*i.style.textScale,s=this.textHeight(r,i.text);if(e[1]>=l&&e[1]<=l+s+t/2)return i;l+=s,l+=t/2}return null}drawLabelLine(e,t,i,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(let a of Array.isArray(e.points)&&Array.isArray(e.points[0])?e.points:[e.points]){let l=this.calculateScreenPoint(a,i,r);s?this.drawDottedLine([...t,l[0],l[1]],e.style.lineWidth,e.style.lineColor):this.draw3DLine(t,[l[0],l[1],l[2]],e.style.lineWidth,e.style.lineColor)}}draw3DLabel(e,t,i,r,s,a,l){let o=e.text,n=t[0],h=t[1],d=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,c=this.textHeight(e.style.textScale,o)*d;if(e.style.lineWidth>0&&Array.isArray(e.points)&&this.drawLabelLine(e,[n,h+c],i,r,l),e.style.bulletScale){let t=e.style.bulletScale*c,i=h+(c-t)/2+t/2,r=n+(s-t)/2;this.drawCircle([r,i,t,t],e.style.bulletColor)}let m=n;if(a){if("left"!==e.style.textAlignment){let t=this.textWidth(e.style.textScale,e.text)*d;"right"===e.style.textAlignment?m=n+a-1.5*d-t:m+=(a-(s||d)-t)/2}else m+=s}this.drawText([m,h],o,e.style.textScale,e.style.textColor)}draw3DLabels(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getConnectomeLabels();if(!this.opts.showLegend||0===r.length)return;if(!this.canvas)throw Error("canvas undefined");let s=this.gl;s.disable(s.CULL_FACE),s.viewport(0,0,this.canvas.width,this.canvas.height);let a=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1,l=this.getBulletMarginWidth(),o=this.getLegendPanelHeight(),n=this.getLegendPanelWidth(),h=s.canvas.width-n,d=(this.canvas.height-o)/2;this.drawRect([s.canvas.width-n,d,n-a,o],this.opts.legendBackgroundColor);let c=s.getParameter(s.BLEND),m=s.getParameter(s.DEPTH_FUNC);for(let o of(!i&&(s.disable(s.BLEND),s.depthFunc(s.GREATER)),r)){this.draw3DLabel(o,[h,d],e,t,l,n,i);let r=this.opts.textHeight*this.gl.canvas.height*o.style.textScale;d+=this.textHeight(r,o.text),d+=a/2}!i&&(s.depthFunc(m),c&&s.enable(s.BLEND))}drawAnchoredLabels(){let e=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1;for(let t of this.document.labels.filter(e=>null!=e.anchor&&0!==e.anchor)){let i,r;let s=t.text,a=this.textHeight(t.style.textScale,s)*e,l=this.textWidth(t.style.textScale,s)*e,o=this.opts.textHeight*this.gl.canvas.height*1,n=o/4,h=0,d=0;1&t.anchor&&(i=0),4&t.anchor&&(i=this.canvas.width-l,h-=o/4),2&t.anchor&&(i=(this.canvas.width-l)/2,h-=o/4,n+=o/4),8&t.anchor&&(r=0),16&t.anchor&&(r=(this.canvas.height-a-o)/2,d-=o/4),32&t.anchor&&(r=this.canvas.height-a-o,d-=o/4),this.drawRect([i+h,r+d,l+n,a+o],t.style.backgroundColor),this.draw3DLabel(t,[i,r])}}draw3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=null!==s;this.setPivot3D(),!l&&(s=this.scene.renderAzimuth,a=this.scene.renderElevation);let o=this.gl;null===t&&([t,i,r]=this.calculateMvpMatrix(null,e,s,a));let n=[...e];if(0===e[2]||0===e[3]?(n=[...e=[0,0,o.canvas.width,o.canvas.height]],this.screenSlices.push({leftTopWidthHeight:e,axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[il(i),0]})):(this.screenSlices.push({leftTopWidthHeight:e.slice(),axCorSag:4,sliceFrac:0,AxyzMxy:[],leftTopMM:[],fovMM:[il(i),0]}),e[1]=o.canvas.height-e[3]-e[1]),o.enable(o.DEPTH_TEST),o.depthFunc(o.ALWAYS),o.depthMask(!0),o.clearDepth(0),this.draw3DLabels(t,n,!1),o.viewport(e[0],e[1],e[2],e[3]),this.volumes.length>0&&(this.updateInterpolation(0,!0),this.updateInterpolation(1,!0),this.drawImage3D(t,s,a)),this.updateInterpolation(0),this.updateInterpolation(1),!l&&this.drawCrosshairs3D(!0,1,t),this.drawMesh3D(!0,1,t,i,r),this.uiData.mouseDepthPicker){this.depthPicker(e,t),this.createOnLocationChange(),this.draw3D(e,t,i,r,s,a);return}this.opts.meshXRay>0&&this.drawMesh3D(!1,this.opts.meshXRay,t,i,r),this.draw3DLabels(t,n,!1),o.viewport(e[0],e[1],e[2],e[3]),!l&&this.drawCrosshairs3D(!1,.15,t),o.viewport(0,0,o.canvas.width,o.canvas.height),this.drawOrientationCube(e,s,a);let h="azimuth: "+this.scene.renderAzimuth.toFixed(0)+" elevation: "+this.scene.renderElevation.toFixed(0);return this.readyForSync=!0,this.sync(),this.draw3DLabels(t,n,!0),h}drawMesh3D(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(this.meshes.length<1)return;let a=this.gl;!i&&([i,r,s]=this.calculateMvpMatrix(this.volumeObject3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),a.enable(a.DEPTH_TEST),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.disable(a.BLEND),a.depthFunc(a.GREATER),a.disable(a.CULL_FACE),e?(a.disable(a.BLEND),a.depthFunc(a.GREATER)):(a.enable(a.BLEND),a.depthFunc(a.ALWAYS),a.enable(a.CULL_FACE)),a.cullFace(a.BACK);let l=this.meshShaders[0].shader,o=!1;for(let e=0;e<this.meshes.length;e++){if(!1===this.meshes[e].visible)continue;if(l=this.meshShaders[this.meshes[e].meshShaderIndex].shader,this.uiData.mouseDepthPicker&&(l=this.pickingMeshShader),l.use(this.gl),a.uniformMatrix4fv(l.uniforms.mvpMtx,!1,i),a.uniformMatrix4fv(l.uniforms.normMtx,!1,s),a.uniform1f(l.uniforms.opacity,t),!(this.meshes[e].indexCount<3)){if(this.meshes[e].offsetPt0&&(this.meshes[e].fiberSides<3||this.meshes[e].fiberRadius<=0)){o=!0;continue}l.isMatcap&&(a.activeTexture(33989),a.bindTexture(a.TEXTURE_2D,this.matCapTexture)),a.bindVertexArray(this.meshes[e].vao),a.drawElements(a.TRIANGLES,this.meshes[e].indexCount,a.UNSIGNED_INT,0),a.bindVertexArray(this.unusedVAO)}}if(!o){a.enable(a.BLEND),a.depthFunc(a.ALWAYS);return}(l=this.fiberShader).use(this.gl),a.uniformMatrix4fv(l.uniforms.mvpMtx,!1,i),a.uniform1f(l.uniforms.opacity,t);for(let e=0;e<this.meshes.length;e++){if(!(this.meshes[e].indexCount<3)&&!!this.meshes[e].offsetPt0&&(!(this.meshes[e].fiberSides>=3)||!(this.meshes[e].fiberRadius>0)))a.bindVertexArray(this.meshes[e].vaoFiber),a.drawElements(a.LINE_STRIP,this.meshes[e].indexCount,a.UNSIGNED_INT,0),a.bindVertexArray(this.unusedVAO)}a.enable(a.BLEND),a.depthFunc(a.ALWAYS),this.readyForSync=!0}drawCrosshairs3D(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!(arguments.length>4)||void 0===arguments[4]||arguments[4];if(!this.opts.show3Dcrosshair&&!r||this.opts.crosshairWidth<=0&&r)return;let a=this.gl,l=this.frac2mm(this.scene.crosshairPos,0,s),o=1,[n,h,d]=this.sceneExtentsMinMax(s);if(this.volumes.length>0){if(!this.back)throw Error("back undefined");o=.5*Math.min(Math.min(this.back.pixDims[1],this.back.pixDims[2]),this.back.pixDims[3])}else(d[0]<50||d[0]>1e3)&&(o=.02*d[0]);if(o*=this.opts.crosshairWidth,this.opts?.crosshairWidthUnit==="percent"&&(o=d[0]*this.opts.crosshairWidth*.005),this.opts?.crosshairWidthUnit==="mm"&&(o=.5*this.opts.crosshairWidth),(null===this.crosshairs3D||this.crosshairs3D.mm[0]!==l[0]||this.crosshairs3D.mm[1]!==l[1]||this.crosshairs3D.mm[2]!==l[2])&&(null!==this.crosshairs3D&&(a.deleteBuffer(this.crosshairs3D.indexBuffer),a.deleteBuffer(this.crosshairs3D.vertexBuffer)),this.crosshairs3D=eP.generateCrosshairs(this.gl,1,l,n,h,o,20,this.opts.crosshairGap),this.crosshairs3D.mm=l),!this.surfaceShader)throw Error("surfaceShader undefined");let c=this.surfaceShader;c.use(this.gl),null==i&&([i]=this.calculateMvpMatrix(this.crosshairs3D,void 0,this.scene.renderAzimuth,this.scene.renderElevation)),a.uniformMatrix4fv(c.uniforms.mvpMtx,!1,i),a.disable(a.CULL_FACE),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.crosshairs3D.indexBuffer),a.enable(a.DEPTH_TEST);let m=[...this.opts.crosshairColor];e?(a.disable(a.BLEND),a.depthFunc(a.GREATER)):(a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),a.depthFunc(a.ALWAYS)),m[3]=t,a.uniform4fv(c.uniforms.surfaceColor,m),a.bindVertexArray(this.crosshairs3D.vao),a.drawElements(a.TRIANGLES,this.crosshairs3D.indexCount,a.UNSIGNED_INT,0),a.bindVertexArray(this.unusedVAO)}mm2frac(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.volumes.length<1){let t=n.al(.1,.5,.5),[i,r,s]=this.sceneExtentsMinMax();return t[0]=(e[0]-i[0])/s[0],t[1]=(e[1]-i[1])/s[1],t[2]=(e[2]-i[2])/s[2],!isFinite(t)&&(!isFinite(t[0])&&(t[0]=.5),!isFinite(t[1])&&(t[1]=.5),!isFinite(t[2])&&(t[2]=.5),this.meshes.length<1&&I.error("mm2frac() not finite: objects not (yet) loaded.")),t}return this.volumes[t].convertMM2Frac(e,i||this.opts.isSliceMM)}vox2frac(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.volumes[t].convertVox2Frac(e)}frac2vox(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.volumes.length<=t?[0,0,0]:this.volumes[t].convertFrac2Vox(e)}moveCrosshairInVox(e,t,i){let r=this.frac2vox(this.scene.crosshairPos);r[0]+=e,r[1]+=t,r[2]+=i,r[0]=io(r[0],0,this.volumes[0].dimsRAS[1]-1),r[1]=io(r[1],0,this.volumes[0].dimsRAS[2]-1),r[2]=io(r[2],0,this.volumes[0].dimsRAS[3]-1),this.scene.crosshairPos=this.vox2frac(r),this.createOnLocationChange(),this.drawScene()}frac2mm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=o.al(e[0],e[1],e[2],1);if(this.volumes.length>0)return this.volumes[t].convertFrac2MM(e,i||this.opts.isSliceMM);{let t,i,s,a,l,o,n,h,d,[c,m]=this.sceneExtentsMinMax();r[0]=(t=c[0],i=m[0],t*(1-(s=e[0]))+i*s);r[1]=(a=c[1],l=m[1],a*(1-(o=e[1]))+l*o);r[2]=(n=c[2],h=m[2],n*(1-(d=e[2]))+h*d)}return r}screenXY2TextureFrac(e,t,i){let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],s=n.al(-1,-1,-1),a=this.screenSlices[i].axCorSag;if(a>2)return s;let l=this.screenSlices[i].leftTopWidthHeight.slice(),o=!1;l[2]<0&&(o=!0,l[0]+=l[2],l[2]=-l[2]);let h=(e-l[0])/l[2];o&&(h=1-h);let d=1-(t-l[1])/l[3];if(h<0||h>1||d<0||d>1||this.screenSlices[i].AxyzMxy.length<4)return s;let c=n.al(0,0,0);c[0]=this.screenSlices[i].leftTopMM[0]+h*this.screenSlices[i].fovMM[0],c[1]=this.screenSlices[i].leftTopMM[1]+d*this.screenSlices[i].fovMM[1];let m=this.screenSlices[i].AxyzMxy;c[2]=m[2]+m[4]*(c[1]-m[1])-m[3]*(c[0]-m[0]),1===a&&(c=ia(c,[0,2,1])),2===a&&(c=ia(c,[2,0,1]));let A=this.mm2frac(c);return r&&(A[0]<0||A[0]>1||A[1]<0||A[1]>1||A[2]<0||A[2]>1)?s:A}canvasPos2frac(e){for(let t=0;t<this.screenSlices.length;t++){let i=this.screenXY2TextureFrac(e[0],e[1],t);if(i[0]>=0)return i}return[-1,-1,-1]}scaleSlice(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],s=0===r[0]?this.effectiveCanvasWidth()-i[0]:r[0]-i[0],a=0===r[1]?this.effectiveCanvasHeight()-i[1]:r[1]-i[1],l=s/e;t*l>a&&(l=a/t);let o=e*l,n=t*l;return[(s-o)*.5,(a-n)*.5,o,n,l]}drawThumbnail(){if(!this.bmpShader)throw Error("bmpShader undefined");this.bmpShader.use(this.gl),this.gl.uniform2f(this.bmpShader.uniforms.canvasWidthHeight,this.gl.canvas.width,this.gl.canvas.height);let e=this.gl.canvas.height,t=this.gl.canvas.height*this.bmpTextureWH;t>this.gl.canvas.width&&(e=this.gl.canvas.width/this.bmpTextureWH,t=this.gl.canvas.width),this.gl.uniform4f(this.bmpShader.uniforms.leftTopWidthHeight,0,0,t,e),this.gl.bindVertexArray(this.genericVAO),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawLine(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0,0,-1];if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw Error("lineShader undefined");this.lineShader.use(this.gl),i[3]<0&&(i=this.opts.crosshairColor),this.gl.uniform4fv(this.lineShader.uniforms.lineColor,i),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,t),this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,e),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}draw3DLine(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,0,0,-1];if(this.gl.bindVertexArray(this.genericVAO),!this.line3DShader)throw Error("line3DShader undefined");this.line3DShader.use(this.gl),r[3]<0&&(r=this.opts.crosshairColor),this.gl.uniform4fv(this.line3DShader.uniforms.lineColor,r),this.gl.uniform2fv(this.line3DShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.line3DShader.uniforms.thickness,i),this.gl.uniform2fv(this.line3DShader.uniforms.startXY,e),this.gl.uniform3fv(this.line3DShader.uniforms.endXYZ,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(this.unusedVAO)}drawDottedLine(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,0,0,-1];if(this.gl.bindVertexArray(this.genericVAO),!this.lineShader)throw Error("lineShader undefined");this.lineShader.use(this.gl);let r=i[3]<0?[...this.opts.crosshairColor]:[...i];r[3]=.3;let s=d.al(e[2]-e[0],e[3]-e[1]),a=d.kE(s);d.Fv(s,s);let l=this.opts.textHeight*Math.min(this.gl.canvas.height,this.gl.canvas.width)*1;d.bA(s,s,l/2);let o=d.kE(s),n=Math.floor(a/o);a%o&&n++;let h=[e[0],e[1]];this.gl.uniform4fv(this.lineShader.uniforms.lineColor,r),this.gl.uniform2fv(this.lineShader.uniforms.canvasWidthHeight,[this.gl.canvas.width,this.gl.canvas.height]),this.gl.uniform1f(this.lineShader.uniforms.thickness,t);for(let e=0;e<n-1;e++){if(e%2){h[0]+=s[0],h[1]+=s[1];continue}let t=[h[0],h[1],h[0]+s[0],h[1]+s[1]];this.gl.uniform4fv(this.lineShader.uniforms.startXYendXY,t),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),h[0]+=s[0],h[1]+=s[1]}this.gl.bindVertexArray(this.unusedVAO)}drawGraphLine(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,0,0,.5],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;this.drawLine(e,i,t)}drawCrossLinesMM(e,t,i,r,s){if(e<0||this.screenSlices.length<=e)return;let a=this.screenSlices[e],l=a.sliceFrac;l===1/0&&I.warn("Rendering approximate cross lines in world view mode"),l===1/0&&(l=.5);let o=r.slice(),n=s.slice(),h=Math.max(1,this.opts.crosshairWidth);function c(e){let t=d.al(0,0);return t[0]=a.leftTopWidthHeight[0]+(e[0]-a.leftTopMM[0])/a.fovMM[0]*a.leftTopWidthHeight[2],t[1]=a.leftTopWidthHeight[1]+a.leftTopWidthHeight[3]-(e[1]-a.leftTopMM[1])/a.fovMM[1]*a.leftTopWidthHeight[3],t}if(1===t&&(o=i.slice()),2===t&&(o=i.slice(),n=r.slice()),o.length>0&&0===t){let e=l;for(let t=0;t<o.length;t++){let i=this.frac2mm([.5,.5,.5]);i[1]=o[t];let r=this.mm2frac(i);r=r[1];let s=this.frac2mm([0,r,e]);s=ia(s,[0,1,2]);let a=this.frac2mm([1,r,e]);a=ia(a,[0,1,2]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}if(o.length>0&&1===t){let e=l;for(let t=0;t<o.length;t++){let i=this.frac2mm([.5,.5,.5]);i[2]=o[t];let r=this.mm2frac(i);r=r[2];let s=this.frac2mm([0,e,r]);s=ia(s,[0,2,1]);let a=this.frac2mm([1,e,r]);a=ia(a,[0,2,1]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}if(o.length>0&&2===t){let e=l;for(let t=0;t<o.length;t++){let i=this.frac2mm([.5,.5,.5]);i[2]=o[t];let r=this.mm2frac(i);r=r[2];let s=this.frac2mm([e,0,r]);s=ia(s,[1,2,0]);let a=this.frac2mm([e,1,r]);a=ia(a,[1,2,0]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}if(n.length>0&&0===t){let e=l;for(let t=0;t<n.length;t++){let i=this.frac2mm([.5,.5,.5]);i[0]=n[t];let r=this.mm2frac(i);r=r[0];let s=this.frac2mm([r,0,e]);s=ia(s,[0,1,2]);let a=this.frac2mm([r,1,e]);a=ia(a,[0,1,2]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}if(n.length>0&&1===t){let e=l;for(let t=0;t<n.length;t++){let i=this.frac2mm([.5,.5,.5]);i[0]=n[t];let r=this.mm2frac(i);r=r[0];let s=this.frac2mm([r,e,0]);s=ia(s,[0,2,1]);let a=this.frac2mm([r,e,1]);a=ia(a,[0,2,1]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}if(n.length>0&&2===t){let e=l;for(let t=0;t<n.length;t++){let i=this.frac2mm([.5,.5,.5]);i[1]=n[t];let r=this.mm2frac(i);r=r[1];let s=this.frac2mm([e,r,0]);s=ia(s,[1,2,0]);let a=this.frac2mm([e,r,1]);a=ia(a,[1,2,0]),s=c(s),a=c(a),this.drawLine([s[0],s[1],a[0],a[1]],h)}}}drawCrossLines(e,t,i,r,s){if(e<0||this.screenSlices.length<=e)return;if(this.opts.isSliceMM||this.screenSlices[e].sliceFrac===1/0)return this.drawCrossLinesMM(e,t,i,r,s);let a=this.screenSlices[e],l=r.slice(),o=s.slice();if(1===t&&(l=i.slice()),2===t&&(l=i.slice(),o=r.slice()),l.length>0){let e=a.leftTopWidthHeight.slice(),i=2;0===t&&(i=1);let r=this.frac2mm([.5,.5,.5]);for(let t=0;t<l.length;t++){r[i]=l[t];let s=this.mm2frac(r);this.drawRect([e[0],e[1]+e[3]-s[i]*e[3],e[2],1])}}if(o.length>0){let e=a.leftTopWidthHeight.slice(),i=a.fovMM[0]<0,r=0;2===t&&(r=1);let s=this.frac2mm([.5,.5,.5]);for(let t=0;t<o.length;t++){s[r]=o[t];let a=this.mm2frac(s);i?this.drawRect([e[0]+(e[2]-a[r]*e[2]),e[1],1,e[3]]):this.drawRect([e[0]+a[r]*e[2],e[1],1,e[3]])}}}drawMosaic(e){if(0===this.volumes.length){I.debug("Unable to draw mosaic until voxel-based image is loaded");return}this.screenSlices=[];let t=this.screenFieldOfViewMM(0,!0),i=this.screenFieldOfViewMM(0);e=e.replaceAll(";"," ;").trim();let r=[],s=[],a=[],l=e.split(/\s+/),o=1,n=this.opts.textHeight,h=0,d=0;for(let e=0;e<2;e++){let c=!1,m=!1;c=!1;let A=0,g=0,u=0,f=0,p=!1,v=0;for(let x=0;x<l.length;x++){let w=l[x];if(w.includes("X")){m=!0;continue}if(w.includes("L")){p=!w.includes("-");continue}if(w.includes("V")||w.includes("H")){x++;continue}w.includes("A")&&(v=0),w.includes("C")&&(v=1),w.includes("S")&&(v=2),w.includes("R")&&(c=!0),w.includes(";")&&(u+=A,f=Math.max(f,g),A=0,g=0);let C=parseFloat(w);if(isNaN(C))continue;let b=0,y=0,I=i;if(c&&(I=t),b=2===v?I[1]:I[0],y=0===v?I[1]:I[2],0===e)!c&&(0===v&&r.push(C),1===v&&s.push(C),2===v&&a.push(C));else{let e=[h+o*g,d+o*u,o*b,o*y];if(this.opts.textHeight=p?n:0,c){let t=C<0?-1/0:1/0;Object.is(C,-0)&&(t=-1/0),this.draw2D(e,v,t)}else this.draw2D(e,v,C);m&&this.drawCrossLines(this.screenSlices.length-1,v,r,s,a),c=!1,m=!1}g+=b,A=Math.max(A,y)}if(u+=A,(f=Math.max(f,g))<=0||u<=0)break;let x=this.gl.canvas.width/f;o=Math.min(x,this.effectiveCanvasHeight()/u),this.opts.centerMosaic&&(h=Math.floor(.5*(this.gl.canvas.width-f*o)),d=Math.floor(.5*(this.effectiveCanvasHeight()-u*o)))}this.opts.textHeight=n}drawSceneCore(){if(!this.initialized)return;if(this.colorbarHeight=0,this.gl.clearColor(this.opts.backColor[0],this.opts.backColor[1],this.opts.backColor[2],this.opts.backColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.bmpTexture&&this.thumbnailVisible){this.drawThumbnail();return}let e="";if(0===this.volumes.length||void 0===this.volumes[0].dims){if(this.meshes.length>0){this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.drawLoadingText(this.loadingText);return}if(null===this.back)return;if(this.uiData.isDragging&&this.scene.clipPlaneDepthAziElev[0]<1.8&&this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0){let e=this.uiData.dragStart[0]-this.uiData.dragEnd[0],t=this.uiData.dragStart[1]-this.uiData.dragEnd[1],i=this.uiData.dragClipPlaneStartDepthAziElev.slice();if(i[1]-=e,i[1]=i[1]%360,i[2]+=t,i[1]!==this.scene.clipPlaneDepthAziElev[1]||i[2]!==this.scene.clipPlaneDepthAziElev[2])return this.scene.clipPlaneDepthAziElev=i,this.setClipPlane(this.scene.clipPlaneDepthAziElev)}if(this.sliceMosaicString.length<1&&4===this.opts.sliceType){this.opts.isColorbar&&this.reserveColorbarPanel(),this.screenSlices=[],this.draw3D(),this.opts.isColorbar&&this.drawColorbar();return}this.opts.isColorbar&&this.reserveColorbarPanel();let t=this.getMaxVols(),i=3===this.opts.sliceType&&t>1&&this.graph.autoSizeMultiplanar&&this.graph.opacity>0;if(this.sliceMosaicString.length>0)this.drawMosaic(this.sliceMosaicString);else{let e=[0,0],r=!1;if(this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.screenSlices=[],0===this.opts.sliceType)this.draw2D([0,0,0,0],0);else if(1===this.opts.sliceType)this.draw2D([0,0,0,0],1);else if(2===this.opts.sliceType)this.draw2D([0,0,0,0],2);else{let s=function(e,t){return[(e-1)*h+e*d,(t-1)*h+t*d]},a=!1;this.opts.multiplanarForceRender?(a=!0,this.opts.multiplanarForceRender?this.opts.multiplanarShowRender=1:this.opts.multiplanarShowRender=2,delete this.opts.multiplanarForceRender):1===this.opts.multiplanarShowRender&&(a=!0);let l=isFinite(this.drawPenLocation[0])&&this.opts.drawingEnabled,{volScale:o}=this.sliceScale(),n=o.slice();this.opts.multiplanarEqualSize&&(o[0]=1,o[1]=1,o[2]=1),"number"!=typeof this.opts.multiplanarPadPixels&&I.debug("multiplanarPadPixels must be numeric");let h=parseFloat(`${this.opts.multiplanarPadPixels}`),d=this.opts.tileMargin;d<0&&(d=2*(2+Math.ceil(Math.max(this.opts.textHeight,.01)*Math.min(this.gl.canvas.height,this.gl.canvas.width))));let c=[this.effectiveCanvasWidth(),this.effectiveCanvasHeight()];this.opts.heroImageFraction>0&&this.opts.heroImageFraction<1&&(a=!1,r=!0,c[0]>c[1]&&3!==this.opts.multiplanarLayout?e[0]=c[0]*this.opts.heroImageFraction:e[1]=c[1]*this.opts.heroImageFraction,c=[c[0]-e[0],c[1]-e[1]]);let m=this.scaleSlice(o[0]+o[1],o[1]+o[2],s(2,2),c),A=Math.max(Math.max(o[1],o[2]),o[0]),g=this.scaleSlice(o[0]+o[0]+o[1],Math.max(o[1],o[2]),s(3,1),c),u=this.scaleSlice(o[0]+o[0]+o[1]+A,Math.max(o[1],o[2]),s(4,1),c),f=this.scaleSlice(A,o[1]+o[2]+o[2],s(1,3),c),p=this.scaleSlice(A,o[1]+o[2]+o[2]+A,s(1,4),c),v=!l&&(t<2||!i),x=!1,w=!1,C=!1;1===this.opts.multiplanarLayout?x=!0:2===this.opts.multiplanarLayout?w=!0:3===this.opts.multiplanarLayout?C=!0:f[4]>g[4]&&f[4]>m[4]?x=!0:g[4]>m[4]?C=!0:w=!0;let b=m;if(x?(b=f,!r&&(a||2===this.opts.multiplanarShowRender&&p[4]>=f[4])?b=p:v=!1):C&&(b=g,!r&&(a||2===this.opts.multiplanarShowRender&&u[4]>=g[4])?b=u:v=!1),r){let t=0===e[0]?this.effectiveCanvasWidth():e[0],i=0===e[1]?this.effectiveCanvasHeight():e[1];if(this.opts?.heroSliceType===0||this.opts?.heroSliceType===1||this.opts?.heroSliceType===2)this.draw2D([0,0,t,i],this.opts.heroSliceType,NaN,[1/0,1/0]);else{let e=b.slice();t===this.effectiveCanvasWidth()&&(e[0]=0),this.draw3D([e[0],0,t,i])}b[0]+=e[0],b[1]+=e[1],v=!1}let y=o[0]*b[4]+d,M=o[1]*b[4]+d,D=o[2]*b[4]+d,F=n[0]*b[4],T=n[1]*b[4],E=n[2]*b[4];if(x){if(this.draw2D([b[0],b[1],y,M],0,NaN,[F,T]),this.draw2D([b[0],b[1]+M+h,y,D],1,NaN,[F,E]),this.draw2D([b[0],b[1]+M+h+D+h,M,D],2,NaN,[T,E]),v){let e=A*b[4];this.draw3D([b[0],b[1]+M+D+D+3*h,e,e])}}else if(C){if(this.draw2D([b[0],b[1],y,M],0,NaN,[F,T]),this.draw2D([b[0]+y+h,b[1],y,D],1,NaN,[F,E]),this.draw2D([b[0]+y+y+2*h,b[1],M,D],2,NaN,[T,E]),v){let e=A*b[4];this.draw3D([b[0]+y+y+M+3*h,b[1],e,e])}}else w&&(!a&&(v=!1),2===this.opts.multiplanarShowRender&&(v=!0),r&&(v=!1),this.draw2D([b[0],b[1]+D+h,y,M],0,NaN,[F,T]),this.draw2D([b[0],b[1],y,D],1,NaN,[F,E]),this.draw2D([b[0]+y+h,b[1],M,D],2,NaN,[T,E]),v&&this.draw3D([b[0]+y+h,b[1]+D+h,M,M]))}}if(this.opts.isRuler&&this.drawRuler(),this.opts.isColorbar&&this.drawColorbar(),i&&this.drawGraph(),this.uiData.isDragging){if(this.uiData.mouseButtonCenterDown){this.dragForCenterButton([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(4===this.opts.dragMode){this.dragForSlicer3D([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(3===this.opts.dragMode){this.dragForPanZoom([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}if(this.inRenderTile(this.uiData.dragStart[0],this.uiData.dragStart[1])>=0)return;if(2===this.opts.dragMode){this.drawMeasurementTool([this.uiData.dragStart[0],this.uiData.dragStart[1],this.uiData.dragEnd[0],this.uiData.dragEnd[1]]);return}let e=Math.abs(this.uiData.dragStart[0]-this.uiData.dragEnd[0]),t=Math.abs(this.uiData.dragStart[1]-this.uiData.dragEnd[1]);this.drawSelectionBox([Math.min(this.uiData.dragStart[0],this.uiData.dragEnd[0]),Math.min(this.uiData.dragStart[1],this.uiData.dragEnd[1]),e,t]);return}if(this.opts.clickToSegment){let e=this.mousePos[0],t=this.mousePos[1];if(this.inRenderTile(e,t)>=0)return;let i=this.tileIndex(e,t);if(i>-1){let r=this.screenSlices[i].fovMM,s=this.screenSlices[i].leftTopWidthHeight[2]/r[0],a=this.opts.crosshairColor,l=[a[0],a[1],a[2],.4],o=this.opts.clickToSegmentRadius*s;this.drawCircle([e-o,t-o,2*o,2*o],l,1)}}let r=this.frac2mm([this.scene.crosshairPos[0],this.scene.crosshairPos[1],this.scene.crosshairPos[2]]);return e=r[0].toFixed(2)+"\xd7"+r[1].toFixed(2)+"\xd7"+r[2].toFixed(2),this.readyForSync=!0,this.sync(),this.drawAnchoredLabels(),e}drawScene(){if(this.isBusy){this.needsRefresh=!0;return}this.isBusy=!1,this.needsRefresh=!1;let e=this.drawSceneCore();return null!==this._gl&&this.gl.finish(),this.needsRefresh&&(e=this.drawScene()),e}get gl(){if(!this._gl)throw Error("unable to get WebGL context. Maybe the browser doesn't support WebGL2.");return this._gl}set gl(e){this._gl=e}};let ig=e=>{let{images:t,nvOpts:i}=e;window.location.origin;let r=l.useRef(null),s=l.useRef(null);return l.useEffect(()=>{s.current=new iA({logLevel:"debug",...i}),s.current.attachToCanvas(r.current),s.current.loadVolumes(t)},[]),(0,a.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)("canvas",{ref:r,width:640,height:480})})}},6332:function(e,t,i){i.d(t,{k:function(){return a}});var r=i(2322),s=i(834);let a=e=>{let{children:t}=e;return(0,r.jsx)(s.Z,{fallback:(0,r.jsx)("div",{children:"Loading..."}),children:()=>t})}},104:function(e,t,i){i.r(t),i.d(t,{default:()=>v});var r=i("2322"),s=i("7239"),a=i("5819"),l=i("3687"),o=i("3695"),n=i("4126"),h=i("6332"),d=i("8108");let c="features_t9lD",m=[{title:"Works everywhere",description:(0,r.jsx)(r.Fragment,{children:"NiiVue is a JavaScript library that can be used in any modern web environment: Safari, Firefox, Chrome, Edge, Electron, iOS, Android."})},{title:"Simple API",description:(0,r.jsx)(r.Fragment,{children:"NiiVue is designed to be easy to use and is platform and framework agnostic."})},{title:"Community",description:(0,r.jsxs)(r.Fragment,{children:["The community has made ",(0,r.jsx)("a",{style:{textDecoration:"underline"},href:"https://github.com/niivue/niivue?tab=readme-ov-file#projects-and-people-using-niivue",target:"_blank",rel:"noopener noreferrer",children:"extensions, products, and plug-ins"})," using NiiVue."]})}];function A(e){let{Svg:t,title:i,description:a}=e;return(0,r.jsxs)("div",{className:(0,s.Z)("col col--4"),children:[(0,r.jsx)("div",{className:"text--center"}),(0,r.jsxs)("div",{className:"text--center padding-horiz--md",children:[(0,r.jsx)(n.Z,{as:"h3",children:i}),(0,r.jsx)("p",{children:a})]})]})}function g(){return(0,r.jsx)("section",{className:c,children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"row",children:m.map((e,t)=>(0,r.jsx)(A,{...e},t))}),(0,r.jsx)(h.k,{children:(0,r.jsx)(d.M,{images:[{url:"https://niivue.github.io/niivue-demo-images/mni152.nii.gz"}],nvOpts:{}})})]})})}let u="heroBanner_qdFl",f="buttons_AeoN";function p(){let{siteConfig:e}=(0,l.Z)();return(0,r.jsx)("header",{className:(0,s.Z)("hero hero--primary",u),children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)(n.Z,{as:"h1",className:"hero__title",children:e.title}),(0,r.jsx)("p",{className:"hero__subtitle",children:e.tagline}),(0,r.jsx)("div",{className:f,children:(0,r.jsx)(a.Z,{className:"button button--secondary button--lg",to:"/docs/intro",children:"Get started"})})]})})}function v(){let{siteConfig:e}=(0,l.Z)();return(0,r.jsxs)(o.Z,{title:`${e.title}`,description:"Description will go into a meta tag in <head />",children:[(0,r.jsx)(p,{}),(0,r.jsx)("main",{children:(0,r.jsx)(g,{})})]})}},65:function(){},7080:function(){}}]);